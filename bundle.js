/*! For license information please see bundle.js.LICENSE.txt */
(()=>{var __webpack_modules__={2354:(t,e,n)=>{"use strict";n(7659),n(2064),n(3718),n(2776),n(419),n(7573),n(9034),n(2378),n(6915),n(3137),n(4740),n(2320),n(7942),n(6760)},7659:(t,e,n)=>{n(2403),n(3290),n(3690),n(8424),n(2357),n(6667),n(2506),n(6022),n(754),n(7571),n(6527),n(9219),n(3270),n(4919),n(5331),n(2456),n(8490),n(4554),n(161),n(6042),n(15),n(317),n(3271),n(440),n(1077),n(820),n(1914),n(4117),n(9619),n(5849),n(4750),n(1550),n(3529),n(2791),n(6831),n(4717),n(7292),n(1840),n(3255),n(5728),n(6255),n(2834),n(4489),n(575),n(1369),n(2751),n(9617),n(3656),n(1850),n(5424),n(230),n(8471),n(8577),n(7906),n(8587),n(6575),n(5281),n(3917),n(5450),n(9449),n(1616),n(9718),n(3845),n(5803),n(2222),n(5036),n(6131),n(4110),n(6235),n(6495),n(4162),n(5297),n(1466),n(2581),n(8384),n(2334),n(9701),n(1325),n(3233),n(1621),n(8671),n(6705),n(9437),n(7263),n(919),n(791),n(633),n(9355),n(9253),n(9892),n(9121),n(8738),n(4751),n(9822),n(4611),n(9217),n(4138),n(109),n(3821),n(4806),n(2566),n(5997),n(8359),n(7181),n(8682),n(8514),n(5105),n(5325),n(829),n(8969),n(3940),n(3491),n(6332),n(7195),n(5345),n(6670),n(7736),n(4457),n(7683),n(1123),n(4797),n(4871),n(8824),n(6472),n(1220),n(9263),n(7622),n(9060),n(980),n(6175),n(8484),n(9869),n(1285),n(4854),n(6647),n(7903),n(5197),n(3113),t.exports=n(8544)},3718:(t,e,n)=>{n(6032),t.exports=n(8544).Array.flatMap},2064:(t,e,n)=>{n(2963),t.exports=n(8544).Array.includes},4740:(t,e,n)=>{n(8217),t.exports=n(8544).Object.entries},6915:(t,e,n)=>{n(9168),t.exports=n(8544).Object.getOwnPropertyDescriptors},3137:(t,e,n)=>{n(6351),t.exports=n(8544).Object.values},2320:(t,e,n)=>{"use strict";n(829),n(8088),t.exports=n(8544).Promise.finally},419:(t,e,n)=>{n(2123),t.exports=n(8544).String.padEnd},2776:(t,e,n)=>{n(9391),t.exports=n(8544).String.padStart},9034:(t,e,n)=>{n(1767),t.exports=n(8544).String.trimRight},7573:(t,e,n)=>{n(6541),t.exports=n(8544).String.trimLeft},2378:(t,e,n)=>{n(4870),t.exports=n(9078).f("asyncIterator")},4019:(t,e,n)=>{n(6057),t.exports=n(7838).global},4511:t=>{t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},9396:(t,e,n)=>{var r=n(6558);t.exports=function(t){if(!r(t))throw TypeError(t+" is not an object!");return t}},7838:t=>{var e=t.exports={version:"2.6.12"};"number"==typeof __e&&(__e=e)},9035:(t,e,n)=>{var r=n(4511);t.exports=function(t,e,n){if(r(t),void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,i){return t.call(e,n,r,i)}}return function(){return t.apply(e,arguments)}}},4733:(t,e,n)=>{t.exports=!n(9476)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},6863:(t,e,n)=>{var r=n(6558),i=n(948).document,o=r(i)&&r(i.createElement);t.exports=function(t){return o?i.createElement(t):{}}},7888:(t,e,n)=>{var r=n(948),i=n(7838),o=n(9035),a=n(6205),s=n(6287),l=function t(e,n,l){var u,c,h,f=e&t.F,d=e&t.G,p=e&t.S,y=e&t.P,v=e&t.B,g=e&t.W,m=d?i:i[n]||(i[n]={}),_=m.prototype,b=d?r:p?r[n]:(r[n]||{}).prototype;for(u in d&&(l=n),l)(c=!f&&b&&void 0!==b[u])&&s(m,u)||(h=c?b[u]:l[u],m[u]=d&&"function"!=typeof b[u]?l[u]:v&&c?o(h,r):g&&b[u]==h?function(t){var e=function(e,n,r){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(e);case 2:return new t(e,n)}return new t(e,n,r)}return t.apply(this,arguments)};return e.prototype=t.prototype,e}(h):y&&"function"==typeof h?o(Function.call,h):h,y&&((m.virtual||(m.virtual={}))[u]=h,e&t.R&&_&&!_[u]&&a(_,u,h)))};l.F=1,l.G=2,l.S=4,l.P=8,l.B=16,l.W=32,l.U=64,l.R=128,t.exports=l},9476:t=>{t.exports=function(t){try{return!!t()}catch(t){return!0}}},948:t=>{var e=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=e)},6287:t=>{var e={}.hasOwnProperty;t.exports=function(t,n){return e.call(t,n)}},6205:(t,e,n)=>{var r=n(8146),i=n(1476);t.exports=n(4733)?function(t,e,n){return r.f(t,e,i(1,n))}:function(t,e,n){return t[e]=n,t}},8292:(t,e,n)=>{t.exports=!n(4733)&&!n(9476)((function(){return 7!=Object.defineProperty(n(6863)("div"),"a",{get:function(){return 7}}).a}))},6558:t=>{function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e(t)}t.exports=function(t){return"object"===e(t)?null!==t:"function"==typeof t}},8146:(t,e,n)=>{var r=n(9396),i=n(8292),o=n(1415),a=Object.defineProperty;e.f=n(4733)?Object.defineProperty:function(t,e,n){if(r(t),e=o(e,!0),r(n),i)try{return a(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},1476:t=>{t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},1415:(t,e,n)=>{var r=n(6558);t.exports=function(t,e){if(!r(t))return t;var n,i;if(e&&"function"==typeof(n=t.toString)&&!r(i=n.call(t)))return i;if("function"==typeof(n=t.valueOf)&&!r(i=n.call(t)))return i;if(!e&&"function"==typeof(n=t.toString)&&!r(i=n.call(t)))return i;throw TypeError("Can't convert object to primitive value")}},6057:(t,e,n)=>{var r=n(7888);r(r.G,{global:n(948)})},6819:t=>{t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},9855:(t,e,n)=>{var r=n(3679);t.exports=function(t,e){if("number"!=typeof t&&"Number"!=r(t))throw TypeError(e);return+t}},4339:(t,e,n)=>{var r=n(3336)("unscopables"),i=Array.prototype;null==i[r]&&n(8012)(i,r,{}),t.exports=function(t){i[r][t]=!0}},1330:(t,e,n)=>{"use strict";var r=n(3593)(!0);t.exports=function(t,e,n){return e+(n?r(t,e).length:1)}},2702:t=>{t.exports=function(t,e,n,r){if(!(t instanceof e)||void 0!==r&&r in t)throw TypeError(n+": incorrect invocation!");return t}},6154:(t,e,n)=>{var r=n(7156);t.exports=function(t){if(!r(t))throw TypeError(t+" is not an object!");return t}},2147:(t,e,n)=>{"use strict";var r=n(2515),i=n(6241),o=n(8315);t.exports=[].copyWithin||function(t,e){var n=r(this),a=o(n.length),s=i(t,a),l=i(e,a),u=arguments.length>2?arguments[2]:void 0,c=Math.min((void 0===u?a:i(u,a))-l,a-s),h=1;for(l<s&&s<l+c&&(h=-1,l+=c-1,s+=c-1);c-- >0;)l in n?n[s]=n[l]:delete n[s],s+=h,l+=h;return n}},1132:(t,e,n)=>{"use strict";var r=n(2515),i=n(6241),o=n(8315);t.exports=function(t){for(var e=r(this),n=o(e.length),a=arguments.length,s=i(a>1?arguments[1]:void 0,n),l=a>2?arguments[2]:void 0,u=void 0===l?n:i(l,n);u>s;)e[s++]=t;return e}},4687:(t,e,n)=>{var r=n(8499),i=n(8315),o=n(6241);t.exports=function(t){return function(e,n,a){var s,l=r(e),u=i(l.length),c=o(a,u);if(t&&n!=n){for(;u>c;)if((s=l[c++])!=s)return!0}else for(;u>c;c++)if((t||c in l)&&l[c]===n)return t||c||0;return!t&&-1}}},3970:(t,e,n)=>{var r=n(566),i=n(331),o=n(2515),a=n(8315),s=n(5486);t.exports=function(t,e){var n=1==t,l=2==t,u=3==t,c=4==t,h=6==t,f=5==t||h,d=e||s;return function(e,s,p){for(var y,v,g=o(e),m=i(g),_=r(s,p,3),b=a(m.length),x=0,w=n?d(e,b):l?d(e,0):void 0;b>x;x++)if((f||x in m)&&(v=_(y=m[x],x,g),t))if(n)w[x]=v;else if(v)switch(t){case 3:return!0;case 5:return y;case 6:return x;case 2:w.push(y)}else if(c)return!1;return h?-1:u||c?c:w}}},6419:(t,e,n)=>{var r=n(6819),i=n(2515),o=n(331),a=n(8315);t.exports=function(t,e,n,s,l){r(e);var u=i(t),c=o(u),h=a(u.length),f=l?h-1:0,d=l?-1:1;if(n<2)for(;;){if(f in c){s=c[f],f+=d;break}if(f+=d,l?f<0:h<=f)throw TypeError("Reduce of empty array with no initial value")}for(;l?f>=0:h>f;f+=d)f in c&&(s=e(s,c[f],f,u));return s}},2642:(t,e,n)=>{var r=n(7156),i=n(1320),o=n(3336)("species");t.exports=function(t){var e;return i(t)&&("function"!=typeof(e=t.constructor)||e!==Array&&!i(e.prototype)||(e=void 0),r(e)&&null===(e=e[o])&&(e=void 0)),void 0===e?Array:e}},5486:(t,e,n)=>{var r=n(2642);t.exports=function(t,e){return new(r(t))(e)}},8327:(t,e,n)=>{"use strict";var r=n(6819),i=n(7156),o=n(2765),a=[].slice,s={},l=function(t,e,n){if(!(e in s)){for(var r=[],i=0;i<e;i++)r[i]="a["+i+"]";s[e]=Function("F,a","return new F("+r.join(",")+")")}return s[e](t,n)};t.exports=Function.bind||function(t){var e=r(this),n=a.call(arguments,1),s=function r(){var i=n.concat(a.call(arguments));return this instanceof r?l(e,i.length,i):o(e,i,t)};return i(e.prototype)&&(s.prototype=e.prototype),s}},2858:(t,e,n)=>{var r=n(3679),i=n(3336)("toStringTag"),o="Arguments"==r(function(){return arguments}());t.exports=function(t){var e,n,a;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),i))?n:o?r(e):"Object"==(a=r(e))&&"function"==typeof e.callee?"Arguments":a}},3679:t=>{var e={}.toString;t.exports=function(t){return e.call(t).slice(8,-1)}},4396:(t,e,n)=>{"use strict";var r=n(4835).f,i=n(4275),o=n(7228),a=n(566),s=n(2702),l=n(2734),u=n(4873),c=n(7218),h=n(4798),f=n(4926),d=n(3763).fastKey,p=n(8546),y=f?"_s":"size",v=function(t,e){var n,r=d(e);if("F"!==r)return t._i[r];for(n=t._f;n;n=n.n)if(n.k==e)return n};t.exports={getConstructor:function(t,e,n,u){var c=t((function(t,r){s(t,c,e,"_i"),t._t=e,t._i=i(null),t._f=void 0,t._l=void 0,t[y]=0,null!=r&&l(r,n,t[u],t)}));return o(c.prototype,{clear:function(){for(var t=p(this,e),n=t._i,r=t._f;r;r=r.n)r.r=!0,r.p&&(r.p=r.p.n=void 0),delete n[r.i];t._f=t._l=void 0,t[y]=0},delete:function(t){var n=p(this,e),r=v(n,t);if(r){var i=r.n,o=r.p;delete n._i[r.i],r.r=!0,o&&(o.n=i),i&&(i.p=o),n._f==r&&(n._f=i),n._l==r&&(n._l=o),n[y]--}return!!r},forEach:function(t){p(this,e);for(var n,r=a(t,arguments.length>1?arguments[1]:void 0,3);n=n?n.n:this._f;)for(r(n.v,n.k,this);n&&n.r;)n=n.p},has:function(t){return!!v(p(this,e),t)}}),f&&r(c.prototype,"size",{get:function(){return p(this,e)[y]}}),c},def:function(t,e,n){var r,i,o=v(t,e);return o?o.v=n:(t._l=o={i:i=d(e,!0),k:e,v:n,p:r=t._l,n:void 0,r:!1},t._f||(t._f=o),r&&(r.n=o),t[y]++,"F"!==i&&(t._i[i]=o)),t},getEntry:v,setStrong:function(t,e,n){u(t,e,(function(t,n){this._t=p(t,e),this._k=n,this._l=void 0}),(function(){for(var t=this,e=t._k,n=t._l;n&&n.r;)n=n.p;return t._t&&(t._l=n=n?n.n:t._t._f)?c(0,"keys"==e?n.k:"values"==e?n.v:[n.k,n.v]):(t._t=void 0,c(1))}),n?"entries":"values",!n,!0),h(e)}}},4495:(t,e,n)=>{"use strict";var r=n(7228),i=n(3763).getWeak,o=n(6154),a=n(7156),s=n(2702),l=n(2734),u=n(3970),c=n(5389),h=n(8546),f=u(5),d=u(6),p=0,y=function(t){return t._l||(t._l=new v)},v=function(){this.a=[]},g=function(t,e){return f(t.a,(function(t){return t[0]===e}))};v.prototype={get:function(t){var e=g(this,t);if(e)return e[1]},has:function(t){return!!g(this,t)},set:function(t,e){var n=g(this,t);n?n[1]=e:this.a.push([t,e])},delete:function(t){var e=d(this.a,(function(e){return e[0]===t}));return~e&&this.a.splice(e,1),!!~e}},t.exports={getConstructor:function(t,e,n,o){var u=t((function(t,r){s(t,u,e,"_i"),t._t=e,t._i=p++,t._l=void 0,null!=r&&l(r,n,t[o],t)}));return r(u.prototype,{delete:function(t){if(!a(t))return!1;var n=i(t);return!0===n?y(h(this,e)).delete(t):n&&c(n,this._i)&&delete n[this._i]},has:function(t){if(!a(t))return!1;var n=i(t);return!0===n?y(h(this,e)).has(t):n&&c(n,this._i)}}),u},def:function(t,e,n){var r=i(o(e),!0);return!0===r?y(t).set(e,n):r[t._i]=n,t},ufstore:y}},1966:(t,e,n)=>{"use strict";var r=n(7381),i=n(5913),o=n(7278),a=n(7228),s=n(3763),l=n(2734),u=n(2702),c=n(7156),h=n(5810),f=n(5508),d=n(8094),p=n(3654);t.exports=function(t,e,n,y,v,g){var m=r[t],_=m,b=v?"set":"add",x=_&&_.prototype,w={},T=function(t){var e=x[t];o(x,t,"delete"==t||"has"==t?function(t){return!(g&&!c(t))&&e.call(this,0===t?0:t)}:"get"==t?function(t){return g&&!c(t)?void 0:e.call(this,0===t?0:t)}:"add"==t?function(t){return e.call(this,0===t?0:t),this}:function(t,n){return e.call(this,0===t?0:t,n),this})};if("function"==typeof _&&(g||x.forEach&&!h((function(){(new _).entries().next()})))){var E=new _,S=E[b](g?{}:-0,1)!=E,k=h((function(){E.has(1)})),O=f((function(t){new _(t)})),A=!g&&h((function(){for(var t=new _,e=5;e--;)t[b](e,e);return!t.has(-0)}));O||((_=e((function(e,n){u(e,_,t);var r=p(new m,e,_);return null!=n&&l(n,v,r[b],r),r}))).prototype=x,x.constructor=_),(k||A)&&(T("delete"),T("has"),v&&T("get")),(A||S)&&T(b),g&&x.clear&&delete x.clear}else _=y.getConstructor(e,t,v,b),a(_.prototype,n),s.NEED=!0;return d(_,t),w[t]=_,i(i.G+i.W+i.F*(_!=m),w),g||y.setStrong(_,t,v),_}},8544:t=>{var e=t.exports={version:"2.6.12"};"number"==typeof __e&&(__e=e)},1348:(t,e,n)=>{"use strict";var r=n(4835),i=n(6256);t.exports=function(t,e,n){e in t?r.f(t,e,i(0,n)):t[e]=n}},566:(t,e,n)=>{var r=n(6819);t.exports=function(t,e,n){if(r(t),void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,i){return t.call(e,n,r,i)}}return function(){return t.apply(e,arguments)}}},2115:(t,e,n)=>{"use strict";var r=n(5810),i=Date.prototype.getTime,o=Date.prototype.toISOString,a=function(t){return t>9?t:"0"+t};t.exports=r((function(){return"0385-07-25T07:06:39.999Z"!=o.call(new Date(-50000000000001))}))||!r((function(){o.call(new Date(NaN))}))?function(){if(!isFinite(i.call(this)))throw RangeError("Invalid time value");var t=this,e=t.getUTCFullYear(),n=t.getUTCMilliseconds(),r=e<0?"-":e>9999?"+":"";return r+("00000"+Math.abs(e)).slice(r?-6:-4)+"-"+a(t.getUTCMonth()+1)+"-"+a(t.getUTCDate())+"T"+a(t.getUTCHours())+":"+a(t.getUTCMinutes())+":"+a(t.getUTCSeconds())+"."+(n>99?n:"0"+a(n))+"Z"}:o},296:(t,e,n)=>{"use strict";var r=n(6154),i=n(8537),o="number";t.exports=function(t){if("string"!==t&&t!==o&&"default"!==t)throw TypeError("Incorrect hint");return i(r(this),t!=o)}},408:t=>{t.exports=function(t){if(null==t)throw TypeError("Can't call method on  "+t);return t}},4926:(t,e,n)=>{t.exports=!n(5810)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},2241:(t,e,n)=>{var r=n(7156),i=n(7381).document,o=r(i)&&r(i.createElement);t.exports=function(t){return o?i.createElement(t):{}}},6921:t=>{t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},8727:(t,e,n)=>{var r=n(9924),i=n(5421),o=n(4616);t.exports=function(t){var e=r(t),n=i.f;if(n)for(var a,s=n(t),l=o.f,u=0;s.length>u;)l.call(t,a=s[u++])&&e.push(a);return e}},5913:(t,e,n)=>{var r=n(7381),i=n(8544),o=n(8012),a=n(7278),s=n(566),l=function t(e,n,l){var u,c,h,f,d=e&t.F,p=e&t.G,y=e&t.P,v=e&t.B,g=p?r:e&t.S?r[n]||(r[n]={}):(r[n]||{}).prototype,m=p?i:i[n]||(i[n]={}),_=m.prototype||(m.prototype={});for(u in p&&(l=n),l)h=((c=!d&&g&&void 0!==g[u])?g:l)[u],f=v&&c?s(h,r):y&&"function"==typeof h?s(Function.call,h):h,g&&a(g,u,h,e&t.U),m[u]!=h&&o(m,u,f),y&&_[u]!=h&&(_[u]=h)};r.core=i,l.F=1,l.G=2,l.S=4,l.P=8,l.B=16,l.W=32,l.U=64,l.R=128,t.exports=l},3483:(t,e,n)=>{var r=n(3336)("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(n){try{return e[r]=!1,!"/./"[t](e)}catch(t){}}return!0}},5810:t=>{t.exports=function(t){try{return!!t()}catch(t){return!0}}},8644:(t,e,n)=>{"use strict";n(5997);var r=n(7278),i=n(8012),o=n(5810),a=n(408),s=n(3336),l=n(6997),u=s("species"),c=!o((function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")})),h=function(){var t=/(?:)/,e=t.exec;t.exec=function(){return e.apply(this,arguments)};var n="ab".split(t);return 2===n.length&&"a"===n[0]&&"b"===n[1]}();t.exports=function(t,e,n){var f=s(t),d=!o((function(){var e={};return e[f]=function(){return 7},7!=""[t](e)})),p=d?!o((function(){var e=!1,n=/a/;return n.exec=function(){return e=!0,null},"split"===t&&(n.constructor={},n.constructor[u]=function(){return n}),n[f](""),!e})):void 0;if(!d||!p||"replace"===t&&!c||"split"===t&&!h){var y=/./[f],v=n(a,f,""[t],(function(t,e,n,r,i){return e.exec===l?d&&!i?{done:!0,value:y.call(e,n,r)}:{done:!0,value:t.call(n,e,r)}:{done:!1}})),g=v[0],m=v[1];r(String.prototype,t,g),i(RegExp.prototype,f,2==e?function(t,e){return m.call(t,this,e)}:function(t){return m.call(t,this)})}}},2188:(t,e,n)=>{"use strict";var r=n(6154);t.exports=function(){var t=r(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}},3120:(t,e,n)=>{"use strict";var r=n(1320),i=n(7156),o=n(8315),a=n(566),s=n(3336)("isConcatSpreadable");t.exports=function t(e,n,l,u,c,h,f,d){for(var p,y,v=c,g=0,m=!!f&&a(f,d,3);g<u;){if(g in l){if(p=m?m(l[g],g,n):l[g],y=!1,i(p)&&(y=void 0!==(y=p[s])?!!y:r(p)),y&&h>0)v=t(e,n,p,o(p.length),v,h-1)-1;else{if(v>=9007199254740991)throw TypeError();e[v]=p}v++}g++}return v}},2734:(t,e,n)=>{var r=n(566),i=n(2471),o=n(7063),a=n(6154),s=n(8315),l=n(7637),u={},c={},h=t.exports=function(t,e,n,h,f){var d,p,y,v,g=f?function(){return t}:l(t),m=r(n,h,e?2:1),_=0;if("function"!=typeof g)throw TypeError(t+" is not iterable!");if(o(g)){for(d=s(t.length);d>_;_++)if((v=e?m(a(p=t[_])[0],p[1]):m(t[_]))===u||v===c)return v}else for(y=g.call(t);!(p=y.next()).done;)if((v=i(y,m,p.value,e))===u||v===c)return v};h.BREAK=u,h.RETURN=c},1174:(t,e,n)=>{t.exports=n(3192)("native-function-to-string",Function.toString)},7381:t=>{var e=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=e)},5389:t=>{var e={}.hasOwnProperty;t.exports=function(t,n){return e.call(t,n)}},8012:(t,e,n)=>{var r=n(4835),i=n(6256);t.exports=n(4926)?function(t,e,n){return r.f(t,e,i(1,n))}:function(t,e,n){return t[e]=n,t}},1225:(t,e,n)=>{var r=n(7381).document;t.exports=r&&r.documentElement},5142:(t,e,n)=>{t.exports=!n(4926)&&!n(5810)((function(){return 7!=Object.defineProperty(n(2241)("div"),"a",{get:function(){return 7}}).a}))},3654:(t,e,n)=>{var r=n(7156),i=n(6931).set;t.exports=function(t,e,n){var o,a=e.constructor;return a!==n&&"function"==typeof a&&(o=a.prototype)!==n.prototype&&r(o)&&i&&i(t,o),t}},2765:t=>{t.exports=function(t,e,n){var r=void 0===n;switch(e.length){case 0:return r?t():t.call(n);case 1:return r?t(e[0]):t.call(n,e[0]);case 2:return r?t(e[0],e[1]):t.call(n,e[0],e[1]);case 3:return r?t(e[0],e[1],e[2]):t.call(n,e[0],e[1],e[2]);case 4:return r?t(e[0],e[1],e[2],e[3]):t.call(n,e[0],e[1],e[2],e[3])}return t.apply(n,e)}},331:(t,e,n)=>{var r=n(3679);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==r(t)?t.split(""):Object(t)}},7063:(t,e,n)=>{var r=n(5301),i=n(3336)("iterator"),o=Array.prototype;t.exports=function(t){return void 0!==t&&(r.Array===t||o[i]===t)}},1320:(t,e,n)=>{var r=n(3679);t.exports=Array.isArray||function(t){return"Array"==r(t)}},5127:(t,e,n)=>{var r=n(7156),i=Math.floor;t.exports=function(t){return!r(t)&&isFinite(t)&&i(t)===t}},7156:t=>{function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e(t)}t.exports=function(t){return"object"===e(t)?null!==t:"function"==typeof t}},1993:(t,e,n)=>{var r=n(7156),i=n(3679),o=n(3336)("match");t.exports=function(t){var e;return r(t)&&(void 0!==(e=t[o])?!!e:"RegExp"==i(t))}},2471:(t,e,n)=>{var r=n(6154);t.exports=function(t,e,n,i){try{return i?e(r(n)[0],n[1]):e(n)}catch(e){var o=t.return;throw void 0!==o&&r(o.call(t)),e}}},8258:(t,e,n)=>{"use strict";var r=n(4275),i=n(6256),o=n(8094),a={};n(8012)(a,n(3336)("iterator"),(function(){return this})),t.exports=function(t,e,n){t.prototype=r(a,{next:i(1,n)}),o(t,e+" Iterator")}},4873:(t,e,n)=>{"use strict";var r=n(4219),i=n(5913),o=n(7278),a=n(8012),s=n(5301),l=n(8258),u=n(8094),c=n(4153),h=n(3336)("iterator"),f=!([].keys&&"next"in[].keys()),d="keys",p="values",y=function(){return this};t.exports=function(t,e,n,v,g,m,_){l(n,e,v);var b,x,w,T=function(t){if(!f&&t in O)return O[t];switch(t){case d:case p:return function(){return new n(this,t)}}return function(){return new n(this,t)}},E=e+" Iterator",S=g==p,k=!1,O=t.prototype,A=O[h]||O["@@iterator"]||g&&O[g],P=A||T(g),C=g?S?T("entries"):P:void 0,R="Array"==e&&O.entries||A;if(R&&(w=c(R.call(new t)))!==Object.prototype&&w.next&&(u(w,E,!0),r||"function"==typeof w[h]||a(w,h,y)),S&&A&&A.name!==p&&(k=!0,P=function(){return A.call(this)}),r&&!_||!f&&!k&&O[h]||a(O,h,P),s[e]=P,s[E]=y,g)if(b={values:S?P:T(p),keys:m?P:T(d),entries:C},_)for(x in b)x in O||o(O,x,b[x]);else i(i.P+i.F*(f||k),e,b);return b}},5508:(t,e,n)=>{var r=n(3336)("iterator"),i=!1;try{var o=[7][r]();o.return=function(){i=!0},Array.from(o,(function(){throw 2}))}catch(t){}t.exports=function(t,e){if(!e&&!i)return!1;var n=!1;try{var o=[7],a=o[r]();a.next=function(){return{done:n=!0}},o[r]=function(){return a},t(o)}catch(t){}return n}},7218:t=>{t.exports=function(t,e){return{value:e,done:!!t}}},5301:t=>{t.exports={}},4219:t=>{t.exports=!1},4774:t=>{var e=Math.expm1;t.exports=!e||e(10)>22025.465794806718||e(10)<22025.465794806718||-2e-17!=e(-2e-17)?function(t){return 0==(t=+t)?t:t>-1e-6&&t<1e-6?t+t*t/2:Math.exp(t)-1}:e},3800:(t,e,n)=>{var r=n(4012),i=Math.pow,o=i(2,-52),a=i(2,-23),s=i(2,127)*(2-a),l=i(2,-126);t.exports=Math.fround||function(t){var e,n,i=Math.abs(t),u=r(t);return i<l?u*(i/l/a+1/o-1/o)*l*a:(n=(e=(1+a/o)*i)-(e-i))>s||n!=n?u*(1/0):u*n}},5447:t=>{t.exports=Math.log1p||function(t){return(t=+t)>-1e-8&&t<1e-8?t-t*t/2:Math.log(1+t)}},4012:t=>{t.exports=Math.sign||function(t){return 0==(t=+t)||t!=t?t:t<0?-1:1}},3763:(t,e,n)=>{function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}var i=n(7936)("meta"),o=n(7156),a=n(5389),s=n(4835).f,l=0,u=Object.isExtensible||function(){return!0},c=!n(5810)((function(){return u(Object.preventExtensions({}))})),h=function(t){s(t,i,{value:{i:"O"+ ++l,w:{}}})},f=t.exports={KEY:i,NEED:!1,fastKey:function(t,e){if(!o(t))return"symbol"==r(t)?t:("string"==typeof t?"S":"P")+t;if(!a(t,i)){if(!u(t))return"F";if(!e)return"E";h(t)}return t[i].i},getWeak:function(t,e){if(!a(t,i)){if(!u(t))return!0;if(!e)return!1;h(t)}return t[i].w},onFreeze:function(t){return c&&f.NEED&&u(t)&&!a(t,i)&&h(t),t}}},1842:(t,e,n)=>{var r=n(7381),i=n(8220).set,o=r.MutationObserver||r.WebKitMutationObserver,a=r.process,s=r.Promise,l="process"==n(3679)(a);t.exports=function(){var t,e,n,u=function(){var r,i;for(l&&(r=a.domain)&&r.exit();t;){i=t.fn,t=t.next;try{i()}catch(r){throw t?n():e=void 0,r}}e=void 0,r&&r.enter()};if(l)n=function(){a.nextTick(u)};else if(!o||r.navigator&&r.navigator.standalone)if(s&&s.resolve){var c=s.resolve(void 0);n=function(){c.then(u)}}else n=function(){i.call(r,u)};else{var h=!0,f=document.createTextNode("");new o(u).observe(f,{characterData:!0}),n=function(){f.data=h=!h}}return function(r){var i={fn:r,next:void 0};e&&(e.next=i),t||(t=i,n()),e=i}}},4086:(t,e,n)=>{"use strict";var r=n(6819);function i(t){var e,n;this.promise=new t((function(t,r){if(void 0!==e||void 0!==n)throw TypeError("Bad Promise constructor");e=t,n=r})),this.resolve=r(e),this.reject=r(n)}t.exports.f=function(t){return new i(t)}},8559:(t,e,n)=>{"use strict";var r=n(4926),i=n(9924),o=n(5421),a=n(4616),s=n(2515),l=n(331),u=Object.assign;t.exports=!u||n(5810)((function(){var t={},e={},n=Symbol(),r="abcdefghijklmnopqrst";return t[n]=7,r.split("").forEach((function(t){e[t]=t})),7!=u({},t)[n]||Object.keys(u({},e)).join("")!=r}))?function(t,e){for(var n=s(t),u=arguments.length,c=1,h=o.f,f=a.f;u>c;)for(var d,p=l(arguments[c++]),y=h?i(p).concat(h(p)):i(p),v=y.length,g=0;v>g;)d=y[g++],r&&!f.call(p,d)||(n[d]=p[d]);return n}:u},4275:(t,e,n)=>{var r=n(6154),i=n(6447),o=n(6921),a=n(8662)("IE_PROTO"),s=function(){},l=function(){var t,e=n(2241)("iframe"),r=o.length;for(e.style.display="none",n(1225).appendChild(e),e.src="javascript:",(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),l=t.F;r--;)delete l.prototype[o[r]];return l()};t.exports=Object.create||function(t,e){var n;return null!==t?(s.prototype=r(t),n=new s,s.prototype=null,n[a]=t):n=l(),void 0===e?n:i(n,e)}},4835:(t,e,n)=>{var r=n(6154),i=n(5142),o=n(8537),a=Object.defineProperty;e.f=n(4926)?Object.defineProperty:function(t,e,n){if(r(t),e=o(e,!0),r(n),i)try{return a(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},6447:(t,e,n)=>{var r=n(4835),i=n(6154),o=n(9924);t.exports=n(4926)?Object.defineProperties:function(t,e){i(t);for(var n,a=o(e),s=a.length,l=0;s>l;)r.f(t,n=a[l++],e[n]);return t}},3299:(t,e,n)=>{var r=n(4616),i=n(6256),o=n(8499),a=n(8537),s=n(5389),l=n(5142),u=Object.getOwnPropertyDescriptor;e.f=n(4926)?u:function(t,e){if(t=o(t),e=a(e,!0),l)try{return u(t,e)}catch(t){}if(s(t,e))return i(!r.f.call(t,e),t[e])}},3136:(t,e,n)=>{function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}var i=n(8499),o=n(2982).f,a={}.toString,s="object"==("undefined"==typeof window?"undefined":r(window))&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];t.exports.f=function(t){return s&&"[object Window]"==a.call(t)?function(t){try{return o(t)}catch(t){return s.slice()}}(t):o(i(t))}},2982:(t,e,n)=>{var r=n(7960),i=n(6921).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return r(t,i)}},5421:(t,e)=>{e.f=Object.getOwnPropertySymbols},4153:(t,e,n)=>{var r=n(5389),i=n(2515),o=n(8662)("IE_PROTO"),a=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=i(t),r(t,o)?t[o]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?a:null}},7960:(t,e,n)=>{var r=n(5389),i=n(8499),o=n(4687)(!1),a=n(8662)("IE_PROTO");t.exports=function(t,e){var n,s=i(t),l=0,u=[];for(n in s)n!=a&&r(s,n)&&u.push(n);for(;e.length>l;)r(s,n=e[l++])&&(~o(u,n)||u.push(n));return u}},9924:(t,e,n)=>{var r=n(7960),i=n(6921);t.exports=Object.keys||function(t){return r(t,i)}},4616:(t,e)=>{e.f={}.propertyIsEnumerable},4057:(t,e,n)=>{var r=n(5913),i=n(8544),o=n(5810);t.exports=function(t,e){var n=(i.Object||{})[t]||Object[t],a={};a[t]=e(n),r(r.S+r.F*o((function(){n(1)})),"Object",a)}},8941:(t,e,n)=>{var r=n(4926),i=n(9924),o=n(8499),a=n(4616).f;t.exports=function(t){return function(e){for(var n,s=o(e),l=i(s),u=l.length,c=0,h=[];u>c;)n=l[c++],r&&!a.call(s,n)||h.push(t?[n,s[n]]:s[n]);return h}}},2600:(t,e,n)=>{var r=n(2982),i=n(5421),o=n(6154),a=n(7381).Reflect;t.exports=a&&a.ownKeys||function(t){var e=r.f(o(t)),n=i.f;return n?e.concat(n(t)):e}},5031:(t,e,n)=>{var r=n(7381).parseFloat,i=n(618).trim;t.exports=1/r(n(3596)+"-0")!=-1/0?function(t){var e=i(String(t),3),n=r(e);return 0===n&&"-"==e.charAt(0)?-0:n}:r},6971:(t,e,n)=>{var r=n(7381).parseInt,i=n(618).trim,o=n(3596),a=/^[-+]?0[xX]/;t.exports=8!==r(o+"08")||22!==r(o+"0x16")?function(t,e){var n=i(String(t),3);return r(n,e>>>0||(a.test(n)?16:10))}:r},8228:t=>{t.exports=function(t){try{return{e:!1,v:t()}}catch(t){return{e:!0,v:t}}}},3507:(t,e,n)=>{var r=n(6154),i=n(7156),o=n(4086);t.exports=function(t,e){if(r(t),i(e)&&e.constructor===t)return e;var n=o.f(t);return(0,n.resolve)(e),n.promise}},6256:t=>{t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},7228:(t,e,n)=>{var r=n(7278);t.exports=function(t,e,n){for(var i in e)r(t,i,e[i],n);return t}},7278:(t,e,n)=>{var r=n(7381),i=n(8012),o=n(5389),a=n(7936)("src"),s=n(1174),l="toString",u=(""+s).split(l);n(8544).inspectSource=function(t){return s.call(t)},(t.exports=function(t,e,n,s){var l="function"==typeof n;l&&(o(n,"name")||i(n,"name",e)),t[e]!==n&&(l&&(o(n,a)||i(n,a,t[e]?""+t[e]:u.join(String(e)))),t===r?t[e]=n:s?t[e]?t[e]=n:i(t,e,n):(delete t[e],i(t,e,n)))})(Function.prototype,l,(function(){return"function"==typeof this&&this[a]||s.call(this)}))},4585:(t,e,n)=>{"use strict";function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}var i=n(2858),o=RegExp.prototype.exec;t.exports=function(t,e){var n=t.exec;if("function"==typeof n){var a=n.call(t,e);if("object"!==r(a))throw new TypeError("RegExp exec method returned something other than an Object or null");return a}if("RegExp"!==i(t))throw new TypeError("RegExp#exec called on incompatible receiver");return o.call(t,e)}},6997:(t,e,n)=>{"use strict";var r,i,o=n(2188),a=RegExp.prototype.exec,s=String.prototype.replace,l=a,u=(r=/a/,i=/b*/g,a.call(r,"a"),a.call(i,"a"),0!==r.lastIndex||0!==i.lastIndex),c=void 0!==/()??/.exec("")[1];(u||c)&&(l=function(t){var e,n,r,i,l=this;return c&&(n=new RegExp("^"+l.source+"$(?!\\s)",o.call(l))),u&&(e=l.lastIndex),r=a.call(l,t),u&&r&&(l.lastIndex=l.global?r.index+r[0].length:e),c&&r&&r.length>1&&s.call(r[0],n,(function(){for(i=1;i<arguments.length-2;i++)void 0===arguments[i]&&(r[i]=void 0)})),r}),t.exports=l},4261:t=>{t.exports=Object.is||function(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e}},6931:(t,e,n)=>{var r=n(7156),i=n(6154),o=function(t,e){if(i(t),!r(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,r){try{(r=n(566)(Function.call,n(3299).f(Object.prototype,"__proto__").set,2))(t,[]),e=!(t instanceof Array)}catch(t){e=!0}return function(t,n){return o(t,n),e?t.__proto__=n:r(t,n),t}}({},!1):void 0),check:o}},4798:(t,e,n)=>{"use strict";var r=n(7381),i=n(4835),o=n(4926),a=n(3336)("species");t.exports=function(t){var e=r[t];o&&e&&!e[a]&&i.f(e,a,{configurable:!0,get:function(){return this}})}},8094:(t,e,n)=>{var r=n(4835).f,i=n(5389),o=n(3336)("toStringTag");t.exports=function(t,e,n){t&&!i(t=n?t:t.prototype,o)&&r(t,o,{configurable:!0,value:e})}},8662:(t,e,n)=>{var r=n(3192)("keys"),i=n(7936);t.exports=function(t){return r[t]||(r[t]=i(t))}},3192:(t,e,n)=>{var r=n(8544),i=n(7381),o="__core-js_shared__",a=i[o]||(i[o]={});(t.exports=function(t,e){return a[t]||(a[t]=void 0!==e?e:{})})("versions",[]).push({version:r.version,mode:n(4219)?"pure":"global",copyright:"© 2020 Denis Pushkarev (zloirock.ru)"})},2035:(t,e,n)=>{var r=n(6154),i=n(6819),o=n(3336)("species");t.exports=function(t,e){var n,a=r(t).constructor;return void 0===a||null==(n=r(a)[o])?e:i(n)}},1411:(t,e,n)=>{"use strict";var r=n(5810);t.exports=function(t,e){return!!t&&r((function(){e?t.call(null,(function(){}),1):t.call(null)}))}},3593:(t,e,n)=>{var r=n(3230),i=n(408);t.exports=function(t){return function(e,n){var o,a,s=String(i(e)),l=r(n),u=s.length;return l<0||l>=u?t?"":void 0:(o=s.charCodeAt(l))<55296||o>56319||l+1===u||(a=s.charCodeAt(l+1))<56320||a>57343?t?s.charAt(l):o:t?s.slice(l,l+2):a-56320+(o-55296<<10)+65536}}},2376:(t,e,n)=>{var r=n(1993),i=n(408);t.exports=function(t,e,n){if(r(e))throw TypeError("String#"+n+" doesn't accept regex!");return String(i(t))}},9927:(t,e,n)=>{var r=n(5913),i=n(5810),o=n(408),a=/"/g,s=function(t,e,n,r){var i=String(o(t)),s="<"+e;return""!==n&&(s+=" "+n+'="'+String(r).replace(a,"&quot;")+'"'),s+">"+i+"</"+e+">"};t.exports=function(t,e){var n={};n[t]=e(s),r(r.P+r.F*i((function(){var e=""[t]('"');return e!==e.toLowerCase()||e.split('"').length>3})),"String",n)}},1925:(t,e,n)=>{var r=n(8315),i=n(1924),o=n(408);t.exports=function(t,e,n,a){var s=String(o(t)),l=s.length,u=void 0===n?" ":String(n),c=r(e);if(c<=l||""==u)return s;var h=c-l,f=i.call(u,Math.ceil(h/u.length));return f.length>h&&(f=f.slice(0,h)),a?f+s:s+f}},1924:(t,e,n)=>{"use strict";var r=n(3230),i=n(408);t.exports=function(t){var e=String(i(this)),n="",o=r(t);if(o<0||o==1/0)throw RangeError("Count can't be negative");for(;o>0;(o>>>=1)&&(e+=e))1&o&&(n+=e);return n}},618:(t,e,n)=>{var r=n(5913),i=n(408),o=n(5810),a=n(3596),s="["+a+"]",l=RegExp("^"+s+s+"*"),u=RegExp(s+s+"*$"),c=function(t,e,n){var i={},s=o((function(){return!!a[t]()||"​"!="​"[t]()})),l=i[t]=s?e(h):a[t];n&&(i[n]=l),r(r.P+r.F*s,"String",i)},h=c.trim=function(t,e){return t=String(i(t)),1&e&&(t=t.replace(l,"")),2&e&&(t=t.replace(u,"")),t};t.exports=c},3596:t=>{t.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},8220:(t,e,n)=>{var r,i,o,a=n(566),s=n(2765),l=n(1225),u=n(2241),c=n(7381),h=c.process,f=c.setImmediate,d=c.clearImmediate,p=c.MessageChannel,y=c.Dispatch,v=0,g={},m=function(){var t=+this;if(g.hasOwnProperty(t)){var e=g[t];delete g[t],e()}},_=function(t){m.call(t.data)};f&&d||(f=function(t){for(var e=[],n=1;arguments.length>n;)e.push(arguments[n++]);return g[++v]=function(){s("function"==typeof t?t:Function(t),e)},r(v),v},d=function(t){delete g[t]},"process"==n(3679)(h)?r=function(t){h.nextTick(a(m,t,1))}:y&&y.now?r=function(t){y.now(a(m,t,1))}:p?(o=(i=new p).port2,i.port1.onmessage=_,r=a(o.postMessage,o,1)):c.addEventListener&&"function"==typeof postMessage&&!c.importScripts?(r=function(t){c.postMessage(t+"","*")},c.addEventListener("message",_,!1)):r="onreadystatechange"in u("script")?function(t){l.appendChild(u("script")).onreadystatechange=function(){l.removeChild(this),m.call(t)}}:function(t){setTimeout(a(m,t,1),0)}),t.exports={set:f,clear:d}},6241:(t,e,n)=>{var r=n(3230),i=Math.max,o=Math.min;t.exports=function(t,e){return(t=r(t))<0?i(t+e,0):o(t,e)}},3472:(t,e,n)=>{var r=n(3230),i=n(8315);t.exports=function(t){if(void 0===t)return 0;var e=r(t),n=i(e);if(e!==n)throw RangeError("Wrong length!");return n}},3230:t=>{var e=Math.ceil,n=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?n:e)(t)}},8499:(t,e,n)=>{var r=n(331),i=n(408);t.exports=function(t){return r(i(t))}},8315:(t,e,n)=>{var r=n(3230),i=Math.min;t.exports=function(t){return t>0?i(r(t),9007199254740991):0}},2515:(t,e,n)=>{var r=n(408);t.exports=function(t){return Object(r(t))}},8537:(t,e,n)=>{var r=n(7156);t.exports=function(t,e){if(!r(t))return t;var n,i;if(e&&"function"==typeof(n=t.toString)&&!r(i=n.call(t)))return i;if("function"==typeof(n=t.valueOf)&&!r(i=n.call(t)))return i;if(!e&&"function"==typeof(n=t.toString)&&!r(i=n.call(t)))return i;throw TypeError("Can't convert object to primitive value")}},431:(t,e,n)=>{"use strict";function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}if(n(4926)){var i=n(4219),o=n(7381),a=n(5810),s=n(5913),l=n(9161),u=n(9782),c=n(566),h=n(2702),f=n(6256),d=n(8012),p=n(7228),y=n(3230),v=n(8315),g=n(3472),m=n(6241),_=n(8537),b=n(5389),x=n(2858),w=n(7156),T=n(2515),E=n(7063),S=n(4275),k=n(4153),O=n(2982).f,A=n(7637),P=n(7936),C=n(3336),R=n(3970),I=n(4687),M=n(2035),L=n(4806),$=n(5301),D=n(5508),j=n(4798),B=n(1132),N=n(2147),F=n(4835),V=n(3299),G=F.f,z=V.f,U=o.RangeError,H=o.TypeError,X=o.Uint8Array,W="ArrayBuffer",Y="SharedArrayBuffer",q="BYTES_PER_ELEMENT",K=Array.prototype,Z=u.ArrayBuffer,J=u.DataView,Q=R(0),tt=R(2),et=R(3),nt=R(4),rt=R(5),it=R(6),ot=I(!0),at=I(!1),st=L.values,lt=L.keys,ut=L.entries,ct=K.lastIndexOf,ht=K.reduce,ft=K.reduceRight,dt=K.join,pt=K.sort,yt=K.slice,vt=K.toString,gt=K.toLocaleString,mt=C("iterator"),_t=C("toStringTag"),bt=P("typed_constructor"),xt=P("def_constructor"),wt=l.CONSTR,Tt=l.TYPED,Et=l.VIEW,St="Wrong length!",kt=R(1,(function(t,e){return Rt(M(t,t[xt]),e)})),Ot=a((function(){return 1===new X(new Uint16Array([1]).buffer)[0]})),At=!!X&&!!X.prototype.set&&a((function(){new X(1).set({})})),Pt=function(t,e){var n=y(t);if(n<0||n%e)throw U("Wrong offset!");return n},Ct=function(t){if(w(t)&&Tt in t)return t;throw H(t+" is not a typed array!")},Rt=function(t,e){if(!w(t)||!(bt in t))throw H("It is not a typed array constructor!");return new t(e)},It=function(t,e){return Mt(M(t,t[xt]),e)},Mt=function(t,e){for(var n=0,r=e.length,i=Rt(t,r);r>n;)i[n]=e[n++];return i},Lt=function(t,e,n){G(t,e,{get:function(){return this._d[n]}})},$t=function(t){var e,n,r,i,o,a,s=T(t),l=arguments.length,u=l>1?arguments[1]:void 0,h=void 0!==u,f=A(s);if(null!=f&&!E(f)){for(a=f.call(s),r=[],e=0;!(o=a.next()).done;e++)r.push(o.value);s=r}for(h&&l>2&&(u=c(u,arguments[2],2)),e=0,n=v(s.length),i=Rt(this,n);n>e;e++)i[e]=h?u(s[e],e):s[e];return i},Dt=function(){for(var t=0,e=arguments.length,n=Rt(this,e);e>t;)n[t]=arguments[t++];return n},jt=!!X&&a((function(){gt.call(new X(1))})),Bt=function(){return gt.apply(jt?yt.call(Ct(this)):Ct(this),arguments)},Nt={copyWithin:function(t,e){return N.call(Ct(this),t,e,arguments.length>2?arguments[2]:void 0)},every:function(t){return nt(Ct(this),t,arguments.length>1?arguments[1]:void 0)},fill:function(t){return B.apply(Ct(this),arguments)},filter:function(t){return It(this,tt(Ct(this),t,arguments.length>1?arguments[1]:void 0))},find:function(t){return rt(Ct(this),t,arguments.length>1?arguments[1]:void 0)},findIndex:function(t){return it(Ct(this),t,arguments.length>1?arguments[1]:void 0)},forEach:function(t){Q(Ct(this),t,arguments.length>1?arguments[1]:void 0)},indexOf:function(t){return at(Ct(this),t,arguments.length>1?arguments[1]:void 0)},includes:function(t){return ot(Ct(this),t,arguments.length>1?arguments[1]:void 0)},join:function(t){return dt.apply(Ct(this),arguments)},lastIndexOf:function(t){return ct.apply(Ct(this),arguments)},map:function(t){return kt(Ct(this),t,arguments.length>1?arguments[1]:void 0)},reduce:function(t){return ht.apply(Ct(this),arguments)},reduceRight:function(t){return ft.apply(Ct(this),arguments)},reverse:function(){for(var t,e=this,n=Ct(e).length,r=Math.floor(n/2),i=0;i<r;)t=e[i],e[i++]=e[--n],e[n]=t;return e},some:function(t){return et(Ct(this),t,arguments.length>1?arguments[1]:void 0)},sort:function(t){return pt.call(Ct(this),t)},subarray:function(t,e){var n=Ct(this),r=n.length,i=m(t,r);return new(M(n,n[xt]))(n.buffer,n.byteOffset+i*n.BYTES_PER_ELEMENT,v((void 0===e?r:m(e,r))-i))}},Ft=function(t,e){return It(this,yt.call(Ct(this),t,e))},Vt=function(t){Ct(this);var e=Pt(arguments[1],1),n=this.length,r=T(t),i=v(r.length),o=0;if(i+e>n)throw U(St);for(;o<i;)this[e+o]=r[o++]},Gt={entries:function(){return ut.call(Ct(this))},keys:function(){return lt.call(Ct(this))},values:function(){return st.call(Ct(this))}},zt=function(t,e){return w(t)&&t[Tt]&&"symbol"!=r(e)&&e in t&&String(+e)==String(e)},Ut=function(t,e){return zt(t,e=_(e,!0))?f(2,t[e]):z(t,e)},Ht=function(t,e,n){return!(zt(t,e=_(e,!0))&&w(n)&&b(n,"value"))||b(n,"get")||b(n,"set")||n.configurable||b(n,"writable")&&!n.writable||b(n,"enumerable")&&!n.enumerable?G(t,e,n):(t[e]=n.value,t)};wt||(V.f=Ut,F.f=Ht),s(s.S+s.F*!wt,"Object",{getOwnPropertyDescriptor:Ut,defineProperty:Ht}),a((function(){vt.call({})}))&&(vt=gt=function(){return dt.call(this)});var Xt=p({},Nt);p(Xt,Gt),d(Xt,mt,Gt.values),p(Xt,{slice:Ft,set:Vt,constructor:function(){},toString:vt,toLocaleString:Bt}),Lt(Xt,"buffer","b"),Lt(Xt,"byteOffset","o"),Lt(Xt,"byteLength","l"),Lt(Xt,"length","e"),G(Xt,_t,{get:function(){return this[Tt]}}),t.exports=function(t,e,n,r){var u=t+((r=!!r)?"Clamped":"")+"Array",c="get"+t,f="set"+t,p=o[u],y=p||{},m=p&&k(p),_=!p||!l.ABV,b={},T=p&&p.prototype,E=function(t,n){G(t,n,{get:function(){return function(t,n){var r=t._d;return r.v[c](n*e+r.o,Ot)}(this,n)},set:function(t){return function(t,n,i){var o=t._d;r&&(i=(i=Math.round(i))<0?0:i>255?255:255&i),o.v[f](n*e+o.o,i,Ot)}(this,n,t)},enumerable:!0})};_?(p=n((function(t,n,r,i){h(t,p,u,"_d");var o,a,s,l,c=0,f=0;if(w(n)){if(!(n instanceof Z||(l=x(n))==W||l==Y))return Tt in n?Mt(p,n):$t.call(p,n);o=n,f=Pt(r,e);var y=n.byteLength;if(void 0===i){if(y%e)throw U(St);if((a=y-f)<0)throw U(St)}else if((a=v(i)*e)+f>y)throw U(St);s=a/e}else s=g(n),o=new Z(a=s*e);for(d(t,"_d",{b:o,o:f,l:a,e:s,v:new J(o)});c<s;)E(t,c++)})),T=p.prototype=S(Xt),d(T,"constructor",p)):a((function(){p(1)}))&&a((function(){new p(-1)}))&&D((function(t){new p,new p(null),new p(1.5),new p(t)}),!0)||(p=n((function(t,n,r,i){var o;return h(t,p,u),w(n)?n instanceof Z||(o=x(n))==W||o==Y?void 0!==i?new y(n,Pt(r,e),i):void 0!==r?new y(n,Pt(r,e)):new y(n):Tt in n?Mt(p,n):$t.call(p,n):new y(g(n))})),Q(m!==Function.prototype?O(y).concat(O(m)):O(y),(function(t){t in p||d(p,t,y[t])})),p.prototype=T,i||(T.constructor=p));var A=T[mt],P=!!A&&("values"==A.name||null==A.name),C=Gt.values;d(p,bt,!0),d(T,Tt,u),d(T,Et,!0),d(T,xt,p),(r?new p(1)[_t]==u:_t in T)||G(T,_t,{get:function(){return u}}),b[u]=p,s(s.G+s.W+s.F*(p!=y),b),s(s.S,u,{BYTES_PER_ELEMENT:e}),s(s.S+s.F*a((function(){y.of.call(p,1)})),u,{from:$t,of:Dt}),q in T||d(T,q,e),s(s.P,u,Nt),j(u),s(s.P+s.F*At,u,{set:Vt}),s(s.P+s.F*!P,u,Gt),i||T.toString==vt||(T.toString=vt),s(s.P+s.F*a((function(){new p(1).slice()})),u,{slice:Ft}),s(s.P+s.F*(a((function(){return[1,2].toLocaleString()!=new p([1,2]).toLocaleString()}))||!a((function(){T.toLocaleString.call([1,2])}))),u,{toLocaleString:Bt}),$[u]=P?A:C,i||P||d(T,mt,C)}}else t.exports=function(){}},9782:(t,e,n)=>{"use strict";var r=n(7381),i=n(4926),o=n(4219),a=n(9161),s=n(8012),l=n(7228),u=n(5810),c=n(2702),h=n(3230),f=n(8315),d=n(3472),p=n(2982).f,y=n(4835).f,v=n(1132),g=n(8094),m="ArrayBuffer",_="DataView",b="Wrong index!",x=r.ArrayBuffer,w=r.DataView,T=r.Math,E=r.RangeError,S=r.Infinity,k=x,O=T.abs,A=T.pow,P=T.floor,C=T.log,R=T.LN2,I="buffer",M="byteLength",L="byteOffset",$=i?"_b":I,D=i?"_l":M,j=i?"_o":L;function B(t,e,n){var r,i,o,a=new Array(n),s=8*n-e-1,l=(1<<s)-1,u=l>>1,c=23===e?A(2,-24)-A(2,-77):0,h=0,f=t<0||0===t&&1/t<0?1:0;for((t=O(t))!=t||t===S?(i=t!=t?1:0,r=l):(r=P(C(t)/R),t*(o=A(2,-r))<1&&(r--,o*=2),(t+=r+u>=1?c/o:c*A(2,1-u))*o>=2&&(r++,o/=2),r+u>=l?(i=0,r=l):r+u>=1?(i=(t*o-1)*A(2,e),r+=u):(i=t*A(2,u-1)*A(2,e),r=0));e>=8;a[h++]=255&i,i/=256,e-=8);for(r=r<<e|i,s+=e;s>0;a[h++]=255&r,r/=256,s-=8);return a[--h]|=128*f,a}function N(t,e,n){var r,i=8*n-e-1,o=(1<<i)-1,a=o>>1,s=i-7,l=n-1,u=t[l--],c=127&u;for(u>>=7;s>0;c=256*c+t[l],l--,s-=8);for(r=c&(1<<-s)-1,c>>=-s,s+=e;s>0;r=256*r+t[l],l--,s-=8);if(0===c)c=1-a;else{if(c===o)return r?NaN:u?-S:S;r+=A(2,e),c-=a}return(u?-1:1)*r*A(2,c-e)}function F(t){return t[3]<<24|t[2]<<16|t[1]<<8|t[0]}function V(t){return[255&t]}function G(t){return[255&t,t>>8&255]}function z(t){return[255&t,t>>8&255,t>>16&255,t>>24&255]}function U(t){return B(t,52,8)}function H(t){return B(t,23,4)}function X(t,e,n){y(t.prototype,e,{get:function(){return this[n]}})}function W(t,e,n,r){var i=d(+n);if(i+e>t[D])throw E(b);var o=t[$]._b,a=i+t[j],s=o.slice(a,a+e);return r?s:s.reverse()}function Y(t,e,n,r,i,o){var a=d(+n);if(a+e>t[D])throw E(b);for(var s=t[$]._b,l=a+t[j],u=r(+i),c=0;c<e;c++)s[l+c]=u[o?c:e-c-1]}if(a.ABV){if(!u((function(){x(1)}))||!u((function(){new x(-1)}))||u((function(){return new x,new x(1.5),new x(NaN),x.name!=m}))){for(var q,K=(x=function(t){return c(this,x),new k(d(t))}).prototype=k.prototype,Z=p(k),J=0;Z.length>J;)(q=Z[J++])in x||s(x,q,k[q]);o||(K.constructor=x)}var Q=new w(new x(2)),tt=w.prototype.setInt8;Q.setInt8(0,2147483648),Q.setInt8(1,2147483649),!Q.getInt8(0)&&Q.getInt8(1)||l(w.prototype,{setInt8:function(t,e){tt.call(this,t,e<<24>>24)},setUint8:function(t,e){tt.call(this,t,e<<24>>24)}},!0)}else x=function(t){c(this,x,m);var e=d(t);this._b=v.call(new Array(e),0),this[D]=e},w=function(t,e,n){c(this,w,_),c(t,x,_);var r=t[D],i=h(e);if(i<0||i>r)throw E("Wrong offset!");if(i+(n=void 0===n?r-i:f(n))>r)throw E("Wrong length!");this[$]=t,this[j]=i,this[D]=n},i&&(X(x,M,"_l"),X(w,I,"_b"),X(w,M,"_l"),X(w,L,"_o")),l(w.prototype,{getInt8:function(t){return W(this,1,t)[0]<<24>>24},getUint8:function(t){return W(this,1,t)[0]},getInt16:function(t){var e=W(this,2,t,arguments[1]);return(e[1]<<8|e[0])<<16>>16},getUint16:function(t){var e=W(this,2,t,arguments[1]);return e[1]<<8|e[0]},getInt32:function(t){return F(W(this,4,t,arguments[1]))},getUint32:function(t){return F(W(this,4,t,arguments[1]))>>>0},getFloat32:function(t){return N(W(this,4,t,arguments[1]),23,4)},getFloat64:function(t){return N(W(this,8,t,arguments[1]),52,8)},setInt8:function(t,e){Y(this,1,t,V,e)},setUint8:function(t,e){Y(this,1,t,V,e)},setInt16:function(t,e){Y(this,2,t,G,e,arguments[2])},setUint16:function(t,e){Y(this,2,t,G,e,arguments[2])},setInt32:function(t,e){Y(this,4,t,z,e,arguments[2])},setUint32:function(t,e){Y(this,4,t,z,e,arguments[2])},setFloat32:function(t,e){Y(this,4,t,H,e,arguments[2])},setFloat64:function(t,e){Y(this,8,t,U,e,arguments[2])}});g(x,m),g(w,_),s(w.prototype,a.VIEW,!0),e.ArrayBuffer=x,e.DataView=w},9161:(t,e,n)=>{for(var r,i=n(7381),o=n(8012),a=n(7936),s=a("typed_array"),l=a("view"),u=!(!i.ArrayBuffer||!i.DataView),c=u,h=0,f="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");h<9;)(r=i[f[h++]])?(o(r.prototype,s,!0),o(r.prototype,l,!0)):c=!1;t.exports={ABV:u,CONSTR:c,TYPED:s,VIEW:l}},7936:t=>{var e=0,n=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++e+n).toString(36))}},851:(t,e,n)=>{var r=n(7381).navigator;t.exports=r&&r.userAgent||""},8546:(t,e,n)=>{var r=n(7156);t.exports=function(t,e){if(!r(t)||t._t!==e)throw TypeError("Incompatible receiver, "+e+" required!");return t}},5721:(t,e,n)=>{var r=n(7381),i=n(8544),o=n(4219),a=n(9078),s=n(4835).f;t.exports=function(t){var e=i.Symbol||(i.Symbol=o?{}:r.Symbol||{});"_"==t.charAt(0)||t in e||s(e,t,{value:a.f(t)})}},9078:(t,e,n)=>{e.f=n(3336)},3336:(t,e,n)=>{var r=n(3192)("wks"),i=n(7936),o=n(7381).Symbol,a="function"==typeof o;(t.exports=function(t){return r[t]||(r[t]=a&&o[t]||(a?o:i)("Symbol."+t))}).store=r},7637:(t,e,n)=>{var r=n(2858),i=n(3336)("iterator"),o=n(5301);t.exports=n(8544).getIteratorMethod=function(t){if(null!=t)return t[i]||t["@@iterator"]||o[r(t)]}},4611:(t,e,n)=>{var r=n(5913);r(r.P,"Array",{copyWithin:n(2147)}),n(4339)("copyWithin")},9892:(t,e,n)=>{"use strict";var r=n(5913),i=n(3970)(4);r(r.P+r.F*!n(1411)([].every,!0),"Array",{every:function(t){return i(this,t,arguments[1])}})},9217:(t,e,n)=>{var r=n(5913);r(r.P,"Array",{fill:n(1132)}),n(4339)("fill")},9355:(t,e,n)=>{"use strict";var r=n(5913),i=n(3970)(2);r(r.P+r.F*!n(1411)([].filter,!0),"Array",{filter:function(t){return i(this,t,arguments[1])}})},109:(t,e,n)=>{"use strict";var r=n(5913),i=n(3970)(6),o="findIndex",a=!0;o in[]&&Array(1)[o]((function(){a=!1})),r(r.P+r.F*a,"Array",{findIndex:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),n(4339)(o)},4138:(t,e,n)=>{"use strict";var r=n(5913),i=n(3970)(5),o="find",a=!0;o in[]&&Array(1).find((function(){a=!1})),r(r.P+r.F*a,"Array",{find:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),n(4339)(o)},791:(t,e,n)=>{"use strict";var r=n(5913),i=n(3970)(0),o=n(1411)([].forEach,!0);r(r.P+r.F*!o,"Array",{forEach:function(t){return i(this,t,arguments[1])}})},8671:(t,e,n)=>{"use strict";var r=n(566),i=n(5913),o=n(2515),a=n(2471),s=n(7063),l=n(8315),u=n(1348),c=n(7637);i(i.S+i.F*!n(5508)((function(t){Array.from(t)})),"Array",{from:function(t){var e,n,i,h,f=o(t),d="function"==typeof this?this:Array,p=arguments.length,y=p>1?arguments[1]:void 0,v=void 0!==y,g=0,m=c(f);if(v&&(y=r(y,p>2?arguments[2]:void 0,2)),null==m||d==Array&&s(m))for(n=new d(e=l(f.length));e>g;g++)u(n,g,v?y(f[g],g):f[g]);else for(h=m.call(f),n=new d;!(i=h.next()).done;g++)u(n,g,v?a(h,y,[i.value,g],!0):i.value);return n.length=g,n}})},4751:(t,e,n)=>{"use strict";var r=n(5913),i=n(4687)(!1),o=[].indexOf,a=!!o&&1/[1].indexOf(1,-0)<0;r(r.P+r.F*(a||!n(1411)(o)),"Array",{indexOf:function(t){return a?o.apply(this,arguments)||0:i(this,t,arguments[1])}})},1621:(t,e,n)=>{var r=n(5913);r(r.S,"Array",{isArray:n(1320)})},4806:(t,e,n)=>{"use strict";var r=n(4339),i=n(7218),o=n(5301),a=n(8499);t.exports=n(4873)(Array,"Array",(function(t,e){this._t=a(t),this._i=0,this._k=e}),(function(){var t=this._t,e=this._k,n=this._i++;return!t||n>=t.length?(this._t=void 0,i(1)):i(0,"keys"==e?n:"values"==e?t[n]:[n,t[n]])}),"values"),o.Arguments=o.Array,r("keys"),r("values"),r("entries")},9437:(t,e,n)=>{"use strict";var r=n(5913),i=n(8499),o=[].join;r(r.P+r.F*(n(331)!=Object||!n(1411)(o)),"Array",{join:function(t){return o.call(i(this),void 0===t?",":t)}})},9822:(t,e,n)=>{"use strict";var r=n(5913),i=n(8499),o=n(3230),a=n(8315),s=[].lastIndexOf,l=!!s&&1/[1].lastIndexOf(1,-0)<0;r(r.P+r.F*(l||!n(1411)(s)),"Array",{lastIndexOf:function(t){if(l)return s.apply(this,arguments)||0;var e=i(this),n=a(e.length),r=n-1;for(arguments.length>1&&(r=Math.min(r,o(arguments[1]))),r<0&&(r=n+r);r>=0;r--)if(r in e&&e[r]===t)return r||0;return-1}})},633:(t,e,n)=>{"use strict";var r=n(5913),i=n(3970)(1);r(r.P+r.F*!n(1411)([].map,!0),"Array",{map:function(t){return i(this,t,arguments[1])}})},6705:(t,e,n)=>{"use strict";var r=n(5913),i=n(1348);r(r.S+r.F*n(5810)((function(){function t(){}return!(Array.of.call(t)instanceof t)})),"Array",{of:function(){for(var t=0,e=arguments.length,n=new("function"==typeof this?this:Array)(e);e>t;)i(n,t,arguments[t++]);return n.length=e,n}})},8738:(t,e,n)=>{"use strict";var r=n(5913),i=n(6419);r(r.P+r.F*!n(1411)([].reduceRight,!0),"Array",{reduceRight:function(t){return i(this,t,arguments.length,arguments[1],!0)}})},9121:(t,e,n)=>{"use strict";var r=n(5913),i=n(6419);r(r.P+r.F*!n(1411)([].reduce,!0),"Array",{reduce:function(t){return i(this,t,arguments.length,arguments[1],!1)}})},7263:(t,e,n)=>{"use strict";var r=n(5913),i=n(1225),o=n(3679),a=n(6241),s=n(8315),l=[].slice;r(r.P+r.F*n(5810)((function(){i&&l.call(i)})),"Array",{slice:function(t,e){var n=s(this.length),r=o(this);if(e=void 0===e?n:e,"Array"==r)return l.call(this,t,e);for(var i=a(t,n),u=a(e,n),c=s(u-i),h=new Array(c),f=0;f<c;f++)h[f]="String"==r?this.charAt(i+f):this[i+f];return h}})},9253:(t,e,n)=>{"use strict";var r=n(5913),i=n(3970)(3);r(r.P+r.F*!n(1411)([].some,!0),"Array",{some:function(t){return i(this,t,arguments[1])}})},919:(t,e,n)=>{"use strict";var r=n(5913),i=n(6819),o=n(2515),a=n(5810),s=[].sort,l=[1,2,3];r(r.P+r.F*(a((function(){l.sort(void 0)}))||!a((function(){l.sort(null)}))||!n(1411)(s)),"Array",{sort:function(t){return void 0===t?s.call(o(this)):s.call(o(this),i(t))}})},3821:(t,e,n)=>{n(4798)("Array")},8384:(t,e,n)=>{var r=n(5913);r(r.S,"Date",{now:function(){return(new Date).getTime()}})},9701:(t,e,n)=>{var r=n(5913),i=n(2115);r(r.P+r.F*(Date.prototype.toISOString!==i),"Date",{toISOString:i})},2334:(t,e,n)=>{"use strict";var r=n(5913),i=n(2515),o=n(8537);r(r.P+r.F*n(5810)((function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})})),"Date",{toJSON:function(t){var e=i(this),n=o(e);return"number"!=typeof n||isFinite(n)?e.toISOString():null}})},3233:(t,e,n)=>{var r=n(3336)("toPrimitive"),i=Date.prototype;r in i||n(8012)(i,r,n(296))},1325:(t,e,n)=>{var r=Date.prototype,i="Invalid Date",o=r.toString,a=r.getTime;new Date(NaN)+""!=i&&n(7278)(r,"toString",(function(){var t=a.call(this);return t==t?o.call(this):i}))},161:(t,e,n)=>{var r=n(5913);r(r.P,"Function",{bind:n(8327)})},15:(t,e,n)=>{"use strict";var r=n(7156),i=n(4153),o=n(3336)("hasInstance"),a=Function.prototype;o in a||n(4835).f(a,o,{value:function(t){if("function"!=typeof this||!r(t))return!1;if(!r(this.prototype))return t instanceof this;for(;t=i(t);)if(this.prototype===t)return!0;return!1}})},6042:(t,e,n)=>{var r=n(4835).f,i=Function.prototype,o=/^\s*function ([^ (]*)/,a="name";a in i||n(4926)&&r(i,a,{configurable:!0,get:function(){try{return(""+this).match(o)[1]}catch(t){return""}}})},8969:(t,e,n)=>{"use strict";var r=n(4396),i=n(8546),o="Map";t.exports=n(1966)(o,(function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}}),{get:function(t){var e=r.getEntry(i(this,o),t);return e&&e.v},set:function(t,e){return r.def(i(this,o),0===t?0:t,e)}},r,!0)},4717:(t,e,n)=>{var r=n(5913),i=n(5447),o=Math.sqrt,a=Math.acosh;r(r.S+r.F*!(a&&710==Math.floor(a(Number.MAX_VALUE))&&a(1/0)==1/0),"Math",{acosh:function(t){return(t=+t)<1?NaN:t>94906265.62425156?Math.log(t)+Math.LN2:i(t-1+o(t-1)*o(t+1))}})},7292:(t,e,n)=>{var r=n(5913),i=Math.asinh;r(r.S+r.F*!(i&&1/i(0)>0),"Math",{asinh:function t(e){return isFinite(e=+e)&&0!=e?e<0?-t(-e):Math.log(e+Math.sqrt(e*e+1)):e}})},1840:(t,e,n)=>{var r=n(5913),i=Math.atanh;r(r.S+r.F*!(i&&1/i(-0)<0),"Math",{atanh:function(t){return 0==(t=+t)?t:Math.log((1+t)/(1-t))/2}})},3255:(t,e,n)=>{var r=n(5913),i=n(4012);r(r.S,"Math",{cbrt:function(t){return i(t=+t)*Math.pow(Math.abs(t),1/3)}})},5728:(t,e,n)=>{var r=n(5913);r(r.S,"Math",{clz32:function(t){return(t>>>=0)?31-Math.floor(Math.log(t+.5)*Math.LOG2E):32}})},6255:(t,e,n)=>{var r=n(5913),i=Math.exp;r(r.S,"Math",{cosh:function(t){return(i(t=+t)+i(-t))/2}})},2834:(t,e,n)=>{var r=n(5913),i=n(4774);r(r.S+r.F*(i!=Math.expm1),"Math",{expm1:i})},4489:(t,e,n)=>{var r=n(5913);r(r.S,"Math",{fround:n(3800)})},575:(t,e,n)=>{var r=n(5913),i=Math.abs;r(r.S,"Math",{hypot:function(t,e){for(var n,r,o=0,a=0,s=arguments.length,l=0;a<s;)l<(n=i(arguments[a++]))?(o=o*(r=l/n)*r+1,l=n):o+=n>0?(r=n/l)*r:n;return l===1/0?1/0:l*Math.sqrt(o)}})},1369:(t,e,n)=>{var r=n(5913),i=Math.imul;r(r.S+r.F*n(5810)((function(){return-5!=i(4294967295,5)||2!=i.length})),"Math",{imul:function(t,e){var n=65535,r=+t,i=+e,o=n&r,a=n&i;return 0|o*a+((n&r>>>16)*a+o*(n&i>>>16)<<16>>>0)}})},2751:(t,e,n)=>{var r=n(5913);r(r.S,"Math",{log10:function(t){return Math.log(t)*Math.LOG10E}})},9617:(t,e,n)=>{var r=n(5913);r(r.S,"Math",{log1p:n(5447)})},3656:(t,e,n)=>{var r=n(5913);r(r.S,"Math",{log2:function(t){return Math.log(t)/Math.LN2}})},1850:(t,e,n)=>{var r=n(5913);r(r.S,"Math",{sign:n(4012)})},5424:(t,e,n)=>{var r=n(5913),i=n(4774),o=Math.exp;r(r.S+r.F*n(5810)((function(){return-2e-17!=!Math.sinh(-2e-17)})),"Math",{sinh:function(t){return Math.abs(t=+t)<1?(i(t)-i(-t))/2:(o(t-1)-o(-t-1))*(Math.E/2)}})},230:(t,e,n)=>{var r=n(5913),i=n(4774),o=Math.exp;r(r.S,"Math",{tanh:function(t){var e=i(t=+t),n=i(-t);return e==1/0?1:n==1/0?-1:(e-n)/(o(t)+o(-t))}})},8471:(t,e,n)=>{var r=n(5913);r(r.S,"Math",{trunc:function(t){return(t>0?Math.floor:Math.ceil)(t)}})},440:(t,e,n)=>{"use strict";var r=n(7381),i=n(5389),o=n(3679),a=n(3654),s=n(8537),l=n(5810),u=n(2982).f,c=n(3299).f,h=n(4835).f,f=n(618).trim,d="Number",p=r.Number,y=p,v=p.prototype,g=o(n(4275)(v))==d,m="trim"in String.prototype,_=function(t){var e=s(t,!1);if("string"==typeof e&&e.length>2){var n,r,i,o=(e=m?e.trim():f(e,3)).charCodeAt(0);if(43===o||45===o){if(88===(n=e.charCodeAt(2))||120===n)return NaN}else if(48===o){switch(e.charCodeAt(1)){case 66:case 98:r=2,i=49;break;case 79:case 111:r=8,i=55;break;default:return+e}for(var a,l=e.slice(2),u=0,c=l.length;u<c;u++)if((a=l.charCodeAt(u))<48||a>i)return NaN;return parseInt(l,r)}}return+e};if(!p(" 0o1")||!p("0b1")||p("+0x1")){p=function(t){var e=arguments.length<1?0:t,n=this;return n instanceof p&&(g?l((function(){v.valueOf.call(n)})):o(n)!=d)?a(new y(_(e)),n,p):_(e)};for(var b,x=n(4926)?u(y):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),w=0;x.length>w;w++)i(y,b=x[w])&&!i(p,b)&&h(p,b,c(y,b));p.prototype=v,v.constructor=p,n(7278)(r,d,p)}},1914:(t,e,n)=>{var r=n(5913);r(r.S,"Number",{EPSILON:Math.pow(2,-52)})},4117:(t,e,n)=>{var r=n(5913),i=n(7381).isFinite;r(r.S,"Number",{isFinite:function(t){return"number"==typeof t&&i(t)}})},9619:(t,e,n)=>{var r=n(5913);r(r.S,"Number",{isInteger:n(5127)})},5849:(t,e,n)=>{var r=n(5913);r(r.S,"Number",{isNaN:function(t){return t!=t}})},4750:(t,e,n)=>{var r=n(5913),i=n(5127),o=Math.abs;r(r.S,"Number",{isSafeInteger:function(t){return i(t)&&o(t)<=9007199254740991}})},1550:(t,e,n)=>{var r=n(5913);r(r.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},3529:(t,e,n)=>{var r=n(5913);r(r.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991})},2791:(t,e,n)=>{var r=n(5913),i=n(5031);r(r.S+r.F*(Number.parseFloat!=i),"Number",{parseFloat:i})},6831:(t,e,n)=>{var r=n(5913),i=n(6971);r(r.S+r.F*(Number.parseInt!=i),"Number",{parseInt:i})},1077:(t,e,n)=>{"use strict";var r=n(5913),i=n(3230),o=n(9855),a=n(1924),s=1..toFixed,l=Math.floor,u=[0,0,0,0,0,0],c="Number.toFixed: incorrect invocation!",h="0",f=function(t,e){for(var n=-1,r=e;++n<6;)r+=t*u[n],u[n]=r%1e7,r=l(r/1e7)},d=function(t){for(var e=6,n=0;--e>=0;)n+=u[e],u[e]=l(n/t),n=n%t*1e7},p=function(){for(var t=6,e="";--t>=0;)if(""!==e||0===t||0!==u[t]){var n=String(u[t]);e=""===e?n:e+a.call(h,7-n.length)+n}return e},y=function t(e,n,r){return 0===n?r:n%2==1?t(e,n-1,r*e):t(e*e,n/2,r)};r(r.P+r.F*(!!s&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!n(5810)((function(){s.call({})}))),"Number",{toFixed:function(t){var e,n,r,s,l=o(this,c),u=i(t),v="",g=h;if(u<0||u>20)throw RangeError(c);if(l!=l)return"NaN";if(l<=-1e21||l>=1e21)return String(l);if(l<0&&(v="-",l=-l),l>1e-21)if(e=function(t){for(var e=0,n=t;n>=4096;)e+=12,n/=4096;for(;n>=2;)e+=1,n/=2;return e}(l*y(2,69,1))-69,n=e<0?l*y(2,-e,1):l/y(2,e,1),n*=4503599627370496,(e=52-e)>0){for(f(0,n),r=u;r>=7;)f(1e7,0),r-=7;for(f(y(10,r,1),0),r=e-1;r>=23;)d(1<<23),r-=23;d(1<<r),f(1,1),d(2),g=p()}else f(0,n),f(1<<-e,0),g=p()+a.call(h,u);return u>0?v+((s=g.length)<=u?"0."+a.call(h,u-s)+g:g.slice(0,s-u)+"."+g.slice(s-u)):v+g}})},820:(t,e,n)=>{"use strict";var r=n(5913),i=n(5810),o=n(9855),a=1..toPrecision;r(r.P+r.F*(i((function(){return"1"!==a.call(1,void 0)}))||!i((function(){a.call({})}))),"Number",{toPrecision:function(t){var e=o(this,"Number#toPrecision: incorrect invocation!");return void 0===t?a.call(e):a.call(e,t)}})},5331:(t,e,n)=>{var r=n(5913);r(r.S+r.F,"Object",{assign:n(8559)})},3290:(t,e,n)=>{var r=n(5913);r(r.S,"Object",{create:n(4275)})},8424:(t,e,n)=>{var r=n(5913);r(r.S+r.F*!n(4926),"Object",{defineProperties:n(6447)})},3690:(t,e,n)=>{var r=n(5913);r(r.S+r.F*!n(4926),"Object",{defineProperty:n(4835).f})},754:(t,e,n)=>{var r=n(7156),i=n(3763).onFreeze;n(4057)("freeze",(function(t){return function(e){return t&&r(e)?t(i(e)):e}}))},2357:(t,e,n)=>{var r=n(8499),i=n(3299).f;n(4057)("getOwnPropertyDescriptor",(function(){return function(t,e){return i(r(t),e)}}))},6022:(t,e,n)=>{n(4057)("getOwnPropertyNames",(function(){return n(3136).f}))},6667:(t,e,n)=>{var r=n(2515),i=n(4153);n(4057)("getPrototypeOf",(function(){return function(t){return i(r(t))}}))},4919:(t,e,n)=>{var r=n(7156);n(4057)("isExtensible",(function(t){return function(e){return!!r(e)&&(!t||t(e))}}))},9219:(t,e,n)=>{var r=n(7156);n(4057)("isFrozen",(function(t){return function(e){return!r(e)||!!t&&t(e)}}))},3270:(t,e,n)=>{var r=n(7156);n(4057)("isSealed",(function(t){return function(e){return!r(e)||!!t&&t(e)}}))},2456:(t,e,n)=>{var r=n(5913);r(r.S,"Object",{is:n(4261)})},2506:(t,e,n)=>{var r=n(2515),i=n(9924);n(4057)("keys",(function(){return function(t){return i(r(t))}}))},6527:(t,e,n)=>{var r=n(7156),i=n(3763).onFreeze;n(4057)("preventExtensions",(function(t){return function(e){return t&&r(e)?t(i(e)):e}}))},7571:(t,e,n)=>{var r=n(7156),i=n(3763).onFreeze;n(4057)("seal",(function(t){return function(e){return t&&r(e)?t(i(e)):e}}))},8490:(t,e,n)=>{var r=n(5913);r(r.S,"Object",{setPrototypeOf:n(6931).set})},4554:(t,e,n)=>{"use strict";var r=n(2858),i={};i[n(3336)("toStringTag")]="z",i+""!="[object z]"&&n(7278)(Object.prototype,"toString",(function(){return"[object "+r(this)+"]"}),!0)},3271:(t,e,n)=>{var r=n(5913),i=n(5031);r(r.G+r.F*(parseFloat!=i),{parseFloat:i})},317:(t,e,n)=>{var r=n(5913),i=n(6971);r(r.G+r.F*(parseInt!=i),{parseInt:i})},829:(t,e,n)=>{"use strict";var r,i,o,a,s=n(4219),l=n(7381),u=n(566),c=n(2858),h=n(5913),f=n(7156),d=n(6819),p=n(2702),y=n(2734),v=n(2035),g=n(8220).set,m=n(1842)(),_=n(4086),b=n(8228),x=n(851),w=n(3507),T="Promise",E=l.TypeError,S=l.process,k=S&&S.versions,O=k&&k.v8||"",A=l.Promise,P="process"==c(S),C=function(){},R=i=_.f,I=!!function(){try{var t=A.resolve(1),e=(t.constructor={})[n(3336)("species")]=function(t){t(C,C)};return(P||"function"==typeof PromiseRejectionEvent)&&t.then(C)instanceof e&&0!==O.indexOf("6.6")&&-1===x.indexOf("Chrome/66")}catch(t){}}(),M=function(t){var e;return!(!f(t)||"function"!=typeof(e=t.then))&&e},L=function(t,e){if(!t._n){t._n=!0;var n=t._c;m((function(){for(var r=t._v,i=1==t._s,o=0,a=function(e){var n,o,a,s=i?e.ok:e.fail,l=e.resolve,u=e.reject,c=e.domain;try{s?(i||(2==t._h&&j(t),t._h=1),!0===s?n=r:(c&&c.enter(),n=s(r),c&&(c.exit(),a=!0)),n===e.promise?u(E("Promise-chain cycle")):(o=M(n))?o.call(n,l,u):l(n)):u(r)}catch(t){c&&!a&&c.exit(),u(t)}};n.length>o;)a(n[o++]);t._c=[],t._n=!1,e&&!t._h&&$(t)}))}},$=function(t){g.call(l,(function(){var e,n,r,i=t._v,o=D(t);if(o&&(e=b((function(){P?S.emit("unhandledRejection",i,t):(n=l.onunhandledrejection)?n({promise:t,reason:i}):(r=l.console)&&r.error&&r.error("Unhandled promise rejection",i)})),t._h=P||D(t)?2:1),t._a=void 0,o&&e.e)throw e.v}))},D=function(t){return 1!==t._h&&0===(t._a||t._c).length},j=function(t){g.call(l,(function(){var e;P?S.emit("rejectionHandled",t):(e=l.onrejectionhandled)&&e({promise:t,reason:t._v})}))},B=function(t){var e=this;e._d||(e._d=!0,(e=e._w||e)._v=t,e._s=2,e._a||(e._a=e._c.slice()),L(e,!0))},N=function t(e){var n,r=this;if(!r._d){r._d=!0,r=r._w||r;try{if(r===e)throw E("Promise can't be resolved itself");(n=M(e))?m((function(){var i={_w:r,_d:!1};try{n.call(e,u(t,i,1),u(B,i,1))}catch(t){B.call(i,t)}})):(r._v=e,r._s=1,L(r,!1))}catch(t){B.call({_w:r,_d:!1},t)}}};I||(A=function(t){p(this,A,T,"_h"),d(t),r.call(this);try{t(u(N,this,1),u(B,this,1))}catch(t){B.call(this,t)}},(r=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=n(7228)(A.prototype,{then:function(t,e){var n=R(v(this,A));return n.ok="function"!=typeof t||t,n.fail="function"==typeof e&&e,n.domain=P?S.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&L(this,!1),n.promise},catch:function(t){return this.then(void 0,t)}}),o=function(){var t=new r;this.promise=t,this.resolve=u(N,t,1),this.reject=u(B,t,1)},_.f=R=function(t){return t===A||t===a?new o(t):i(t)}),h(h.G+h.W+h.F*!I,{Promise:A}),n(8094)(A,T),n(4798)(T),a=n(8544).Promise,h(h.S+h.F*!I,T,{reject:function(t){var e=R(this);return(0,e.reject)(t),e.promise}}),h(h.S+h.F*(s||!I),T,{resolve:function(t){return w(s&&this===a?A:this,t)}}),h(h.S+h.F*!(I&&n(5508)((function(t){A.all(t).catch(C)}))),T,{all:function(t){var e=this,n=R(e),r=n.resolve,i=n.reject,o=b((function(){var n=[],o=0,a=1;y(t,!1,(function(t){var s=o++,l=!1;n.push(void 0),a++,e.resolve(t).then((function(t){l||(l=!0,n[s]=t,--a||r(n))}),i)})),--a||r(n)}));return o.e&&i(o.v),n.promise},race:function(t){var e=this,n=R(e),r=n.reject,i=b((function(){y(t,!1,(function(t){e.resolve(t).then(n.resolve,r)}))}));return i.e&&r(i.v),n.promise}})},1220:(t,e,n)=>{var r=n(5913),i=n(6819),o=n(6154),a=(n(7381).Reflect||{}).apply,s=Function.apply;r(r.S+r.F*!n(5810)((function(){a((function(){}))})),"Reflect",{apply:function(t,e,n){var r=i(t),l=o(n);return a?a(r,e,l):s.call(r,e,l)}})},9263:(t,e,n)=>{var r=n(5913),i=n(4275),o=n(6819),a=n(6154),s=n(7156),l=n(5810),u=n(8327),c=(n(7381).Reflect||{}).construct,h=l((function(){function t(){}return!(c((function(){}),[],t)instanceof t)})),f=!l((function(){c((function(){}))}));r(r.S+r.F*(h||f),"Reflect",{construct:function(t,e){o(t),a(e);var n=arguments.length<3?t:o(arguments[2]);if(f&&!h)return c(t,e,n);if(t==n){switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3])}var r=[null];return r.push.apply(r,e),new(u.apply(t,r))}var l=n.prototype,d=i(s(l)?l:Object.prototype),p=Function.apply.call(t,d,e);return s(p)?p:d}})},7622:(t,e,n)=>{var r=n(4835),i=n(5913),o=n(6154),a=n(8537);i(i.S+i.F*n(5810)((function(){Reflect.defineProperty(r.f({},1,{value:1}),1,{value:2})})),"Reflect",{defineProperty:function(t,e,n){o(t),e=a(e,!0),o(n);try{return r.f(t,e,n),!0}catch(t){return!1}}})},9060:(t,e,n)=>{var r=n(5913),i=n(3299).f,o=n(6154);r(r.S,"Reflect",{deleteProperty:function(t,e){var n=i(o(t),e);return!(n&&!n.configurable)&&delete t[e]}})},980:(t,e,n)=>{"use strict";var r=n(5913),i=n(6154),o=function(t){this._t=i(t),this._i=0;var e,n=this._k=[];for(e in t)n.push(e)};n(8258)(o,"Object",(function(){var t,e=this,n=e._k;do{if(e._i>=n.length)return{value:void 0,done:!0}}while(!((t=n[e._i++])in e._t));return{value:t,done:!1}})),r(r.S,"Reflect",{enumerate:function(t){return new o(t)}})},8484:(t,e,n)=>{var r=n(3299),i=n(5913),o=n(6154);i(i.S,"Reflect",{getOwnPropertyDescriptor:function(t,e){return r.f(o(t),e)}})},9869:(t,e,n)=>{var r=n(5913),i=n(4153),o=n(6154);r(r.S,"Reflect",{getPrototypeOf:function(t){return i(o(t))}})},6175:(t,e,n)=>{var r=n(3299),i=n(4153),o=n(5389),a=n(5913),s=n(7156),l=n(6154);a(a.S,"Reflect",{get:function t(e,n){var a,u,c=arguments.length<3?e:arguments[2];return l(e)===c?e[n]:(a=r.f(e,n))?o(a,"value")?a.value:void 0!==a.get?a.get.call(c):void 0:s(u=i(e))?t(u,n,c):void 0}})},1285:(t,e,n)=>{var r=n(5913);r(r.S,"Reflect",{has:function(t,e){return e in t}})},4854:(t,e,n)=>{var r=n(5913),i=n(6154),o=Object.isExtensible;r(r.S,"Reflect",{isExtensible:function(t){return i(t),!o||o(t)}})},6647:(t,e,n)=>{var r=n(5913);r(r.S,"Reflect",{ownKeys:n(2600)})},7903:(t,e,n)=>{var r=n(5913),i=n(6154),o=Object.preventExtensions;r(r.S,"Reflect",{preventExtensions:function(t){i(t);try{return o&&o(t),!0}catch(t){return!1}}})},3113:(t,e,n)=>{var r=n(5913),i=n(6931);i&&r(r.S,"Reflect",{setPrototypeOf:function(t,e){i.check(t,e);try{return i.set(t,e),!0}catch(t){return!1}}})},5197:(t,e,n)=>{var r=n(4835),i=n(3299),o=n(4153),a=n(5389),s=n(5913),l=n(6256),u=n(6154),c=n(7156);s(s.S,"Reflect",{set:function t(e,n,s){var h,f,d=arguments.length<4?e:arguments[3],p=i.f(u(e),n);if(!p){if(c(f=o(e)))return t(f,n,s,d);p=l(0)}if(a(p,"value")){if(!1===p.writable||!c(d))return!1;if(h=i.f(d,n)){if(h.get||h.set||!1===h.writable)return!1;h.value=s,r.f(d,n,h)}else r.f(d,n,l(0,s));return!0}return void 0!==p.set&&(p.set.call(d,s),!0)}})},2566:(t,e,n)=>{var r=n(7381),i=n(3654),o=n(4835).f,a=n(2982).f,s=n(1993),l=n(2188),u=r.RegExp,c=u,h=u.prototype,f=/a/g,d=/a/g,p=new u(f)!==f;if(n(4926)&&(!p||n(5810)((function(){return d[n(3336)("match")]=!1,u(f)!=f||u(d)==d||"/a/i"!=u(f,"i")})))){u=function(t,e){var n=this instanceof u,r=s(t),o=void 0===e;return!n&&r&&t.constructor===u&&o?t:i(p?new c(r&&!o?t.source:t,e):c((r=t instanceof u)?t.source:t,r&&o?l.call(t):e),n?this:h,u)};for(var y=function(t){t in u||o(u,t,{configurable:!0,get:function(){return c[t]},set:function(e){c[t]=e}})},v=a(c),g=0;v.length>g;)y(v[g++]);h.constructor=u,u.prototype=h,n(7278)(r,"RegExp",u)}n(4798)("RegExp")},5997:(t,e,n)=>{"use strict";var r=n(6997);n(5913)({target:"RegExp",proto:!0,forced:r!==/./.exec},{exec:r})},7181:(t,e,n)=>{n(4926)&&"g"!=/./g.flags&&n(4835).f(RegExp.prototype,"flags",{configurable:!0,get:n(2188)})},8682:(t,e,n)=>{"use strict";var r=n(6154),i=n(8315),o=n(1330),a=n(4585);n(8644)("match",1,(function(t,e,n,s){return[function(n){var r=t(this),i=null==n?void 0:n[e];return void 0!==i?i.call(n,r):new RegExp(n)[e](String(r))},function(t){var e=s(n,t,this);if(e.done)return e.value;var l=r(t),u=String(this);if(!l.global)return a(l,u);var c=l.unicode;l.lastIndex=0;for(var h,f=[],d=0;null!==(h=a(l,u));){var p=String(h[0]);f[d]=p,""===p&&(l.lastIndex=o(u,i(l.lastIndex),c)),d++}return 0===d?null:f}]}))},8514:(t,e,n)=>{"use strict";var r=n(6154),i=n(2515),o=n(8315),a=n(3230),s=n(1330),l=n(4585),u=Math.max,c=Math.min,h=Math.floor,f=/\$([$&`']|\d\d?|<[^>]*>)/g,d=/\$([$&`']|\d\d?)/g;n(8644)("replace",2,(function(t,e,n,p){return[function(r,i){var o=t(this),a=null==r?void 0:r[e];return void 0!==a?a.call(r,o,i):n.call(String(o),r,i)},function(t,e){var i=p(n,t,this,e);if(i.done)return i.value;var h=r(t),f=String(this),d="function"==typeof e;d||(e=String(e));var v=h.global;if(v){var g=h.unicode;h.lastIndex=0}for(var m=[];;){var _=l(h,f);if(null===_)break;if(m.push(_),!v)break;""===String(_[0])&&(h.lastIndex=s(f,o(h.lastIndex),g))}for(var b,x="",w=0,T=0;T<m.length;T++){_=m[T];for(var E=String(_[0]),S=u(c(a(_.index),f.length),0),k=[],O=1;O<_.length;O++)k.push(void 0===(b=_[O])?b:String(b));var A=_.groups;if(d){var P=[E].concat(k,S,f);void 0!==A&&P.push(A);var C=String(e.apply(void 0,P))}else C=y(E,f,S,k,A,e);S>=w&&(x+=f.slice(w,S)+C,w=S+E.length)}return x+f.slice(w)}];function y(t,e,r,o,a,s){var l=r+t.length,u=o.length,c=d;return void 0!==a&&(a=i(a),c=f),n.call(s,c,(function(n,i){var s;switch(i.charAt(0)){case"$":return"$";case"&":return t;case"`":return e.slice(0,r);case"'":return e.slice(l);case"<":s=a[i.slice(1,-1)];break;default:var c=+i;if(0===c)return n;if(c>u){var f=h(c/10);return 0===f?n:f<=u?void 0===o[f-1]?i.charAt(1):o[f-1]+i.charAt(1):n}s=o[c-1]}return void 0===s?"":s}))}}))},5105:(t,e,n)=>{"use strict";var r=n(6154),i=n(4261),o=n(4585);n(8644)("search",1,(function(t,e,n,a){return[function(n){var r=t(this),i=null==n?void 0:n[e];return void 0!==i?i.call(n,r):new RegExp(n)[e](String(r))},function(t){var e=a(n,t,this);if(e.done)return e.value;var s=r(t),l=String(this),u=s.lastIndex;i(u,0)||(s.lastIndex=0);var c=o(s,l);return i(s.lastIndex,u)||(s.lastIndex=u),null===c?-1:c.index}]}))},5325:(t,e,n)=>{"use strict";var r=n(1993),i=n(6154),o=n(2035),a=n(1330),s=n(8315),l=n(4585),u=n(6997),c=n(5810),h=Math.min,f=[].push,d=4294967295,p=!c((function(){RegExp(d,"y")}));n(8644)("split",2,(function(t,e,n,c){var y;return y="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(t,e){var i=String(this);if(void 0===t&&0===e)return[];if(!r(t))return n.call(i,t,e);for(var o,a,s,l=[],c=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),h=0,p=void 0===e?d:e>>>0,y=new RegExp(t.source,c+"g");(o=u.call(y,i))&&!((a=y.lastIndex)>h&&(l.push(i.slice(h,o.index)),o.length>1&&o.index<i.length&&f.apply(l,o.slice(1)),s=o[0].length,h=a,l.length>=p));)y.lastIndex===o.index&&y.lastIndex++;return h===i.length?!s&&y.test("")||l.push(""):l.push(i.slice(h)),l.length>p?l.slice(0,p):l}:"0".split(void 0,0).length?function(t,e){return void 0===t&&0===e?[]:n.call(this,t,e)}:n,[function(n,r){var i=t(this),o=null==n?void 0:n[e];return void 0!==o?o.call(n,i,r):y.call(String(i),n,r)},function(t,e){var r=c(y,t,this,e,y!==n);if(r.done)return r.value;var u=i(t),f=String(this),v=o(u,RegExp),g=u.unicode,m=(u.ignoreCase?"i":"")+(u.multiline?"m":"")+(u.unicode?"u":"")+(p?"y":"g"),_=new v(p?u:"^(?:"+u.source+")",m),b=void 0===e?d:e>>>0;if(0===b)return[];if(0===f.length)return null===l(_,f)?[f]:[];for(var x=0,w=0,T=[];w<f.length;){_.lastIndex=p?w:0;var E,S=l(_,p?f:f.slice(w));if(null===S||(E=h(s(_.lastIndex+(p?0:w)),f.length))===x)w=a(f,w,g);else{if(T.push(f.slice(x,w)),T.length===b)return T;for(var k=1;k<=S.length-1;k++)if(T.push(S[k]),T.length===b)return T;w=x=E}}return T.push(f.slice(x)),T}]}))},8359:(t,e,n)=>{"use strict";n(7181);var r=n(6154),i=n(2188),o=n(4926),a="toString",s=/./.toString,l=function(t){n(7278)(RegExp.prototype,a,t,!0)};n(5810)((function(){return"/a/b"!=s.call({source:"a",flags:"b"})}))?l((function(){var t=r(this);return"/".concat(t.source,"/","flags"in t?t.flags:!o&&t instanceof RegExp?i.call(t):void 0)})):s.name!=a&&l((function(){return s.call(this)}))},3940:(t,e,n)=>{"use strict";var r=n(4396),i=n(8546);t.exports=n(1966)("Set",(function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}}),{add:function(t){return r.def(i(this,"Set"),t=0===t?0:t,t)}},r)},9718:(t,e,n)=>{"use strict";n(9927)("anchor",(function(t){return function(e){return t(this,"a","name",e)}}))},3845:(t,e,n)=>{"use strict";n(9927)("big",(function(t){return function(){return t(this,"big","","")}}))},5803:(t,e,n)=>{"use strict";n(9927)("blink",(function(t){return function(){return t(this,"blink","","")}}))},2222:(t,e,n)=>{"use strict";n(9927)("bold",(function(t){return function(){return t(this,"b","","")}}))},5281:(t,e,n)=>{"use strict";var r=n(5913),i=n(3593)(!1);r(r.P,"String",{codePointAt:function(t){return i(this,t)}})},3917:(t,e,n)=>{"use strict";var r=n(5913),i=n(8315),o=n(2376),a="endsWith",s="".endsWith;r(r.P+r.F*n(3483)(a),"String",{endsWith:function(t){var e=o(this,t,a),n=arguments.length>1?arguments[1]:void 0,r=i(e.length),l=void 0===n?r:Math.min(i(n),r),u=String(t);return s?s.call(e,u,l):e.slice(l-u.length,l)===u}})},5036:(t,e,n)=>{"use strict";n(9927)("fixed",(function(t){return function(){return t(this,"tt","","")}}))},6131:(t,e,n)=>{"use strict";n(9927)("fontcolor",(function(t){return function(e){return t(this,"font","color",e)}}))},4110:(t,e,n)=>{"use strict";n(9927)("fontsize",(function(t){return function(e){return t(this,"font","size",e)}}))},8577:(t,e,n)=>{var r=n(5913),i=n(6241),o=String.fromCharCode,a=String.fromCodePoint;r(r.S+r.F*(!!a&&1!=a.length),"String",{fromCodePoint:function(t){for(var e,n=[],r=arguments.length,a=0;r>a;){if(e=+arguments[a++],i(e,1114111)!==e)throw RangeError(e+" is not a valid code point");n.push(e<65536?o(e):o(55296+((e-=65536)>>10),e%1024+56320))}return n.join("")}})},5450:(t,e,n)=>{"use strict";var r=n(5913),i=n(2376),o="includes";r(r.P+r.F*n(3483)(o),"String",{includes:function(t){return!!~i(this,t,o).indexOf(t,arguments.length>1?arguments[1]:void 0)}})},6235:(t,e,n)=>{"use strict";n(9927)("italics",(function(t){return function(){return t(this,"i","","")}}))},6575:(t,e,n)=>{"use strict";var r=n(3593)(!0);n(4873)(String,"String",(function(t){this._t=String(t),this._i=0}),(function(){var t,e=this._t,n=this._i;return n>=e.length?{value:void 0,done:!0}:(t=r(e,n),this._i+=t.length,{value:t,done:!1})}))},6495:(t,e,n)=>{"use strict";n(9927)("link",(function(t){return function(e){return t(this,"a","href",e)}}))},7906:(t,e,n)=>{var r=n(5913),i=n(8499),o=n(8315);r(r.S,"String",{raw:function(t){for(var e=i(t.raw),n=o(e.length),r=arguments.length,a=[],s=0;n>s;)a.push(String(e[s++])),s<r&&a.push(String(arguments[s]));return a.join("")}})},9449:(t,e,n)=>{var r=n(5913);r(r.P,"String",{repeat:n(1924)})},4162:(t,e,n)=>{"use strict";n(9927)("small",(function(t){return function(){return t(this,"small","","")}}))},1616:(t,e,n)=>{"use strict";var r=n(5913),i=n(8315),o=n(2376),a="startsWith",s="".startsWith;r(r.P+r.F*n(3483)(a),"String",{startsWith:function(t){var e=o(this,t,a),n=i(Math.min(arguments.length>1?arguments[1]:void 0,e.length)),r=String(t);return s?s.call(e,r,n):e.slice(n,n+r.length)===r}})},5297:(t,e,n)=>{"use strict";n(9927)("strike",(function(t){return function(){return t(this,"strike","","")}}))},1466:(t,e,n)=>{"use strict";n(9927)("sub",(function(t){return function(){return t(this,"sub","","")}}))},2581:(t,e,n)=>{"use strict";n(9927)("sup",(function(t){return function(){return t(this,"sup","","")}}))},8587:(t,e,n)=>{"use strict";n(618)("trim",(function(t){return function(){return t(this,3)}}))},2403:(t,e,n)=>{"use strict";function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}var i=n(7381),o=n(5389),a=n(4926),s=n(5913),l=n(7278),u=n(3763).KEY,c=n(5810),h=n(3192),f=n(8094),d=n(7936),p=n(3336),y=n(9078),v=n(5721),g=n(8727),m=n(1320),_=n(6154),b=n(7156),x=n(2515),w=n(8499),T=n(8537),E=n(6256),S=n(4275),k=n(3136),O=n(3299),A=n(5421),P=n(4835),C=n(9924),R=O.f,I=P.f,M=k.f,L=i.Symbol,$=i.JSON,D=$&&$.stringify,j=p("_hidden"),B=p("toPrimitive"),N={}.propertyIsEnumerable,F=h("symbol-registry"),V=h("symbols"),G=h("op-symbols"),z=Object.prototype,U="function"==typeof L&&!!A.f,H=i.QObject,X=!H||!H.prototype||!H.prototype.findChild,W=a&&c((function(){return 7!=S(I({},"a",{get:function(){return I(this,"a",{value:7}).a}})).a}))?function(t,e,n){var r=R(z,e);r&&delete z[e],I(t,e,n),r&&t!==z&&I(z,e,r)}:I,Y=function(t){var e=V[t]=S(L.prototype);return e._k=t,e},q=U&&"symbol"==r(L.iterator)?function(t){return"symbol"==r(t)}:function(t){return t instanceof L},K=function(t,e,n){return t===z&&K(G,e,n),_(t),e=T(e,!0),_(n),o(V,e)?(n.enumerable?(o(t,j)&&t[j][e]&&(t[j][e]=!1),n=S(n,{enumerable:E(0,!1)})):(o(t,j)||I(t,j,E(1,{})),t[j][e]=!0),W(t,e,n)):I(t,e,n)},Z=function(t,e){_(t);for(var n,r=g(e=w(e)),i=0,o=r.length;o>i;)K(t,n=r[i++],e[n]);return t},J=function(t){var e=N.call(this,t=T(t,!0));return!(this===z&&o(V,t)&&!o(G,t))&&(!(e||!o(this,t)||!o(V,t)||o(this,j)&&this[j][t])||e)},Q=function(t,e){if(t=w(t),e=T(e,!0),t!==z||!o(V,e)||o(G,e)){var n=R(t,e);return!n||!o(V,e)||o(t,j)&&t[j][e]||(n.enumerable=!0),n}},tt=function(t){for(var e,n=M(w(t)),r=[],i=0;n.length>i;)o(V,e=n[i++])||e==j||e==u||r.push(e);return r},et=function(t){for(var e,n=t===z,r=M(n?G:w(t)),i=[],a=0;r.length>a;)!o(V,e=r[a++])||n&&!o(z,e)||i.push(V[e]);return i};U||(l((L=function(){if(this instanceof L)throw TypeError("Symbol is not a constructor!");var t=d(arguments.length>0?arguments[0]:void 0),e=function e(n){this===z&&e.call(G,n),o(this,j)&&o(this[j],t)&&(this[j][t]=!1),W(this,t,E(1,n))};return a&&X&&W(z,t,{configurable:!0,set:e}),Y(t)}).prototype,"toString",(function(){return this._k})),O.f=Q,P.f=K,n(2982).f=k.f=tt,n(4616).f=J,A.f=et,a&&!n(4219)&&l(z,"propertyIsEnumerable",J,!0),y.f=function(t){return Y(p(t))}),s(s.G+s.W+s.F*!U,{Symbol:L});for(var nt="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),rt=0;nt.length>rt;)p(nt[rt++]);for(var it=C(p.store),ot=0;it.length>ot;)v(it[ot++]);s(s.S+s.F*!U,"Symbol",{for:function(t){return o(F,t+="")?F[t]:F[t]=L(t)},keyFor:function(t){if(!q(t))throw TypeError(t+" is not a symbol!");for(var e in F)if(F[e]===t)return e},useSetter:function(){X=!0},useSimple:function(){X=!1}}),s(s.S+s.F*!U,"Object",{create:function(t,e){return void 0===e?S(t):Z(S(t),e)},defineProperty:K,defineProperties:Z,getOwnPropertyDescriptor:Q,getOwnPropertyNames:tt,getOwnPropertySymbols:et});var at=c((function(){A.f(1)}));s(s.S+s.F*at,"Object",{getOwnPropertySymbols:function(t){return A.f(x(t))}}),$&&s(s.S+s.F*(!U||c((function(){var t=L();return"[null]"!=D([t])||"{}"!=D({a:t})||"{}"!=D(Object(t))}))),"JSON",{stringify:function(t){for(var e,n,r=[t],i=1;arguments.length>i;)r.push(arguments[i++]);if(n=e=r[1],(b(e)||void 0!==t)&&!q(t))return m(e)||(e=function(t,e){if("function"==typeof n&&(e=n.call(this,t,e)),!q(e))return e}),r[1]=e,D.apply($,r)}}),L.prototype[B]||n(8012)(L.prototype,B,L.prototype.valueOf),f(L,"Symbol"),f(Math,"Math",!0),f(i.JSON,"JSON",!0)},7195:(t,e,n)=>{"use strict";var r=n(5913),i=n(9161),o=n(9782),a=n(6154),s=n(6241),l=n(8315),u=n(7156),c=n(7381).ArrayBuffer,h=n(2035),f=o.ArrayBuffer,d=o.DataView,p=i.ABV&&c.isView,y=f.prototype.slice,v=i.VIEW,g="ArrayBuffer";r(r.G+r.W+r.F*(c!==f),{ArrayBuffer:f}),r(r.S+r.F*!i.CONSTR,g,{isView:function(t){return p&&p(t)||u(t)&&v in t}}),r(r.P+r.U+r.F*n(5810)((function(){return!new f(2).slice(1,void 0).byteLength})),g,{slice:function(t,e){if(void 0!==y&&void 0===e)return y.call(a(this),t);for(var n=a(this).byteLength,r=s(t,n),i=s(void 0===e?n:e,n),o=new(h(this,f))(l(i-r)),u=new d(this),c=new d(o),p=0;r<i;)c.setUint8(p++,u.getUint8(r++));return o}}),n(4798)(g)},5345:(t,e,n)=>{var r=n(5913);r(r.G+r.W+r.F*!n(9161).ABV,{DataView:n(9782).DataView})},8824:(t,e,n)=>{n(431)("Float32",4,(function(t){return function(e,n,r){return t(this,e,n,r)}}))},6472:(t,e,n)=>{n(431)("Float64",8,(function(t){return function(e,n,r){return t(this,e,n,r)}}))},7683:(t,e,n)=>{n(431)("Int16",2,(function(t){return function(e,n,r){return t(this,e,n,r)}}))},4797:(t,e,n)=>{n(431)("Int32",4,(function(t){return function(e,n,r){return t(this,e,n,r)}}))},6670:(t,e,n)=>{n(431)("Int8",1,(function(t){return function(e,n,r){return t(this,e,n,r)}}))},1123:(t,e,n)=>{n(431)("Uint16",2,(function(t){return function(e,n,r){return t(this,e,n,r)}}))},4871:(t,e,n)=>{n(431)("Uint32",4,(function(t){return function(e,n,r){return t(this,e,n,r)}}))},7736:(t,e,n)=>{n(431)("Uint8",1,(function(t){return function(e,n,r){return t(this,e,n,r)}}))},4457:(t,e,n)=>{n(431)("Uint8",1,(function(t){return function(e,n,r){return t(this,e,n,r)}}),!0)},3491:(t,e,n)=>{"use strict";var r,i=n(7381),o=n(3970)(0),a=n(7278),s=n(3763),l=n(8559),u=n(4495),c=n(7156),h=n(8546),f=n(8546),d=!i.ActiveXObject&&"ActiveXObject"in i,p="WeakMap",y=s.getWeak,v=Object.isExtensible,g=u.ufstore,m=function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},_={get:function(t){if(c(t)){var e=y(t);return!0===e?g(h(this,p)).get(t):e?e[this._i]:void 0}},set:function(t,e){return u.def(h(this,p),t,e)}},b=t.exports=n(1966)(p,m,_,u,!0,!0);f&&d&&(l((r=u.getConstructor(m,p)).prototype,_),s.NEED=!0,o(["delete","has","get","set"],(function(t){var e=b.prototype,n=e[t];a(e,t,(function(e,i){if(c(e)&&!v(e)){this._f||(this._f=new r);var o=this._f[t](e,i);return"set"==t?this:o}return n.call(this,e,i)}))})))},6332:(t,e,n)=>{"use strict";var r=n(4495),i=n(8546),o="WeakSet";n(1966)(o,(function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}}),{add:function(t){return r.def(i(this,o),t,!0)}},r,!1,!0)},6032:(t,e,n)=>{"use strict";var r=n(5913),i=n(3120),o=n(2515),a=n(8315),s=n(6819),l=n(5486);r(r.P,"Array",{flatMap:function(t){var e,n,r=o(this);return s(t),e=a(r.length),n=l(r,0),i(n,r,r,e,0,1,t,arguments[1]),n}}),n(4339)("flatMap")},2963:(t,e,n)=>{"use strict";var r=n(5913),i=n(4687)(!0);r(r.P,"Array",{includes:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),n(4339)("includes")},8217:(t,e,n)=>{var r=n(5913),i=n(8941)(!0);r(r.S,"Object",{entries:function(t){return i(t)}})},9168:(t,e,n)=>{var r=n(5913),i=n(2600),o=n(8499),a=n(3299),s=n(1348);r(r.S,"Object",{getOwnPropertyDescriptors:function(t){for(var e,n,r=o(t),l=a.f,u=i(r),c={},h=0;u.length>h;)void 0!==(n=l(r,e=u[h++]))&&s(c,e,n);return c}})},6351:(t,e,n)=>{var r=n(5913),i=n(8941)(!1);r(r.S,"Object",{values:function(t){return i(t)}})},8088:(t,e,n)=>{"use strict";var r=n(5913),i=n(8544),o=n(7381),a=n(2035),s=n(3507);r(r.P+r.R,"Promise",{finally:function(t){var e=a(this,i.Promise||o.Promise),n="function"==typeof t;return this.then(n?function(n){return s(e,t()).then((function(){return n}))}:t,n?function(n){return s(e,t()).then((function(){throw n}))}:t)}})},2123:(t,e,n)=>{"use strict";var r=n(5913),i=n(1925),o=n(851),a=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(o);r(r.P+r.F*a,"String",{padEnd:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0,!1)}})},9391:(t,e,n)=>{"use strict";var r=n(5913),i=n(1925),o=n(851),a=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(o);r(r.P+r.F*a,"String",{padStart:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0,!0)}})},6541:(t,e,n)=>{"use strict";n(618)("trimLeft",(function(t){return function(){return t(this,1)}}),"trimStart")},1767:(t,e,n)=>{"use strict";n(618)("trimRight",(function(t){return function(){return t(this,2)}}),"trimEnd")},4870:(t,e,n)=>{n(5721)("asyncIterator")},1094:(t,e,n)=>{for(var r=n(4806),i=n(9924),o=n(7278),a=n(7381),s=n(8012),l=n(5301),u=n(3336),c=u("iterator"),h=u("toStringTag"),f=l.Array,d={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},p=i(d),y=0;y<p.length;y++){var v,g=p[y],m=d[g],_=a[g],b=_&&_.prototype;if(b&&(b[c]||s(b,c,f),b[h]||s(b,h,g),l[g]=f,m))for(v in r)b[v]||o(b,v,r[v],!0)}},1605:(t,e,n)=>{var r=n(5913),i=n(8220);r(r.G+r.B,{setImmediate:i.set,clearImmediate:i.clear})},2113:(t,e,n)=>{var r=n(7381),i=n(5913),o=n(851),a=[].slice,s=/MSIE .\./.test(o),l=function(t){return function(e,n){var r=arguments.length>2,i=!!r&&a.call(arguments,2);return t(r?function(){("function"==typeof e?e:Function(e)).apply(this,i)}:e,n)}};i(i.G+i.B+i.F*s,{setTimeout:l(r.setTimeout),setInterval:l(r.setInterval)})},7942:(t,e,n)=>{n(2113),n(1605),n(1094),t.exports=n(8544)},8922:t=>{"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n="",r=void 0!==e[5];return e[4]&&(n+="@supports (".concat(e[4],") {")),e[2]&&(n+="@media ".concat(e[2]," {")),r&&(n+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),n+=t(e),r&&(n+="}"),e[2]&&(n+="}"),e[4]&&(n+="}"),n})).join("")},e.i=function(t,n,r,i,o){"string"==typeof t&&(t=[[null,t,void 0]]);var a={};if(r)for(var s=0;s<this.length;s++){var l=this[s][0];null!=l&&(a[l]=!0)}for(var u=0;u<t.length;u++){var c=[].concat(t[u]);r&&a[c[0]]||(void 0!==o&&(void 0===c[5]||(c[1]="@layer".concat(c[5].length>0?" ".concat(c[5]):""," {").concat(c[1],"}")),c[5]=o),n&&(c[2]?(c[1]="@media ".concat(c[2]," {").concat(c[1],"}"),c[2]=n):c[2]=n),i&&(c[4]?(c[1]="@supports (".concat(c[4],") {").concat(c[1],"}"),c[4]=i):c[4]="".concat(i)),e.push(c))}},e}},7499:t=>{"use strict";t.exports=function(t){return t[1]}},6760:(t,e,n)=>{function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}var i=function(t){"use strict";var e,n=Object.prototype,i=n.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,n){return t[e]=n}}function c(t,e,n,r){var i=e&&e.prototype instanceof g?e:g,o=Object.create(i.prototype),a=new P(r||[]);return o._invoke=function(t,e,n){var r=f;return function(i,o){if(r===p)throw new Error("Generator is already running");if(r===y){if("throw"===i)throw o;return R()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=k(a,n);if(s){if(s===v)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===f)throw r=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=p;var l=h(t,e,n);if("normal"===l.type){if(r=n.done?y:d,l.arg===v)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(r=y,n.method="throw",n.arg=l.arg)}}}(t,n,a),o}function h(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=c;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",v={};function g(){}function m(){}function _(){}var b={};u(b,a,(function(){return this}));var x=Object.getPrototypeOf,w=x&&x(x(C([])));w&&w!==n&&i.call(w,a)&&(b=w);var T=_.prototype=g.prototype=Object.create(b);function E(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function n(o,a,s,l){var u=h(t[o],t,a);if("throw"!==u.type){var c=u.arg,f=c.value;return f&&"object"===r(f)&&i.call(f,"__await")?e.resolve(f.__await).then((function(t){n("next",t,s,l)}),(function(t){n("throw",t,s,l)})):e.resolve(f).then((function(t){c.value=t,s(c)}),(function(t){return n("throw",t,s,l)}))}l(u.arg)}var o;this._invoke=function(t,r){function i(){return new e((function(e,i){n(t,r,e,i)}))}return o=o?o.then(i,i):i()}}function k(t,n){var r=t.iterator[n.method];if(r===e){if(n.delegate=null,"throw"===n.method){if(t.iterator.return&&(n.method="return",n.arg=e,k(t,n),"throw"===n.method))return v;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var i=h(r,t.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,v;var o=i.arg;return o?o.done?(n[t.resultName]=o.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,v):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function O(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function A(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(O,this),this.reset(!0)}function C(t){if(t){var n=t[a];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,o=function n(){for(;++r<t.length;)if(i.call(t,r))return n.value=t[r],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}return{next:R}}function R(){return{value:e,done:!0}}return m.prototype=_,u(T,"constructor",_),u(_,"constructor",m),m.displayName=u(_,l,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,_):(t.__proto__=_,u(t,l,"GeneratorFunction")),t.prototype=Object.create(T),t},t.awrap=function(t){return{__await:t}},E(S.prototype),u(S.prototype,s,(function(){return this})),t.AsyncIterator=S,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var a=new S(c(e,n,r,i),o);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(T),u(T,l,"Generator"),u(T,a,(function(){return this})),u(T,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=C,P.prototype={constructor:P,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(A),!t)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function r(r,i){return s.type="throw",s.arg=t,n.next=r,i&&(n.method="next",n.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var l=i.call(a,"catchLoc"),u=i.call(a,"finallyLoc");if(l&&u){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(l){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),A(n),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;A(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:C(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),v}},t}("object"===r(t=n.nmd(t))?t.exports:{});try{regeneratorRuntime=i}catch(t){"object"===("undefined"==typeof globalThis?"undefined":r(globalThis))?globalThis.regeneratorRuntime=i:Function("r","regeneratorRuntime = r")(i)}},1424:(t,e,n)=>{"use strict";n.d(e,{Z:()=>s});var r=n(7499),i=n.n(r),o=n(8922),a=n.n(o)()(i());a.push([t.id,"body {\r\n\r\n    background-color: black;\r\n    color: white;\r\n\r\n    /* Allow mouse dragging. */\r\n    -moz-user-select: none;\r\n    -ms-user-select: none;\r\n    -o-user-select: none;\r\n    -webkit-user-select: none;\r\n    user-select: none;\r\n\r\n    /* disable touch panning/zooming */\r\n    -ms-touch-action: none;\r\n    touch-action: none;\r\n\r\n    /* Allow canvas to hit the edges of the browser viewport. */\r\n    margin: 0;\r\n}\r\n\r\n#screen canvas {\r\n    margin: auto;\r\n    /* Hide the gap for font descenders. */\r\n    display: block;\r\n}\r\n",""]);const s=a},3379:t=>{"use strict";var e=[];function n(t){for(var n=-1,r=0;r<e.length;r++)if(e[r].identifier===t){n=r;break}return n}function r(t,r){for(var o={},a=[],s=0;s<t.length;s++){var l=t[s],u=r.base?l[0]+r.base:l[0],c=o[u]||0,h="".concat(u," ").concat(c);o[u]=c+1;var f=n(h),d={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==f)e[f].references++,e[f].updater(d);else{var p=i(d,r);r.byIndex=s,e.splice(s,0,{identifier:h,updater:p,references:1})}a.push(h)}return a}function i(t,e){var n=e.domAPI(e);return n.update(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;n.update(t=e)}else n.remove()}}t.exports=function(t,i){var o=r(t=t||[],i=i||{});return function(t){t=t||[];for(var a=0;a<o.length;a++){var s=n(o[a]);e[s].references--}for(var l=r(t,i),u=0;u<o.length;u++){var c=n(o[u]);0===e[c].references&&(e[c].updater(),e.splice(c,1))}o=l}}},569:t=>{"use strict";var e={};t.exports=function(t,n){var r=function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}e[t]=n}return e[t]}(t);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(n)}},9216:t=>{"use strict";t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},3565:(t,e,n)=>{"use strict";t.exports=function(t){var e=n.nc;e&&t.setAttribute("nonce",e)}},7795:t=>{"use strict";t.exports=function(t){var e=t.insertStyleElement(t);return{update:function(n){!function(t,e,n){var r="";n.supports&&(r+="@supports (".concat(n.supports,") {")),n.media&&(r+="@media ".concat(n.media," {"));var i=void 0!==n.layer;i&&(r+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),r+=n.css,i&&(r+="}"),n.media&&(r+="}"),n.supports&&(r+="}");var o=n.sourceMap;o&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),e.styleTagTransform(r,t,e.options)}(e,t,n)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}},4589:t=>{"use strict";t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}},5909:(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{"use strict";function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_unsupportedIterableToArray(t,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o=[],a=!0,s=!1;try{for(n=n.call(t);!(a=(r=n.next()).done)&&(o.push(r.value),!e||o.length!==e);a=!0);}catch(t){s=!0,i=t}finally{try{a||null==n.return||n.return()}finally{if(s)throw i}}return o}}function _arrayWithHoles(t){if(Array.isArray(t))return t}function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_unsupportedIterableToArray(t)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(t,e):void 0}}function _iterableToArray(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function _arrayWithoutHoles(t){if(Array.isArray(t))return _arrayLikeToArray(t)}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function _get(){return _get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=_superPropBase(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}},_get.apply(this,arguments)}function _superPropBase(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=_getPrototypeOf(t)););return t}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return _setPrototypeOf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},_setPrototypeOf(t,e)}function _createSuper(t){var e=_isNativeReflectConstruct();return function(){var n,r=_getPrototypeOf(t);if(e){var i=_getPrototypeOf(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return _possibleConstructorReturn(this,n)}}function _possibleConstructorReturn(t,e){if(e&&("object"===_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function _getPrototypeOf(t){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},_getPrototypeOf(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function _typeof(t){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(t)}__webpack_require__.d(__webpack_exports__,{H6:()=>game,Hf:()=>Stage,MJ:()=>Renderable,Rk:()=>video,SB:()=>state,UL:()=>Rect,Uh:()=>device$1,W2:()=>Container,Xz:()=>BitmapText,ZX:()=>math,_m:()=>loader,d_:()=>pool$1,jy:()=>Sprite,n0:()=>audio,nC:()=>GUI_Object,qH:()=>input,uT:()=>Body,v7:()=>collision});var commonjsGlobal="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},check=function(t){return t&&t.Math==Math&&t},global$m=check("object"==("undefined"==typeof globalThis?"undefined":_typeof(globalThis))&&globalThis)||check("object"==("undefined"==typeof window?"undefined":_typeof(window))&&window)||check("object"==("undefined"==typeof self?"undefined":_typeof(self))&&self)||check("object"==_typeof(commonjsGlobal)&&commonjsGlobal)||function(){return this}()||Function("return this")(),objectGetOwnPropertyDescriptor={},fails$8=function(t){try{return!!t()}catch(t){return!0}},fails$7=fails$8,descriptors=!fails$7((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),fails$6=fails$8,functionBindNative=!fails$6((function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")})),NATIVE_BIND$1=functionBindNative,call$4=Function.prototype.call,functionCall=NATIVE_BIND$1?call$4.bind(call$4):function(){return call$4.apply(call$4,arguments)},objectPropertyIsEnumerable={},$propertyIsEnumerable={}.propertyIsEnumerable,getOwnPropertyDescriptor$1=Object.getOwnPropertyDescriptor,NASHORN_BUG=getOwnPropertyDescriptor$1&&!$propertyIsEnumerable.call({1:2},1);objectPropertyIsEnumerable.f=NASHORN_BUG?function(t){var e=getOwnPropertyDescriptor$1(this,t);return!!e&&e.enumerable}:$propertyIsEnumerable;var createPropertyDescriptor$2=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},NATIVE_BIND=functionBindNative,FunctionPrototype$1=Function.prototype,bind=FunctionPrototype$1.bind,call$3=FunctionPrototype$1.call,uncurryThis$9=NATIVE_BIND&&bind.bind(call$3,call$3),functionUncurryThis=NATIVE_BIND?function(t){return t&&uncurryThis$9(t)}:function(t){return t&&function(){return call$3.apply(t,arguments)}},uncurryThis$8=functionUncurryThis,toString$2=uncurryThis$8({}.toString),stringSlice=uncurryThis$8("".slice),classofRaw=function(t){return stringSlice(toString$2(t),8,-1)},global$l=global$m,uncurryThis$7=functionUncurryThis,fails$5=fails$8,classof=classofRaw,Object$3=global$l.Object,split=uncurryThis$7("".split),indexedObject=fails$5((function(){return!Object$3("z").propertyIsEnumerable(0)}))?function(t){return"String"==classof(t)?split(t,""):Object$3(t)}:Object$3,global$k=global$m,TypeError$7=global$k.TypeError,requireObjectCoercible$2=function(t){if(null==t)throw TypeError$7("Can't call method on "+t);return t},IndexedObject=indexedObject,requireObjectCoercible$1=requireObjectCoercible$2,toIndexedObject$3=function(t){return IndexedObject(requireObjectCoercible$1(t))},isCallable$a=function(t){return"function"==typeof t},isCallable$9=isCallable$a,isObject$5=function(t){return"object"==_typeof(t)?null!==t:isCallable$9(t)},global$j=global$m,isCallable$8=isCallable$a,aFunction=function(t){return isCallable$8(t)?t:void 0},getBuiltIn$3=function(t,e){return arguments.length<2?aFunction(global$j[t]):global$j[t]&&global$j[t][e]},uncurryThis$6=functionUncurryThis,objectIsPrototypeOf=uncurryThis$6({}.isPrototypeOf),getBuiltIn$2=getBuiltIn$3,engineUserAgent=getBuiltIn$2("navigator","userAgent")||"",global$i=global$m,userAgent=engineUserAgent,process$1=global$i.process,Deno=global$i.Deno,versions=process$1&&process$1.versions||Deno&&Deno.version,v8=versions&&versions.v8,match,version$1;v8&&(match=v8.split("."),version$1=match[0]>0&&match[0]<4?1:+(match[0]+match[1])),!version$1&&userAgent&&(match=userAgent.match(/Edge\/(\d+)/),(!match||match[1]>=74)&&(match=userAgent.match(/Chrome\/(\d+)/),match&&(version$1=+match[1])));var engineV8Version=version$1,V8_VERSION=engineV8Version,fails$4=fails$8,nativeSymbol=!!Object.getOwnPropertySymbols&&!fails$4((function(){var t=Symbol();return!String(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&V8_VERSION&&V8_VERSION<41})),NATIVE_SYMBOL$1=nativeSymbol,useSymbolAsUid=NATIVE_SYMBOL$1&&!Symbol.sham&&"symbol"==_typeof(Symbol.iterator),global$h=global$m,getBuiltIn$1=getBuiltIn$3,isCallable$7=isCallable$a,isPrototypeOf=objectIsPrototypeOf,USE_SYMBOL_AS_UID$1=useSymbolAsUid,Object$2=global$h.Object,isSymbol$2=USE_SYMBOL_AS_UID$1?function(t){return"symbol"==_typeof(t)}:function(t){var e=getBuiltIn$1("Symbol");return isCallable$7(e)&&isPrototypeOf(e.prototype,Object$2(t))},global$g=global$m,String$2=global$g.String,tryToString$1=function(t){try{return String$2(t)}catch(t){return"Object"}},global$f=global$m,isCallable$6=isCallable$a,tryToString=tryToString$1,TypeError$6=global$f.TypeError,aCallable$1=function(t){if(isCallable$6(t))return t;throw TypeError$6(tryToString(t)+" is not a function")},aCallable=aCallable$1,getMethod$1=function(t,e){var n=t[e];return null==n?void 0:aCallable(n)},global$e=global$m,call$2=functionCall,isCallable$5=isCallable$a,isObject$4=isObject$5,TypeError$5=global$e.TypeError,ordinaryToPrimitive$1=function(t,e){var n,r;if("string"===e&&isCallable$5(n=t.toString)&&!isObject$4(r=call$2(n,t)))return r;if(isCallable$5(n=t.valueOf)&&!isObject$4(r=call$2(n,t)))return r;if("string"!==e&&isCallable$5(n=t.toString)&&!isObject$4(r=call$2(n,t)))return r;throw TypeError$5("Can't convert object to primitive value")},shared$3={exports:{}},global$d=global$m,defineProperty$1=Object.defineProperty,setGlobal$3=function(t,e){try{defineProperty$1(global$d,t,{value:e,configurable:!0,writable:!0})}catch(n){global$d[t]=e}return e},global$c=global$m,setGlobal$2=setGlobal$3,SHARED="__core-js_shared__",store$3=global$c[SHARED]||setGlobal$2(SHARED,{}),sharedStore=store$3,store$2=sharedStore;(shared$3.exports=function(t,e){return store$2[t]||(store$2[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.22.5",mode:"global",copyright:"© 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.22.5/LICENSE",source:"https://github.com/zloirock/core-js"});var global$b=global$m,requireObjectCoercible=requireObjectCoercible$2,Object$1=global$b.Object,toObject$1=function(t){return Object$1(requireObjectCoercible(t))},uncurryThis$5=functionUncurryThis,toObject=toObject$1,hasOwnProperty=uncurryThis$5({}.hasOwnProperty),hasOwnProperty_1=Object.hasOwn||function(t,e){return hasOwnProperty(toObject(t),e)},uncurryThis$4=functionUncurryThis,id=0,postfix=Math.random(),toString$1=uncurryThis$4(1..toString),uid$2=function(t){return"Symbol("+(void 0===t?"":t)+")_"+toString$1(++id+postfix,36)},global$a=global$m,shared$2=shared$3.exports,hasOwn$6=hasOwnProperty_1,uid$1=uid$2,NATIVE_SYMBOL=nativeSymbol,USE_SYMBOL_AS_UID=useSymbolAsUid,WellKnownSymbolsStore=shared$2("wks"),Symbol$1=global$a.Symbol,symbolFor=Symbol$1&&Symbol$1.for,createWellKnownSymbol=USE_SYMBOL_AS_UID?Symbol$1:Symbol$1&&Symbol$1.withoutSetter||uid$1,wellKnownSymbol$1=function(t){if(!hasOwn$6(WellKnownSymbolsStore,t)||!NATIVE_SYMBOL&&"string"!=typeof WellKnownSymbolsStore[t]){var e="Symbol."+t;NATIVE_SYMBOL&&hasOwn$6(Symbol$1,t)?WellKnownSymbolsStore[t]=Symbol$1[t]:WellKnownSymbolsStore[t]=USE_SYMBOL_AS_UID&&symbolFor?symbolFor(e):createWellKnownSymbol(e)}return WellKnownSymbolsStore[t]},global$9=global$m,call$1=functionCall,isObject$3=isObject$5,isSymbol$1=isSymbol$2,getMethod=getMethod$1,ordinaryToPrimitive=ordinaryToPrimitive$1,wellKnownSymbol=wellKnownSymbol$1,TypeError$4=global$9.TypeError,TO_PRIMITIVE=wellKnownSymbol("toPrimitive"),toPrimitive$1=function(t,e){if(!isObject$3(t)||isSymbol$1(t))return t;var n,r=getMethod(t,TO_PRIMITIVE);if(r){if(void 0===e&&(e="default"),n=call$1(r,t,e),!isObject$3(n)||isSymbol$1(n))return n;throw TypeError$4("Can't convert object to primitive value")}return void 0===e&&(e="number"),ordinaryToPrimitive(t,e)},toPrimitive=toPrimitive$1,isSymbol=isSymbol$2,toPropertyKey$2=function(t){var e=toPrimitive(t,"string");return isSymbol(e)?e:e+""},global$8=global$m,isObject$2=isObject$5,document$1=global$8.document,EXISTS$1=isObject$2(document$1)&&isObject$2(document$1.createElement),documentCreateElement=function(t){return EXISTS$1?document$1.createElement(t):{}},DESCRIPTORS$6=descriptors,fails$3=fails$8,createElement=documentCreateElement,ie8DomDefine=!DESCRIPTORS$6&&!fails$3((function(){return 7!=Object.defineProperty(createElement("div"),"a",{get:function(){return 7}}).a})),DESCRIPTORS$5=descriptors,call=functionCall,propertyIsEnumerableModule=objectPropertyIsEnumerable,createPropertyDescriptor$1=createPropertyDescriptor$2,toIndexedObject$2=toIndexedObject$3,toPropertyKey$1=toPropertyKey$2,hasOwn$5=hasOwnProperty_1,IE8_DOM_DEFINE$1=ie8DomDefine,$getOwnPropertyDescriptor$1=Object.getOwnPropertyDescriptor;objectGetOwnPropertyDescriptor.f=DESCRIPTORS$5?$getOwnPropertyDescriptor$1:function(t,e){if(t=toIndexedObject$2(t),e=toPropertyKey$1(e),IE8_DOM_DEFINE$1)try{return $getOwnPropertyDescriptor$1(t,e)}catch(t){}if(hasOwn$5(t,e))return createPropertyDescriptor$1(!call(propertyIsEnumerableModule.f,t,e),t[e])};var objectDefineProperty={},DESCRIPTORS$4=descriptors,fails$2=fails$8,v8PrototypeDefineBug=DESCRIPTORS$4&&fails$2((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype})),global$7=global$m,isObject$1=isObject$5,String$1=global$7.String,TypeError$3=global$7.TypeError,anObject$2=function(t){if(isObject$1(t))return t;throw TypeError$3(String$1(t)+" is not an object")},global$6=global$m,DESCRIPTORS$3=descriptors,IE8_DOM_DEFINE=ie8DomDefine,V8_PROTOTYPE_DEFINE_BUG=v8PrototypeDefineBug,anObject$1=anObject$2,toPropertyKey=toPropertyKey$2,TypeError$2=global$6.TypeError,$defineProperty=Object.defineProperty,$getOwnPropertyDescriptor=Object.getOwnPropertyDescriptor,ENUMERABLE="enumerable",CONFIGURABLE$1="configurable",WRITABLE="writable";objectDefineProperty.f=DESCRIPTORS$3?V8_PROTOTYPE_DEFINE_BUG?function(t,e,n){if(anObject$1(t),e=toPropertyKey(e),anObject$1(n),"function"==typeof t&&"prototype"===e&&"value"in n&&WRITABLE in n&&!n[WRITABLE]){var r=$getOwnPropertyDescriptor(t,e);r&&r[WRITABLE]&&(t[e]=n.value,n={configurable:CONFIGURABLE$1 in n?n[CONFIGURABLE$1]:r[CONFIGURABLE$1],enumerable:ENUMERABLE in n?n[ENUMERABLE]:r[ENUMERABLE],writable:!1})}return $defineProperty(t,e,n)}:$defineProperty:function(t,e,n){if(anObject$1(t),e=toPropertyKey(e),anObject$1(n),IE8_DOM_DEFINE)try{return $defineProperty(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError$2("Accessors not supported");return"value"in n&&(t[e]=n.value),t};var DESCRIPTORS$2=descriptors,definePropertyModule$1=objectDefineProperty,createPropertyDescriptor=createPropertyDescriptor$2,createNonEnumerableProperty$3=DESCRIPTORS$2?function(t,e,n){return definePropertyModule$1.f(t,e,createPropertyDescriptor(1,n))}:function(t,e,n){return t[e]=n,t},makeBuiltIn$2={exports:{}},DESCRIPTORS$1=descriptors,hasOwn$4=hasOwnProperty_1,FunctionPrototype=Function.prototype,getDescriptor=DESCRIPTORS$1&&Object.getOwnPropertyDescriptor,EXISTS=hasOwn$4(FunctionPrototype,"name"),PROPER=EXISTS&&"something"===function(){}.name,CONFIGURABLE=EXISTS&&(!DESCRIPTORS$1||DESCRIPTORS$1&&getDescriptor(FunctionPrototype,"name").configurable),functionName={EXISTS,PROPER,CONFIGURABLE},uncurryThis$3=functionUncurryThis,isCallable$4=isCallable$a,store$1=sharedStore,functionToString=uncurryThis$3(Function.toString);isCallable$4(store$1.inspectSource)||(store$1.inspectSource=function(t){return functionToString(t)});var inspectSource$2=store$1.inspectSource,global$5=global$m,isCallable$3=isCallable$a,inspectSource$1=inspectSource$2,WeakMap$1=global$5.WeakMap,nativeWeakMap=isCallable$3(WeakMap$1)&&/native code/.test(inspectSource$1(WeakMap$1)),shared$1=shared$3.exports,uid=uid$2,keys=shared$1("keys"),sharedKey$1=function(t){return keys[t]||(keys[t]=uid(t))},hiddenKeys$3={},NATIVE_WEAK_MAP=nativeWeakMap,global$4=global$m,uncurryThis$2=functionUncurryThis,isObject=isObject$5,createNonEnumerableProperty$2=createNonEnumerableProperty$3,hasOwn$3=hasOwnProperty_1,shared=sharedStore,sharedKey=sharedKey$1,hiddenKeys$2=hiddenKeys$3,OBJECT_ALREADY_INITIALIZED="Object already initialized",TypeError$1=global$4.TypeError,WeakMap=global$4.WeakMap,set,get,has,enforce=function(t){return has(t)?get(t):set(t,{})},getterFor=function(t){return function(e){var n;if(!isObject(e)||(n=get(e)).type!==t)throw TypeError$1("Incompatible receiver, "+t+" required");return n}};if(NATIVE_WEAK_MAP||shared.state){var store=shared.state||(shared.state=new WeakMap),wmget=uncurryThis$2(store.get),wmhas=uncurryThis$2(store.has),wmset=uncurryThis$2(store.set);set=function(t,e){if(wmhas(store,t))throw new TypeError$1(OBJECT_ALREADY_INITIALIZED);return e.facade=t,wmset(store,t,e),e},get=function(t){return wmget(store,t)||{}},has=function(t){return wmhas(store,t)}}else{var STATE=sharedKey("state");hiddenKeys$2[STATE]=!0,set=function(t,e){if(hasOwn$3(t,STATE))throw new TypeError$1(OBJECT_ALREADY_INITIALIZED);return e.facade=t,createNonEnumerableProperty$2(t,STATE,e),e},get=function(t){return hasOwn$3(t,STATE)?t[STATE]:{}},has=function(t){return hasOwn$3(t,STATE)}}var internalState={set,get,has,enforce,getterFor},fails$1=fails$8,isCallable$2=isCallable$a,hasOwn$2=hasOwnProperty_1,DESCRIPTORS=descriptors,CONFIGURABLE_FUNCTION_NAME=functionName.CONFIGURABLE,inspectSource=inspectSource$2,InternalStateModule=internalState,enforceInternalState=InternalStateModule.enforce,getInternalState=InternalStateModule.get,defineProperty=Object.defineProperty,CONFIGURABLE_LENGTH=DESCRIPTORS&&!fails$1((function(){return 8!==defineProperty((function(){}),"length",{value:8}).length})),TEMPLATE=String(String).split("String"),makeBuiltIn$1=makeBuiltIn$2.exports=function(t,e,n){if("Symbol("===String(e).slice(0,7)&&(e="["+String(e).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),n&&n.getter&&(e="get "+e),n&&n.setter&&(e="set "+e),(!hasOwn$2(t,"name")||CONFIGURABLE_FUNCTION_NAME&&t.name!==e)&&defineProperty(t,"name",{value:e,configurable:!0}),CONFIGURABLE_LENGTH&&n&&hasOwn$2(n,"arity")&&t.length!==n.arity&&defineProperty(t,"length",{value:n.arity}),n&&hasOwn$2(n,"constructor")&&n.constructor){if(DESCRIPTORS)try{defineProperty(t,"prototype",{writable:!1})}catch(t){}}else t.prototype=void 0;var r=enforceInternalState(t);return hasOwn$2(r,"source")||(r.source=TEMPLATE.join("string"==typeof e?e:"")),t};Function.prototype.toString=makeBuiltIn$1((function(){return isCallable$2(this)&&getInternalState(this).source||inspectSource(this)}),"toString");var global$3=global$m,isCallable$1=isCallable$a,createNonEnumerableProperty$1=createNonEnumerableProperty$3,makeBuiltIn=makeBuiltIn$2.exports,setGlobal$1=setGlobal$3,defineBuiltIn$1=function(t,e,n,r){var i=!!r&&!!r.unsafe,o=!!r&&!!r.enumerable,a=!!r&&!!r.noTargetGet,s=r&&void 0!==r.name?r.name:e;return isCallable$1(n)&&makeBuiltIn(n,s,r),t===global$3?(o?t[e]=n:setGlobal$1(e,n),t):(i?!a&&t[e]&&(o=!0):delete t[e],o?t[e]=n:createNonEnumerableProperty$1(t,e,n),t)},objectGetOwnPropertyNames={},ceil=Math.ceil,floor=Math.floor,toIntegerOrInfinity$2=function(t){var e=+t;return e!=e||0===e?0:(e>0?floor:ceil)(e)},toIntegerOrInfinity$1=toIntegerOrInfinity$2,max=Math.max,min$1=Math.min,toAbsoluteIndex$1=function(t,e){var n=toIntegerOrInfinity$1(t);return n<0?max(n+e,0):min$1(n,e)},toIntegerOrInfinity=toIntegerOrInfinity$2,min=Math.min,toLength$1=function(t){return t>0?min(toIntegerOrInfinity(t),9007199254740991):0},toLength=toLength$1,lengthOfArrayLike$1=function(t){return toLength(t.length)},toIndexedObject$1=toIndexedObject$3,toAbsoluteIndex=toAbsoluteIndex$1,lengthOfArrayLike=lengthOfArrayLike$1,createMethod=function(t){return function(e,n,r){var i,o=toIndexedObject$1(e),a=lengthOfArrayLike(o),s=toAbsoluteIndex(r,a);if(t&&n!=n){for(;a>s;)if((i=o[s++])!=i)return!0}else for(;a>s;s++)if((t||s in o)&&o[s]===n)return t||s||0;return!t&&-1}},arrayIncludes={includes:createMethod(!0),indexOf:createMethod(!1)},uncurryThis$1=functionUncurryThis,hasOwn$1=hasOwnProperty_1,toIndexedObject=toIndexedObject$3,indexOf=arrayIncludes.indexOf,hiddenKeys$1=hiddenKeys$3,push=uncurryThis$1([].push),objectKeysInternal=function(t,e){var n,r=toIndexedObject(t),i=0,o=[];for(n in r)!hasOwn$1(hiddenKeys$1,n)&&hasOwn$1(r,n)&&push(o,n);for(;e.length>i;)hasOwn$1(r,n=e[i++])&&(~indexOf(o,n)||push(o,n));return o},enumBugKeys$1=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],internalObjectKeys=objectKeysInternal,enumBugKeys=enumBugKeys$1,hiddenKeys=enumBugKeys.concat("length","prototype");objectGetOwnPropertyNames.f=Object.getOwnPropertyNames||function(t){return internalObjectKeys(t,hiddenKeys)};var objectGetOwnPropertySymbols={};objectGetOwnPropertySymbols.f=Object.getOwnPropertySymbols;var getBuiltIn=getBuiltIn$3,uncurryThis=functionUncurryThis,getOwnPropertyNamesModule=objectGetOwnPropertyNames,getOwnPropertySymbolsModule=objectGetOwnPropertySymbols,anObject=anObject$2,concat=uncurryThis([].concat),ownKeys$1=getBuiltIn("Reflect","ownKeys")||function(t){var e=getOwnPropertyNamesModule.f(anObject(t)),n=getOwnPropertySymbolsModule.f;return n?concat(e,n(t)):e},hasOwn=hasOwnProperty_1,ownKeys=ownKeys$1,getOwnPropertyDescriptorModule=objectGetOwnPropertyDescriptor,definePropertyModule=objectDefineProperty,copyConstructorProperties$1=function(t,e,n){for(var r=ownKeys(e),i=definePropertyModule.f,o=getOwnPropertyDescriptorModule.f,a=0;a<r.length;a++){var s=r[a];hasOwn(t,s)||n&&hasOwn(n,s)||i(t,s,o(e,s))}},fails=fails$8,isCallable=isCallable$a,replacement=/#|\.prototype\./,isForced$1=function(t,e){var n=data$1[normalize$1(t)];return n==POLYFILL||n!=NATIVE&&(isCallable(e)?fails(e):!!e)},normalize$1=isForced$1.normalize=function(t){return String(t).replace(replacement,".").toLowerCase()},data$1=isForced$1.data={},NATIVE=isForced$1.NATIVE="N",POLYFILL=isForced$1.POLYFILL="P",isForced_1=isForced$1,global$2=global$m,getOwnPropertyDescriptor=objectGetOwnPropertyDescriptor.f,createNonEnumerableProperty=createNonEnumerableProperty$3,defineBuiltIn=defineBuiltIn$1,setGlobal=setGlobal$3,copyConstructorProperties=copyConstructorProperties$1,isForced=isForced_1,_export=function(t,e){var n,r,i,o,a,s=t.target,l=t.global,u=t.stat;if(n=l?global$2:u?global$2[s]||setGlobal(s,{}):(global$2[s]||{}).prototype)for(r in e){if(o=e[r],i=t.noTargetGet?(a=getOwnPropertyDescriptor(n,r))&&a.value:n[r],!isForced(l?r:s+(u?".":"#")+r,t.forced)&&void 0!==i){if(_typeof(o)==_typeof(i))continue;copyConstructorProperties(o,i)}(t.sham||i&&i.sham)&&createNonEnumerableProperty(o,"sham",!0),defineBuiltIn(n,r,o,t)}},$=_export,global$1=global$m;if($({global:!0},{globalThis:global$1}),"undefined"!=typeof globalThis&&void 0===globalThis.console&&(globalThis.console={},globalThis.console.log=function(){},globalThis.console.assert=function(){},globalThis.console.warn=function(){},globalThis.console.error=function(){alert(Array.prototype.slice.call(arguments).join(", "))}),"performance"in globalThis==0&&(globalThis.performance={}),Date.now=Date.now||function(){return(new Date).getTime()},"now"in globalThis.performance==0){var nowOffset=Date.now();performance.timing&&performance.timing.navigationStart&&(nowOffset=performance.timing.navigationStart),globalThis.performance.now=function(){return Date.now()-nowOffset}}function capitalize(t){return t.charAt(0).toUpperCase()+t.slice(1)}function trimLeft(t){return t.replace(/^\s+/,"")}function trimRight(t){return t.replace(/\s+$/,"")}function isNumeric(t){return"string"==typeof t&&(t=t.trim()),!isNaN(t)&&/[+-]?([0-9]*[.])?[0-9]+/.test(t)}function isBoolean(t){var e=t.trim();return"true"===e||"false"===e}function toHex$1(t){for(var e="",n=0;n<t.length;)e+=t.charCodeAt(n++).toString(16);return e}var stringUtils=Object.freeze({__proto__:null,capitalize,trimLeft,trimRight,isNumeric,isBoolean,toHex:toHex$1}),vendors$1=["ms","MS","moz","webkit","o"];function prefixed(t,e){if(t in(e=e||globalThis))return e[t];var n,r=capitalize(t);return vendors$1.some((function(t){var i=t+r;return n=i in e?e[i]:void 0})),n}function setPrefixed(t,e,n){if(!(t in(n=n||globalThis))){var r=capitalize(t);return vendors$1.some((function(t){var i=t+r;if(i in n)return n[i]=e,!0})),!1}n[t]=e}var agentUtils=Object.freeze({__proto__:null,prefixed,setPrefixed}),DEG_TO_RAD=Math.PI/180,RAD_TO_DEG=180/Math.PI,TAU=2*Math.PI,ETA=.5*Math.PI,EPSILON=1e-6;function isPowerOfTwo(t){return 0==(t&t-1)}function nextPowerOfTwo(t){return t--,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,++t}function degToRad(t){return t*DEG_TO_RAD}function radToDeg(t){return t*RAD_TO_DEG}function _clamp(t,e,n){return t<e?e:t>n?n:+t}function random$1(t,e){return~~(Math.random()*(e-t))+t}function randomFloat(t,e){return Math.random()*(e-t)+t}function weightedRandom$1(t,e){return~~(Math.pow(Math.random(),2)*(e-t))+t}function round(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=Math.pow(10,e);return~~(.5+t*n)/n}function toBeCloseTo(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;return Math.abs(t-e)<Math.pow(10,-n)/2}var math=Object.freeze({__proto__:null,DEG_TO_RAD,RAD_TO_DEG,TAU,ETA,EPSILON,isPowerOfTwo,nextPowerOfTwo,degToRad,radToDeg,clamp:_clamp,random:random$1,randomFloat,weightedRandom:weightedRandom$1,round,toBeCloseTo});function _remove(t,e){var n=Array.prototype.indexOf.call(t,e);return-1!==n&&Array.prototype.splice.call(t,n,1),t}function random(t){return t[random$1(0,t.length)]}function weightedRandom(t){return t[weightedRandom$1(0,t.length)]}var arrayUtils=Object.freeze({__proto__:null,remove:_remove,random,weightedRandom}),REMOVE_PATH=/^.*(\\|\/|\:)/,REMOVE_EXT=/\.[^\.]*$/;function getBasename(t){return t.replace(REMOVE_PATH,"").replace(REMOVE_EXT,"")}function getExtension(t){return t.substring(t.lastIndexOf(".")+1,t.length)}var fileUtils=Object.freeze({__proto__:null,getBasename,getExtension});function defer(t,e){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return setTimeout.apply(void 0,[t.bind(e),.01].concat(r))}function throttle(t,e,n){var r,i=globalThis.performance.now();return"boolean"!=typeof n&&(n=!1),function(){var o=globalThis.performance.now(),a=o-i,s=arguments;if(!(a<e))return i=o,t.apply(null,s);!1===n&&(clearTimeout(r),r=setTimeout((function(){return i=o,t.apply(null,s)}),a))}}var fnUtils=Object.freeze({__proto__:null,defer,throttle}),ObjectPool=function(){function t(){_classCallCheck(this,t),this.objectClass={},this.instance_counter=0}return _createClass(t,[{key:"register",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(void 0===e)throw new Error("Cannot register object '"+t+"', invalid class");this.objectClass[t]={class:e,pool:n?[]:void 0}}},{key:"pull",value:function(t){for(var e=new Array(arguments.length),n=0;n<arguments.length;n++)e[n]=arguments[n];var r=this.objectClass[t];if(r){var i,o=r.class,a=r.pool;return a&&(i=a.pop())?(e.shift(),"function"==typeof i.onResetEvent&&i.onResetEvent.apply(i,e),this.instance_counter--):(e[0]=o,i=new(o.bind.apply(o,e)),a&&(i.className=t)),i}throw new Error("Cannot instantiate object of type '"+t+"'")}},{key:"purge",value:function(){for(var t in this.objectClass)this.objectClass[t]&&(this.objectClass[t].pool=[]);this.instance_counter=0}},{key:"push",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!this.poolable(t)){if(!0===e)throw new Error("me.pool: object "+t+" cannot be recycled");return!1}return this.objectClass[t.className].pool.push(t),this.instance_counter++,!0}},{key:"exists",value:function(t){return t in this.objectClass}},{key:"poolable",value:function(t){var e=t.className;return void 0!==e&&"function"==typeof t.onResetEvent&&e in this.objectClass&&"undefined"!==this.objectClass[e].pool}},{key:"getInstanceCount",value:function(){return this.instance_counter}}]),t}(),pool$1=new ObjectPool,Vector2d=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;_classCallCheck(this,t),this.onResetEvent(e,n)}return _createClass(t,[{key:"onResetEvent",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=t,this.y=e,this}},{key:"_set",value:function(t,e){return this.x=t,this.y=e,this}},{key:"set",value:function(t,e){if(t!==+t||e!==+e)throw new Error("invalid x,y parameters (not a number)");return this._set(t,e)}},{key:"setZero",value:function(){return this.set(0,0)}},{key:"setV",value:function(t){return this._set(t.x,t.y)}},{key:"add",value:function(t){return this._set(this.x+t.x,this.y+t.y)}},{key:"sub",value:function(t){return this._set(this.x-t.x,this.y-t.y)}},{key:"scale",value:function(t,e){return this._set(this.x*t,this.y*(void 0!==e?e:t))}},{key:"toIso",value:function(){return this._set(this.x-this.y,.5*(this.x+this.y))}},{key:"to2d",value:function(){return this._set(this.y+this.x/2,this.y-this.x/2)}},{key:"scaleV",value:function(t){return this._set(this.x*t.x,this.y*t.y)}},{key:"div",value:function(t){return this._set(this.x/t,this.y/t)}},{key:"abs",value:function(){return this._set(this.x<0?-this.x:this.x,this.y<0?-this.y:this.y)}},{key:"clamp",value:function(e,n){return new t(_clamp(this.x,e,n),_clamp(this.y,e,n))}},{key:"clampSelf",value:function(t,e){return this._set(_clamp(this.x,t,e),_clamp(this.y,t,e))}},{key:"minV",value:function(t){return this._set(this.x<t.x?this.x:t.x,this.y<t.y?this.y:t.y)}},{key:"maxV",value:function(t){return this._set(this.x>t.x?this.x:t.x,this.y>t.y?this.y:t.y)}},{key:"floor",value:function(){return new t(Math.floor(this.x),Math.floor(this.y))}},{key:"floorSelf",value:function(){return this._set(Math.floor(this.x),Math.floor(this.y))}},{key:"ceil",value:function(){return new t(Math.ceil(this.x),Math.ceil(this.y))}},{key:"ceilSelf",value:function(){return this._set(Math.ceil(this.x),Math.ceil(this.y))}},{key:"negate",value:function(){return new t(-this.x,-this.y)}},{key:"negateSelf",value:function(){return this._set(-this.x,-this.y)}},{key:"copy",value:function(t){return this._set(t.x,t.y)}},{key:"equals",value:function(){var t,e;return 2===arguments.length?(t=arguments[0],e=arguments[1]):(t=arguments[0].x,e=arguments[0].y),this.x===t&&this.y===e}},{key:"normalize",value:function(){return this.div(this.length()||1)}},{key:"perp",value:function(){return this._set(this.y,-this.x)}},{key:"rotate",value:function(t,e){var n=0,r=0;"object"===_typeof(e)&&(n=e.x,r=e.y);var i=this.x-n,o=this.y-r,a=Math.cos(t),s=Math.sin(t);return this._set(i*a-o*s+n,i*s+o*a+r)}},{key:"dot",value:function(t){return this.x*t.x+this.y*t.y}},{key:"cross",value:function(t){return this.x*t.y-this.y*t.x}},{key:"length2",value:function(){return this.dot(this)}},{key:"length",value:function(){return Math.sqrt(this.length2())}},{key:"lerp",value:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this}},{key:"distance",value:function(t){var e=this.x-t.x,n=this.y-t.y;return Math.sqrt(e*e+n*n)}},{key:"angle",value:function(t){return Math.acos(_clamp(this.dot(t)/(this.length()*t.length()),-1,1))}},{key:"project",value:function(t){return this.scale(this.dot(t)/t.length2())}},{key:"projectN",value:function(t){return this.scale(this.dot(t))}},{key:"clone",value:function(){return pool$1.pull("Vector2d",this.x,this.y)}},{key:"toString",value:function(){return"x:"+this.x+",y:"+this.y}}]),t}(),_toHex=function(t){return"0123456789ABCDEF".charAt(t-t%16>>4)+"0123456789ABCDEF".charAt(t%16)},rgbaRx=/^rgba?\((\d+), ?(\d+), ?(\d+)(, ?([\d\.]+))?\)$/,hex3Rx=/^#([\da-fA-F])([\da-fA-F])([\da-fA-F])$/,hex4Rx=/^#([\da-fA-F])([\da-fA-F])([\da-fA-F])([\da-fA-F])$/,hex6Rx=/^#([\da-fA-F]{2})([\da-fA-F]{2})([\da-fA-F]{2})$/,hex8Rx=/^#([\da-fA-F]{2})([\da-fA-F]{2})([\da-fA-F]{2})([\da-fA-F]{2})$/,cssToRGB=new Map;[["black",[0,0,0]],["silver",[192,192,129]],["gray",[128,128,128]],["white",[255,255,255]],["maroon",[128,0,0]],["red",[255,0,0]],["purple",[128,0,128]],["fuchsia",[255,0,255]],["green",[0,128,0]],["lime",[0,255,0]],["olive",[128,128,0]],["yellow",[255,255,0]],["navy",[0,0,128]],["blue",[0,0,255]],["teal",[0,128,128]],["aqua",[0,255,255]],["orange",[255,165,0]],["aliceblue",[240,248,245]],["antiquewhite",[250,235,215]],["aquamarine",[127,255,212]],["azure",[240,255,255]],["beige",[245,245,220]],["bisque",[255,228,196]],["blanchedalmond",[255,235,205]],["blueviolet",[138,43,226]],["brown",[165,42,42]],["burlywood",[222,184,35]],["cadetblue",[95,158,160]],["chartreuse",[127,255,0]],["chocolate",[210,105,30]],["coral",[255,127,80]],["cornflowerblue",[100,149,237]],["cornsilk",[255,248,220]],["crimson",[220,20,60]],["darkblue",[0,0,139]],["darkcyan",[0,139,139]],["darkgoldenrod",[184,134,11]],["darkgray[*]",[169,169,169]],["darkgreen",[0,100,0]],["darkgrey[*]",[169,169,169]],["darkkhaki",[189,183,107]],["darkmagenta",[139,0,139]],["darkolivegreen",[85,107,47]],["darkorange",[255,140,0]],["darkorchid",[153,50,204]],["darkred",[139,0,0]],["darksalmon",[233,150,122]],["darkseagreen",[143,188,143]],["darkslateblue",[72,61,139]],["darkslategray",[47,79,79]],["darkslategrey",[47,79,79]],["darkturquoise",[0,206,209]],["darkviolet",[148,0,211]],["deeppink",[255,20,147]],["deepskyblue",[0,191,255]],["dimgray",[105,105,105]],["dimgrey",[105,105,105]],["dodgerblue",[30,144,255]],["firebrick",[178,34,34]],["floralwhite",[255,250,240]],["forestgreen",[34,139,34]],["gainsboro",[220,220,220]],["ghostwhite",[248,248,255]],["gold",[255,215,0]],["goldenrod",[218,165,32]],["greenyellow",[173,255,47]],["grey",[128,128,128]],["honeydew",[240,255,240]],["hotpink",[255,105,180]],["indianred",[205,92,92]],["indigo",[75,0,130]],["ivory",[255,255,240]],["khaki",[240,230,140]],["lavender",[230,230,250]],["lavenderblush",[255,240,245]],["lawngreen",[124,252,0]],["lemonchiffon",[255,250,205]],["lightblue",[173,216,230]],["lightcoral",[240,128,128]],["lightcyan",[224,255,255]],["lightgoldenrodyellow",[250,250,210]],["lightgray",[211,211,211]],["lightgreen",[144,238,144]],["lightgrey",[211,211,211]],["lightpink",[255,182,193]],["lightsalmon",[255,160,122]],["lightseagreen",[32,178,170]],["lightskyblue",[135,206,250]],["lightslategray",[119,136,153]],["lightslategrey",[119,136,153]],["lightsteelblue",[176,196,222]],["lightyellow",[255,255,224]],["limegreen",[50,205,50]],["linen",[250,240,230]],["mediumaquamarine",[102,205,170]],["mediumblue",[0,0,205]],["mediumorchid",[186,85,211]],["mediumpurple",[147,112,219]],["mediumseagreen",[60,179,113]],["mediumslateblue",[123,104,238]],["mediumspringgreen",[0,250,154]],["mediumturquoise",[72,209,204]],["mediumvioletred",[199,21,133]],["midnightblue",[25,25,112]],["mintcream",[245,255,250]],["mistyrose",[255,228,225]],["moccasin",[255,228,181]],["navajowhite",[255,222,173]],["oldlace",[253,245,230]],["olivedrab",[107,142,35]],["orangered",[255,69,0]],["orchid",[218,112,214]],["palegoldenrod",[238,232,170]],["palegreen",[152,251,152]],["paleturquoise",[175,238,238]],["palevioletred",[219,112,147]],["papayawhip",[255,239,213]],["peachpuff",[255,218,185]],["peru",[205,133,63]],["pink",[255,192,203]],["plum",[221,160,221]],["powderblue",[176,224,230]],["rosybrown",[188,143,143]],["royalblue",[65,105,225]],["saddlebrown",[139,69,19]],["salmon",[250,128,114]],["sandybrown",[244,164,96]],["seagreen",[46,139,87]],["seashell",[255,245,238]],["sienna",[160,82,45]],["skyblue",[135,206,235]],["slateblue",[106,90,205]],["slategray",[112,128,144]],["slategrey",[112,128,144]],["snow",[255,250,250]],["springgreen",[0,255,127]],["steelblue",[70,130,180]],["tan",[210,180,140]],["thistle",[216,191,216]],["tomato",[255,99,71]],["turquoise",[64,224,208]],["violet",[238,130,238]],["wheat",[245,222,179]],["whitesmoke",[245,245,245]],["yellowgreen",[154,205,50]]].forEach((function(t){cssToRGB.set(t[0],t[1])}));var Color=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;_classCallCheck(this,t),this.onResetEvent(e,n,r,i)}return _createClass(t,[{key:"onResetEvent",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return void 0===this.glArray&&(this.glArray=new Float32Array([0,0,0,1])),this.setColor(t,e,n,r)}},{key:"r",get:function(){return~~(255*this.glArray[0])},set:function(t){this.glArray[0]=_clamp(~~t||0,0,255)/255}},{key:"g",get:function(){return~~(255*this.glArray[1])},set:function(t){this.glArray[1]=_clamp(~~t||0,0,255)/255}},{key:"b",get:function(){return~~(255*this.glArray[2])},set:function(t){this.glArray[2]=_clamp(~~t||0,0,255)/255}},{key:"alpha",get:function(){return this.glArray[3]},set:function(t){this.glArray[3]=void 0===t?1:_clamp(+t,0,1)}},{key:"setColor",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return this.r=t,this.g=e,this.b=n,this.alpha=r,this}},{key:"clone",value:function(){return pool$1.pull("Color").copy(this)}},{key:"copy",value:function(e){return e instanceof t?(this.glArray.set(e.glArray),this):this.parseCSS(e)}},{key:"add",value:function(t){return this.glArray[0]=_clamp(this.glArray[0]+t.glArray[0],0,1),this.glArray[1]=_clamp(this.glArray[1]+t.glArray[1],0,1),this.glArray[2]=_clamp(this.glArray[2]+t.glArray[2],0,1),this.glArray[3]=(this.glArray[3]+t.glArray[3])/2,this}},{key:"darken",value:function(t){return t=_clamp(t,0,1),this.glArray[0]*=t,this.glArray[1]*=t,this.glArray[2]*=t,this}},{key:"lerp",value:function(t,e){return e=_clamp(e,0,1),this.glArray[0]+=(t.glArray[0]-this.glArray[0])*e,this.glArray[1]+=(t.glArray[1]-this.glArray[1])*e,this.glArray[2]+=(t.glArray[2]-this.glArray[2])*e,this}},{key:"lighten",value:function(t){return t=_clamp(t,0,1),this.glArray[0]=_clamp(this.glArray[0]+(1-this.glArray[0])*t,0,1),this.glArray[1]=_clamp(this.glArray[1]+(1-this.glArray[1])*t,0,1),this.glArray[2]=_clamp(this.glArray[2]+(1-this.glArray[2])*t,0,1),this}},{key:"random",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:255;return t<0&&(t=0),e>255&&(e=255),this.setColor(random$1(t,e),random$1(t,e),random$1(t,e),this.alpha)}},{key:"equals",value:function(t){return this.glArray[0]===t.glArray[0]&&this.glArray[1]===t.glArray[1]&&this.glArray[2]===t.glArray[2]&&this.glArray[3]===t.glArray[3]}},{key:"parseCSS",value:function(t){return cssToRGB.has(t)?this.setColor.apply(this,cssToRGB.get(t)):this.parseRGB(t)}},{key:"parseRGB",value:function(t){var e=rgbaRx.exec(t);return e?this.setColor(+e[1],+e[2],+e[3],+e[5]):this.parseHex(t)}},{key:"parseHex",value:function(t){var e,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e=hex8Rx.exec(t))return this.setColor(parseInt(e[!1===n?1:2],16),parseInt(e[!1===n?2:3],16),parseInt(e[!1===n?3:4],16),(_clamp(parseInt(e[!1===n?4:1],16),0,255)/255).toFixed(1));if(e=hex6Rx.exec(t))return this.setColor(parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16));if(e=hex4Rx.exec(t)){var r=e[!1===n?1:2],i=e[!1===n?2:3],o=e[!1===n?3:4],a=e[!1===n?4:1];return this.setColor(parseInt(r+r,16),parseInt(i+i,16),parseInt(o+o,16),(_clamp(parseInt(a+a,16),0,255)/255).toFixed(1))}if(e=hex3Rx.exec(t))return this.setColor(parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16));throw new Error("invalid parameter: "+t)}},{key:"toUint32",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.alpha,e=255&this.r,n=255&this.g,r=255&this.b,i=255*t&255;return(i<<24)+(e<<16)+(n<<8)+r}},{key:"toArray",value:function(){return this.glArray}},{key:"toHex",value:function(){return"#"+_toHex(this.r)+_toHex(this.g)+_toHex(this.b)}},{key:"toHex8",value:function(){return"#"+_toHex(this.r)+_toHex(this.g)+_toHex(this.b)+_toHex(255*this.alpha)}},{key:"toRGB",value:function(){return"rgb("+this.r+","+this.g+","+this.b+")"}},{key:"toRGBA",value:function(){return"rgba("+this.r+","+this.g+","+this.b+","+this.alpha+")"}}]),t}(),Matrix3d=function(){function t(){_classCallCheck(this,t),this.onResetEvent.apply(this,arguments)}return _createClass(t,[{key:"onResetEvent",value:function(){void 0===this.val&&(this.val=new Float32Array(16)),arguments.length&&arguments[0]instanceof t?this.copy(arguments[0]):16===arguments.length?this.setTransform.apply(this,arguments):this.identity()}},{key:"tx",get:function(){return this.val[12]}},{key:"ty",get:function(){return this.val[13]}},{key:"tz",get:function(){return this.val[14]}},{key:"identity",value:function(){return this.setTransform(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)}},{key:"setTransform",value:function(t,e,n,r,i,o,a,s,l,u,c,h,f,d,p,y){var v=this.val;return v[0]=t,v[1]=e,v[2]=n,v[3]=r,v[4]=i,v[5]=o,v[6]=a,v[7]=s,v[8]=l,v[9]=u,v[10]=c,v[11]=h,v[12]=f,v[13]=d,v[14]=p,v[15]=y,this}},{key:"copy",value:function(t){return this.val.set(t.val),this}},{key:"fromMat2d",value:function(t){var e=t.val;return this.setTransform(e[0],e[3],e[6],0,e[1],e[4],e[7],0,e[2],e[5],e[8],0,0,0,0,1)}},{key:"multiply",value:function(t){var e=this.val,n=t.val,r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],l=e[5],u=e[6],c=e[7],h=e[8],f=e[9],d=e[10],p=e[11],y=e[12],v=e[13],g=e[14],m=e[15],_=n[0],b=n[1],x=n[2],w=n[3];return e[0]=_*r+b*s+x*h+w*y,e[1]=_*i+b*l+x*f+w*v,e[2]=_*o+b*u+x*d+w*g,e[3]=_*a+b*c+x*p+w*m,_=n[4],b=n[5],x=n[6],w=n[7],e[4]=_*r+b*s+x*h+w*y,e[5]=_*i+b*l+x*f+w*v,e[6]=_*o+b*u+x*d+w*g,e[7]=_*a+b*c+x*p+w*m,_=n[8],b=n[9],x=n[10],w=n[11],e[8]=_*r+b*s+x*h+w*y,e[9]=_*i+b*l+x*f+w*v,e[10]=_*o+b*u+x*d+w*g,e[11]=_*a+b*c+x*p+w*m,_=n[12],b=n[13],x=n[14],w=n[15],e[12]=_*r+b*s+x*h+w*y,e[13]=_*i+b*l+x*f+w*v,e[14]=_*o+b*u+x*d+w*g,e[15]=_*a+b*c+x*p+w*m,this}},{key:"transpose",value:function(){var t=this.val,e=t[1],n=t[2],r=t[3],i=t[6],o=t[7],a=t[11];return t[1]=t[4],t[2]=t[8],t[3]=t[12],t[4]=e,t[6]=t[9],t[7]=t[13],t[8]=n,t[9]=i,t[11]=t[14],t[12]=r,t[13]=o,t[14]=a,this}},{key:"invert",value:function(){var t=this.val,e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],a=t[5],s=t[6],l=t[7],u=t[8],c=t[9],h=t[10],f=t[11],d=t[12],p=t[13],y=t[14],v=t[15],g=e*a-n*o,m=e*s-r*o,_=e*l-i*o,b=n*s-r*a,x=n*l-i*a,w=r*l-i*s,T=u*p-c*d,E=u*y-h*d,S=u*v-f*d,k=c*y-h*p,O=c*v-f*p,A=h*v-f*y,P=g*A-m*O+_*k+b*S-x*E+w*T;return P?(P=1/P,t[0]=(a*A-s*O+l*k)*P,t[1]=(r*O-n*A-i*k)*P,t[2]=(p*w-y*x+v*b)*P,t[3]=(h*x-c*w-f*b)*P,t[4]=(s*S-o*A-l*E)*P,t[5]=(e*A-r*S+i*E)*P,t[6]=(y*_-d*w-v*m)*P,t[7]=(u*w-h*_+f*m)*P,t[8]=(o*O-a*S+l*T)*P,t[9]=(n*S-e*O-i*T)*P,t[10]=(d*x-p*_+v*g)*P,t[11]=(c*_-u*x-f*g)*P,t[12]=(a*E-o*k-s*T)*P,t[13]=(e*k-n*E+r*T)*P,t[14]=(p*m-d*b-y*g)*P,t[15]=(u*b-c*m+h*g)*P,this):null}},{key:"apply",value:function(t){var e=this.val,n=t.x,r=t.y,i=void 0!==t.z?t.z:1,o=e[3]*n+e[7]*r+e[11]*i+e[15]||1;return t.x=(e[0]*n+e[4]*r+e[8]*i+e[12])/o,t.y=(e[1]*n+e[5]*r+e[9]*i+e[13])/o,void 0!==t.z&&(t.z=(e[2]*n+e[6]*r+e[10]*i+e[14])/o),t}},{key:"applyInverse",value:function(t){var e=pool$1.pull("Matrix3d",this).invert();return e.apply(t),pool$1.push(e),t}},{key:"ortho",value:function(t,e,n,r,i,o){var a=this.val,s=1/(t-e),l=1/(n-r),u=1/(i-o);return a[0]=-2*s,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=-2*l,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=2*u,a[11]=0,a[12]=(t+e)*s,a[13]=(r+n)*l,a[14]=(o+i)*u,a[15]=1,this}},{key:"scale",value:function(t,e,n){var r=this.val,i=t,o=void 0===e?i:e,a=void 0===n?0:n;return r[0]=r[0]*i,r[1]=r[1]*i,r[2]=r[2]*i,r[3]=r[3]*i,r[4]=r[4]*o,r[5]=r[5]*o,r[6]=r[6]*o,r[7]=r[7]*o,r[8]=r[8]*a,r[9]=r[9]*a,r[10]=r[10]*a,r[11]=r[11]*a,this}},{key:"scaleV",value:function(t){return this.scale(t.x,t.y,t.z)}},{key:"scaleX",value:function(t){return this.scale(t,1)}},{key:"scaleY",value:function(t){return this.scale(1,t)}},{key:"rotate",value:function(t,e){if(0!==t){var n,r,i,o,a,s,l,u,c,h,f,d,p,y,v,g,m,_,b,x,w,T,E,S,k=this.val,O=e.x,A=e.y,P=e.z,C=Math.sqrt(O*O+A*A+P*P);if(C<EPSILON)return null;O*=C=1/C,A*=C,P*=C,n=Math.sin(t),i=1-(r=Math.cos(t)),o=k[0],a=k[1],s=k[2],l=k[3],u=k[4],c=k[5],h=k[6],f=k[7],d=k[8],p=k[9],y=k[10],v=k[11],g=O*O*i+r,m=A*O*i+P*n,_=P*O*i-A*n,b=O*A*i-P*n,x=A*A*i+r,w=P*A*i+O*n,T=O*P*i+A*n,E=A*P*i-O*n,S=P*P*i+r,k[0]=o*g+u*m+d*_,k[1]=a*g+c*m+p*_,k[2]=s*g+h*m+y*_,k[3]=l*g+f*m+v*_,k[4]=o*b+u*x+d*w,k[5]=a*b+c*x+p*w,k[6]=s*b+h*x+y*w,k[7]=l*b+f*x+v*w,k[8]=o*T+u*E+d*S,k[9]=a*T+c*E+p*S,k[10]=s*T+h*E+y*S,k[11]=l*T+f*E+v*S}return this}},{key:"translate",value:function(){var t,e,n,r=this.val;return arguments.length>1?(t=arguments[0],e=arguments[1],n=void 0===arguments[2]?0:arguments[2]):(t=arguments[0].x,e=arguments[0].y,n=void 0===arguments[0].z?0:arguments[0].z),r[12]=r[0]*t+r[4]*e+r[8]*n+r[12],r[13]=r[1]*t+r[5]*e+r[9]*n+r[13],r[14]=r[2]*t+r[6]*e+r[10]*n+r[14],r[15]=r[3]*t+r[7]*e+r[11]*n+r[15],this}},{key:"isIdentity",value:function(){var t=this.val;return 1===t[0]&&0===t[1]&&0===t[2]&&0===t[3]&&0===t[4]&&1===t[5]&&0===t[6]&&0===t[7]&&0===t[8]&&0===t[9]&&1===t[10]&&0===t[11]&&0===t[12]&&0===t[13]&&0===t[14]&&1===t[15]}},{key:"equals",value:function(t){var e=t.val,n=this.val;return n[0]===e[0]&&n[1]===e[1]&&n[2]===e[2]&&n[3]===e[3]&&n[4]===e[4]&&n[5]===e[5]&&n[6]===e[6]&&n[7]===e[7]&&n[8]===e[8]&&n[9]===e[9]&&n[10]===e[10]&&n[11]===e[11]&&n[12]===e[12]&&n[13]===e[13]&&n[14]===e[14]&&n[15]===e[15]}},{key:"clone",value:function(){return pool$1.pull("Matrix3d",this)}},{key:"toArray",value:function(){return this.val}},{key:"toString",value:function(){var t=this.val;return"me.Matrix3d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}}]),t}(),Matrix2d=function(){function t(){_classCallCheck(this,t),this.onResetEvent.apply(this,arguments)}return _createClass(t,[{key:"onResetEvent",value:function(){return void 0===this.val&&(this.val=new Float32Array(9)),arguments.length&&arguments[0]instanceof t?this.copy(arguments[0]):arguments.length&&arguments[0]instanceof Matrix3d?this.fromMat3d(arguments[0]):arguments.length>=6?this.setTransform.apply(this,arguments):this.identity(),this}},{key:"tx",get:function(){return this.val[6]}},{key:"ty",get:function(){return this.val[7]}},{key:"identity",value:function(){return this.setTransform(1,0,0,0,1,0,0,0,1),this}},{key:"setTransform",value:function(){var t=this.val;return 9===arguments.length?(t[0]=arguments[0],t[1]=arguments[1],t[2]=arguments[2],t[3]=arguments[3],t[4]=arguments[4],t[5]=arguments[5],t[6]=arguments[6],t[7]=arguments[7],t[8]=arguments[8]):6===arguments.length&&(t[0]=arguments[0],t[1]=arguments[2],t[2]=arguments[4],t[3]=arguments[1],t[4]=arguments[3],t[5]=arguments[5],t[6]=0,t[7]=0,t[8]=1),this}},{key:"copy",value:function(t){return this.val.set(t.val),this}},{key:"fromMat3d",value:function(t){var e=t.val,n=this.val;return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[4],n[4]=e[5],n[5]=e[6],n[6]=e[8],n[7]=e[9],n[8]=e[10],this}},{key:"multiply",value:function(t){var e=t.val,n=this.val,r=n[0],i=n[1],o=n[3],a=n[4],s=e[0],l=e[1],u=e[3],c=e[4],h=e[6],f=e[7];return n[0]=r*s+o*l,n[1]=i*s+a*l,n[3]=r*u+o*c,n[4]=i*u+a*c,n[6]+=r*h+o*f,n[7]+=i*h+a*f,this}},{key:"transpose",value:function(){var t=this.val,e=t[1],n=t[2],r=t[5];return t[1]=t[3],t[2]=t[6],t[3]=e,t[5]=t[7],t[6]=n,t[7]=r,this}},{key:"invert",value:function(){var t=this.val,e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],a=t[5],s=t[6],l=t[7],u=t[8],c=u*o-a*l,h=a*s-u*i,f=l*i-o*s,d=e*c+n*h+r*f;return t[0]=c/d,t[1]=(r*l-u*n)/d,t[2]=(a*n-r*o)/d,t[3]=h/d,t[4]=(u*e-r*s)/d,t[5]=(r*i-a*e)/d,t[6]=f/d,t[7]=(n*s-l*e)/d,t[8]=(o*e-n*i)/d,this}},{key:"apply",value:function(t){var e=this.val,n=t.x,r=t.y;return t.x=n*e[0]+r*e[3]+e[6],t.y=n*e[1]+r*e[4]+e[7],t}},{key:"applyInverse",value:function(t){var e=this.val,n=t.x,r=t.y,i=1/(e[0]*e[4]+e[3]*-e[1]);return t.x=e[4]*i*n+-e[3]*i*r+(e[7]*e[3]-e[6]*e[4])*i,t.y=e[0]*i*r+-e[1]*i*n+(-e[7]*e[0]+e[6]*e[1])*i,t}},{key:"scale",value:function(t,e){var n=this.val,r=t,i=void 0===e?r:e;return n[0]*=r,n[1]*=r,n[3]*=i,n[4]*=i,this}},{key:"scaleV",value:function(t){return this.scale(t.x,t.y)}},{key:"scaleX",value:function(t){return this.scale(t,1)}},{key:"scaleY",value:function(t){return this.scale(1,t)}},{key:"rotate",value:function(t){if(0!==t){var e=this.val,n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],l=Math.sin(t),u=Math.cos(t);e[0]=u*n+l*o,e[1]=u*r+l*a,e[2]=u*i+l*s,e[3]=u*o-l*n,e[4]=u*a-l*r,e[5]=u*s-l*i}return this}},{key:"translate",value:function(){var t,e,n=this.val;return 2===arguments.length?(t=arguments[0],e=arguments[1]):(t=arguments[0].x,e=arguments[0].y),n[6]+=n[0]*t+n[3]*e,n[7]+=n[1]*t+n[4]*e,this}},{key:"isIdentity",value:function(){var t=this.val;return 1===t[0]&&0===t[1]&&0===t[2]&&0===t[3]&&1===t[4]&&0===t[5]&&0===t[6]&&0===t[7]&&1===t[8]}},{key:"equals",value:function(t){var e=t.val,n=this.val;return n[0]===e[0]&&n[1]===e[1]&&n[2]===e[2]&&n[3]===e[3]&&n[4]===e[4]&&n[5]===e[5]&&n[6]===e[6]&&n[7]===e[7]&&n[8]===e[8]}},{key:"clone",value:function(){return pool$1.pull("Matrix2d",this)}},{key:"toArray",value:function(){return this.val}},{key:"toString",value:function(){var t=this.val;return"me.Matrix2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"}}]),t}(),eventemitter3={exports:{}};!function(t){var e=Object.prototype.hasOwnProperty,n="~";function r(){}function i(t,e,n){this.fn=t,this.context=e,this.once=n||!1}function o(t,e,r,o,a){if("function"!=typeof r)throw new TypeError("The listener must be a function");var s=new i(r,o||t,a),l=n?n+e:e;return t._events[l]?t._events[l].fn?t._events[l]=[t._events[l],s]:t._events[l].push(s):(t._events[l]=s,t._eventsCount++),t}function a(t,e){0==--t._eventsCount?t._events=new r:delete t._events[e]}function s(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(n=!1)),s.prototype.eventNames=function(){var t,r,i=[];if(0===this._eventsCount)return i;for(r in t=this._events)e.call(t,r)&&i.push(n?r.slice(1):r);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(t)):i},s.prototype.listeners=function(t){var e=n?n+t:t,r=this._events[e];if(!r)return[];if(r.fn)return[r.fn];for(var i=0,o=r.length,a=new Array(o);i<o;i++)a[i]=r[i].fn;return a},s.prototype.listenerCount=function(t){var e=n?n+t:t,r=this._events[e];return r?r.fn?1:r.length:0},s.prototype.emit=function(t,e,r,i,o,a){var s=n?n+t:t;if(!this._events[s])return!1;var l,u,c=this._events[s],h=arguments.length;if(c.fn){switch(c.once&&this.removeListener(t,c.fn,void 0,!0),h){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,e),!0;case 3:return c.fn.call(c.context,e,r),!0;case 4:return c.fn.call(c.context,e,r,i),!0;case 5:return c.fn.call(c.context,e,r,i,o),!0;case 6:return c.fn.call(c.context,e,r,i,o,a),!0}for(u=1,l=new Array(h-1);u<h;u++)l[u-1]=arguments[u];c.fn.apply(c.context,l)}else{var f,d=c.length;for(u=0;u<d;u++)switch(c[u].once&&this.removeListener(t,c[u].fn,void 0,!0),h){case 1:c[u].fn.call(c[u].context);break;case 2:c[u].fn.call(c[u].context,e);break;case 3:c[u].fn.call(c[u].context,e,r);break;case 4:c[u].fn.call(c[u].context,e,r,i);break;default:if(!l)for(f=1,l=new Array(h-1);f<h;f++)l[f-1]=arguments[f];c[u].fn.apply(c[u].context,l)}}return!0},s.prototype.on=function(t,e,n){return o(this,t,e,n,!1)},s.prototype.once=function(t,e,n){return o(this,t,e,n,!0)},s.prototype.removeListener=function(t,e,r,i){var o=n?n+t:t;if(!this._events[o])return this;if(!e)return a(this,o),this;var s=this._events[o];if(s.fn)s.fn!==e||i&&!s.once||r&&s.context!==r||a(this,o);else{for(var l=0,u=[],c=s.length;l<c;l++)(s[l].fn!==e||i&&!s[l].once||r&&s[l].context!==r)&&u.push(s[l]);u.length?this._events[o]=1===u.length?u[0]:u:a(this,o)}return this},s.prototype.removeAllListeners=function(t){var e;return t?(e=n?n+t:t,this._events[e]&&a(this,e)):(this._events=new r,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=n,s.EventEmitter=s,t.exports=s}(eventemitter3);var EventEmitter=eventemitter3.exports,eventEmitter=new EventEmitter,BOOT="me.boot",STATE_PAUSE="me.state.onPause",STATE_RESUME="me.state.onResume",STATE_STOP="me.state.onStop",STATE_RESTART="me.state.onRestart",VIDEO_INIT="me.video.onInit",GAME_INIT="me.game.onInit",GAME_RESET="me.game.onReset",GAME_BEFORE_UPDATE="me.game.beforeUpdate",GAME_AFTER_UPDATE="me.game.afterUpdate",GAME_UPDATE="me.game.onUpdate",GAME_BEFORE_DRAW="me.game.beforeDraw",GAME_AFTER_DRAW="me.game.afterDraw",LEVEL_LOADED="me.game.onLevelLoaded",LOADER_COMPLETE="me.loader.onload",LOADER_PROGRESS="me.loader.onProgress",KEYDOWN="me.input.keydown",KEYUP="me.input.keyup",GAMEPAD_CONNECTED="gamepad.connected",GAMEPAD_DISCONNECTED="gamepad.disconnected",GAMEPAD_UPDATE="gamepad.update",POINTERMOVE="me.event.pointermove",POINTERLOCKCHANGE="me.event.pointerlockChange",DRAGSTART="me.game.dragstart",DRAGEND="me.game.dragend",WINDOW_ONRESIZE="globalThis.onresize",CANVAS_ONRESIZE="canvas.onresize",VIEWPORT_ONRESIZE="viewport.onresize",WINDOW_ONORIENTATION_CHANGE="globalThis.orientationchange",WINDOW_ONSCROLL="globalThis.onscroll",VIEWPORT_ONCHANGE="viewport.onchange",ONCONTEXT_LOST="renderer.contextlost",ONCONTEXT_RESTORED="renderer.contextrestored";function emit(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return eventEmitter.emit.apply(eventEmitter,[t].concat(n))}function on(t,e,n){return eventEmitter.on(t,e,n)}function once(t,e,n){return eventEmitter.once(t,e,n)}function off(t,e){return eventEmitter.off(t,e)}var event$1=Object.freeze({__proto__:null,BOOT,STATE_PAUSE,STATE_RESUME,STATE_STOP,STATE_RESTART,VIDEO_INIT,GAME_INIT,GAME_RESET,GAME_BEFORE_UPDATE,GAME_AFTER_UPDATE,GAME_UPDATE,GAME_BEFORE_DRAW,GAME_AFTER_DRAW,LEVEL_LOADED,LOADER_COMPLETE,LOADER_PROGRESS,KEYDOWN,KEYUP,GAMEPAD_CONNECTED,GAMEPAD_DISCONNECTED,GAMEPAD_UPDATE,POINTERMOVE,POINTERLOCKCHANGE,DRAGSTART,DRAGEND,WINDOW_ONRESIZE,CANVAS_ONRESIZE,VIEWPORT_ONRESIZE,WINDOW_ONORIENTATION_CHANGE,WINDOW_ONSCROLL,VIEWPORT_ONCHANGE,ONCONTEXT_LOST,ONCONTEXT_RESTORED,emit,on,once,off}),howler={},exports;exports=howler,function(){var t=function(){this.init()};t.prototype={init:function(){var t=this||e;return t._counter=1e3,t._html5AudioPool=[],t.html5PoolSize=10,t._codecs={},t._howls=[],t._muted=!1,t._volume=1,t._canPlayEvent="canplaythrough",t._navigator="undefined"!=typeof window&&window.navigator?window.navigator:null,t.masterGain=null,t.noAudio=!1,t.usingWebAudio=!0,t.autoSuspend=!0,t.ctx=null,t.autoUnlock=!0,t._setup(),t},volume:function(t){var n=this||e;if(t=parseFloat(t),n.ctx||u(),void 0!==t&&t>=0&&t<=1){if(n._volume=t,n._muted)return n;n.usingWebAudio&&n.masterGain.gain.setValueAtTime(t,e.ctx.currentTime);for(var r=0;r<n._howls.length;r++)if(!n._howls[r]._webAudio)for(var i=n._howls[r]._getSoundIds(),o=0;o<i.length;o++){var a=n._howls[r]._soundById(i[o]);a&&a._node&&(a._node.volume=a._volume*t)}return n}return n._volume},mute:function(t){var n=this||e;n.ctx||u(),n._muted=t,n.usingWebAudio&&n.masterGain.gain.setValueAtTime(t?0:n._volume,e.ctx.currentTime);for(var r=0;r<n._howls.length;r++)if(!n._howls[r]._webAudio)for(var i=n._howls[r]._getSoundIds(),o=0;o<i.length;o++){var a=n._howls[r]._soundById(i[o]);a&&a._node&&(a._node.muted=!!t||a._muted)}return n},stop:function(){for(var t=this||e,n=0;n<t._howls.length;n++)t._howls[n].stop();return t},unload:function(){for(var t=this||e,n=t._howls.length-1;n>=0;n--)t._howls[n].unload();return t.usingWebAudio&&t.ctx&&void 0!==t.ctx.close&&(t.ctx.close(),t.ctx=null,u()),t},codecs:function(t){return(this||e)._codecs[t.replace(/^x-/,"")]},_setup:function(){var t=this||e;if(t.state=t.ctx&&t.ctx.state||"suspended",t._autoSuspend(),!t.usingWebAudio)if("undefined"!=typeof Audio)try{void 0===(new Audio).oncanplaythrough&&(t._canPlayEvent="canplay")}catch(e){t.noAudio=!0}else t.noAudio=!0;try{(new Audio).muted&&(t.noAudio=!0)}catch(t){}return t.noAudio||t._setupCodecs(),t},_setupCodecs:function(){var t=this||e,n=null;try{n="undefined"!=typeof Audio?new Audio:null}catch(e){return t}if(!n||"function"!=typeof n.canPlayType)return t;var r=n.canPlayType("audio/mpeg;").replace(/^no$/,""),i=t._navigator?t._navigator.userAgent:"",o=i.match(/OPR\/([0-6].)/g),a=o&&parseInt(o[0].split("/")[1],10)<33,s=-1!==i.indexOf("Safari")&&-1===i.indexOf("Chrome"),l=i.match(/Version\/(.*?) /),u=s&&l&&parseInt(l[1],10)<15;return t._codecs={mp3:!(a||!r&&!n.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:!!r,opus:!!n.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!n.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!n.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(n.canPlayType('audio/wav; codecs="1"')||n.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!n.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!n.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(n.canPlayType("audio/x-m4a;")||n.canPlayType("audio/m4a;")||n.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(n.canPlayType("audio/x-m4b;")||n.canPlayType("audio/m4b;")||n.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(n.canPlayType("audio/x-mp4;")||n.canPlayType("audio/mp4;")||n.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!(u||!n.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!(u||!n.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!n.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(n.canPlayType("audio/x-flac;")||n.canPlayType("audio/flac;")).replace(/^no$/,"")},t},_unlockAudio:function(){var t=this||e;if(!t._audioUnlocked&&t.ctx){t._audioUnlocked=!1,t.autoUnlock=!1,t._mobileUnloaded||44100===t.ctx.sampleRate||(t._mobileUnloaded=!0,t.unload()),t._scratchBuffer=t.ctx.createBuffer(1,1,22050);var n=function e(n){for(;t._html5AudioPool.length<t.html5PoolSize;)try{var r=new Audio;r._unlocked=!0,t._releaseHtml5Audio(r)}catch(n){t.noAudio=!0;break}for(var i=0;i<t._howls.length;i++)if(!t._howls[i]._webAudio)for(var o=t._howls[i]._getSoundIds(),a=0;a<o.length;a++){var s=t._howls[i]._soundById(o[a]);s&&s._node&&!s._node._unlocked&&(s._node._unlocked=!0,s._node.load())}t._autoResume();var l=t.ctx.createBufferSource();l.buffer=t._scratchBuffer,l.connect(t.ctx.destination),void 0===l.start?l.noteOn(0):l.start(0),"function"==typeof t.ctx.resume&&t.ctx.resume(),l.onended=function(){l.disconnect(0),t._audioUnlocked=!0,document.removeEventListener("touchstart",e,!0),document.removeEventListener("touchend",e,!0),document.removeEventListener("click",e,!0),document.removeEventListener("keydown",e,!0);for(var n=0;n<t._howls.length;n++)t._howls[n]._emit("unlock")}};return document.addEventListener("touchstart",n,!0),document.addEventListener("touchend",n,!0),document.addEventListener("click",n,!0),document.addEventListener("keydown",n,!0),t}},_obtainHtml5Audio:function(){var t=this||e;if(t._html5AudioPool.length)return t._html5AudioPool.pop();var n=(new Audio).play();return n&&"undefined"!=typeof Promise&&(n instanceof Promise||"function"==typeof n.then)&&n.catch((function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")})),new Audio},_releaseHtml5Audio:function(t){var n=this||e;return t._unlocked&&n._html5AudioPool.push(t),n},_autoSuspend:function(){var t=this;if(t.autoSuspend&&t.ctx&&void 0!==t.ctx.suspend&&e.usingWebAudio){for(var n=0;n<t._howls.length;n++)if(t._howls[n]._webAudio)for(var r=0;r<t._howls[n]._sounds.length;r++)if(!t._howls[n]._sounds[r]._paused)return t;return t._suspendTimer&&clearTimeout(t._suspendTimer),t._suspendTimer=setTimeout((function(){if(t.autoSuspend){t._suspendTimer=null,t.state="suspending";var e=function(){t.state="suspended",t._resumeAfterSuspend&&(delete t._resumeAfterSuspend,t._autoResume())};t.ctx.suspend().then(e,e)}}),3e4),t}},_autoResume:function(){var t=this;if(t.ctx&&void 0!==t.ctx.resume&&e.usingWebAudio)return"running"===t.state&&"interrupted"!==t.ctx.state&&t._suspendTimer?(clearTimeout(t._suspendTimer),t._suspendTimer=null):"suspended"===t.state||"running"===t.state&&"interrupted"===t.ctx.state?(t.ctx.resume().then((function(){t.state="running";for(var e=0;e<t._howls.length;e++)t._howls[e]._emit("resume")})),t._suspendTimer&&(clearTimeout(t._suspendTimer),t._suspendTimer=null)):"suspending"===t.state&&(t._resumeAfterSuspend=!0),t}};var e=new t,n=function(t){t.src&&0!==t.src.length?this.init(t):console.error("An array of source files must be passed with any new Howl.")};n.prototype={init:function(t){var n=this;return e.ctx||u(),n._autoplay=t.autoplay||!1,n._format="string"!=typeof t.format?t.format:[t.format],n._html5=t.html5||!1,n._muted=t.mute||!1,n._loop=t.loop||!1,n._pool=t.pool||5,n._preload="boolean"!=typeof t.preload&&"metadata"!==t.preload||t.preload,n._rate=t.rate||1,n._sprite=t.sprite||{},n._src="string"!=typeof t.src?t.src:[t.src],n._volume=void 0!==t.volume?t.volume:1,n._xhr={method:t.xhr&&t.xhr.method?t.xhr.method:"GET",headers:t.xhr&&t.xhr.headers?t.xhr.headers:null,withCredentials:!(!t.xhr||!t.xhr.withCredentials)&&t.xhr.withCredentials},n._duration=0,n._state="unloaded",n._sounds=[],n._endTimers={},n._queue=[],n._playLock=!1,n._onend=t.onend?[{fn:t.onend}]:[],n._onfade=t.onfade?[{fn:t.onfade}]:[],n._onload=t.onload?[{fn:t.onload}]:[],n._onloaderror=t.onloaderror?[{fn:t.onloaderror}]:[],n._onplayerror=t.onplayerror?[{fn:t.onplayerror}]:[],n._onpause=t.onpause?[{fn:t.onpause}]:[],n._onplay=t.onplay?[{fn:t.onplay}]:[],n._onstop=t.onstop?[{fn:t.onstop}]:[],n._onmute=t.onmute?[{fn:t.onmute}]:[],n._onvolume=t.onvolume?[{fn:t.onvolume}]:[],n._onrate=t.onrate?[{fn:t.onrate}]:[],n._onseek=t.onseek?[{fn:t.onseek}]:[],n._onunlock=t.onunlock?[{fn:t.onunlock}]:[],n._onresume=[],n._webAudio=e.usingWebAudio&&!n._html5,void 0!==e.ctx&&e.ctx&&e.autoUnlock&&e._unlockAudio(),e._howls.push(n),n._autoplay&&n._queue.push({event:"play",action:function(){n.play()}}),n._preload&&"none"!==n._preload&&n.load(),n},load:function(){var t=this,n=null;if(e.noAudio)t._emit("loaderror",null,"No audio support.");else{"string"==typeof t._src&&(t._src=[t._src]);for(var i=0;i<t._src.length;i++){var a,s;if(t._format&&t._format[i])a=t._format[i];else{if("string"!=typeof(s=t._src[i])){t._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}(a=/^data:audio\/([^;,]+);/i.exec(s))||(a=/\.([^.]+)$/.exec(s.split("?",1)[0])),a&&(a=a[1].toLowerCase())}if(a||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),a&&e.codecs(a)){n=t._src[i];break}}if(n)return t._src=n,t._state="loading","https:"===window.location.protocol&&"http:"===n.slice(0,5)&&(t._html5=!0,t._webAudio=!1),new r(t),t._webAudio&&o(t),t;t._emit("loaderror",null,"No codec support for selected audio sources.")}},play:function(t,n){var r=this,i=null;if("number"==typeof t)i=t,t=null;else{if("string"==typeof t&&"loaded"===r._state&&!r._sprite[t])return null;if(void 0===t&&(t="__default",!r._playLock)){for(var o=0,a=0;a<r._sounds.length;a++)r._sounds[a]._paused&&!r._sounds[a]._ended&&(o++,i=r._sounds[a]._id);1===o?t=null:i=null}}var s=i?r._soundById(i):r._inactiveSound();if(!s)return null;if(i&&!t&&(t=s._sprite||"__default"),"loaded"!==r._state){s._sprite=t,s._ended=!1;var l=s._id;return r._queue.push({event:"play",action:function(){r.play(l)}}),l}if(i&&!s._paused)return n||r._loadQueue("play"),s._id;r._webAudio&&e._autoResume();var u=Math.max(0,s._seek>0?s._seek:r._sprite[t][0]/1e3),c=Math.max(0,(r._sprite[t][0]+r._sprite[t][1])/1e3-u),h=1e3*c/Math.abs(s._rate),f=r._sprite[t][0]/1e3,d=(r._sprite[t][0]+r._sprite[t][1])/1e3;s._sprite=t,s._ended=!1;var p=function(){s._paused=!1,s._seek=u,s._start=f,s._stop=d,s._loop=!(!s._loop&&!r._sprite[t][2])};if(!(u>=d)){var y=s._node;if(r._webAudio){var v=function(){r._playLock=!1,p(),r._refreshBuffer(s);var t=s._muted||r._muted?0:s._volume;y.gain.setValueAtTime(t,e.ctx.currentTime),s._playStart=e.ctx.currentTime,void 0===y.bufferSource.start?s._loop?y.bufferSource.noteGrainOn(0,u,86400):y.bufferSource.noteGrainOn(0,u,c):s._loop?y.bufferSource.start(0,u,86400):y.bufferSource.start(0,u,c),h!==1/0&&(r._endTimers[s._id]=setTimeout(r._ended.bind(r,s),h)),n||setTimeout((function(){r._emit("play",s._id),r._loadQueue()}),0)};"running"===e.state&&"interrupted"!==e.ctx.state?v():(r._playLock=!0,r.once("resume",v),r._clearTimer(s._id))}else{var g=function(){y.currentTime=u,y.muted=s._muted||r._muted||e._muted||y.muted,y.volume=s._volume*e.volume(),y.playbackRate=s._rate;try{var i=y.play();if(i&&"undefined"!=typeof Promise&&(i instanceof Promise||"function"==typeof i.then)?(r._playLock=!0,p(),i.then((function(){r._playLock=!1,y._unlocked=!0,n?r._loadQueue():r._emit("play",s._id)})).catch((function(){r._playLock=!1,r._emit("playerror",s._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),s._ended=!0,s._paused=!0}))):n||(r._playLock=!1,p(),r._emit("play",s._id)),y.playbackRate=s._rate,y.paused)return void r._emit("playerror",s._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");"__default"!==t||s._loop?r._endTimers[s._id]=setTimeout(r._ended.bind(r,s),h):(r._endTimers[s._id]=function(){r._ended(s),y.removeEventListener("ended",r._endTimers[s._id],!1)},y.addEventListener("ended",r._endTimers[s._id],!1))}catch(t){r._emit("playerror",s._id,t)}};"data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"===y.src&&(y.src=r._src,y.load());var m=window&&window.ejecta||!y.readyState&&e._navigator.isCocoonJS;y.readyState>=3||m?g():(r._playLock=!0,r._state="loading",y.addEventListener(e._canPlayEvent,(function t(){r._state="loaded",g(),y.removeEventListener(e._canPlayEvent,t,!1)}),!1),r._clearTimer(s._id))}return s._id}r._ended(s)},pause:function(t){var e=this;if("loaded"!==e._state||e._playLock)return e._queue.push({event:"pause",action:function(){e.pause(t)}}),e;for(var n=e._getSoundIds(t),r=0;r<n.length;r++){e._clearTimer(n[r]);var i=e._soundById(n[r]);if(i&&!i._paused&&(i._seek=e.seek(n[r]),i._rateSeek=0,i._paused=!0,e._stopFade(n[r]),i._node))if(e._webAudio){if(!i._node.bufferSource)continue;void 0===i._node.bufferSource.stop?i._node.bufferSource.noteOff(0):i._node.bufferSource.stop(0),e._cleanBuffer(i._node)}else isNaN(i._node.duration)&&i._node.duration!==1/0||i._node.pause();arguments[1]||e._emit("pause",i?i._id:null)}return e},stop:function(t,e){var n=this;if("loaded"!==n._state||n._playLock)return n._queue.push({event:"stop",action:function(){n.stop(t)}}),n;for(var r=n._getSoundIds(t),i=0;i<r.length;i++){n._clearTimer(r[i]);var o=n._soundById(r[i]);o&&(o._seek=o._start||0,o._rateSeek=0,o._paused=!0,o._ended=!0,n._stopFade(r[i]),o._node&&(n._webAudio?o._node.bufferSource&&(void 0===o._node.bufferSource.stop?o._node.bufferSource.noteOff(0):o._node.bufferSource.stop(0),n._cleanBuffer(o._node)):isNaN(o._node.duration)&&o._node.duration!==1/0||(o._node.currentTime=o._start||0,o._node.pause(),o._node.duration===1/0&&n._clearSound(o._node))),e||n._emit("stop",o._id))}return n},mute:function(t,n){var r=this;if("loaded"!==r._state||r._playLock)return r._queue.push({event:"mute",action:function(){r.mute(t,n)}}),r;if(void 0===n){if("boolean"!=typeof t)return r._muted;r._muted=t}for(var i=r._getSoundIds(n),o=0;o<i.length;o++){var a=r._soundById(i[o]);a&&(a._muted=t,a._interval&&r._stopFade(a._id),r._webAudio&&a._node?a._node.gain.setValueAtTime(t?0:a._volume,e.ctx.currentTime):a._node&&(a._node.muted=!!e._muted||t),r._emit("mute",a._id))}return r},volume:function(){var t,n,r,i=this,o=arguments;if(0===o.length)return i._volume;if(1===o.length||2===o.length&&void 0===o[1]){var a=i._getSoundIds(),s=a.indexOf(o[0]);s>=0?n=parseInt(o[0],10):t=parseFloat(o[0])}else o.length>=2&&(t=parseFloat(o[0]),n=parseInt(o[1],10));if(!(void 0!==t&&t>=0&&t<=1))return(r=n?i._soundById(n):i._sounds[0])?r._volume:0;if("loaded"!==i._state||i._playLock)return i._queue.push({event:"volume",action:function(){i.volume.apply(i,o)}}),i;void 0===n&&(i._volume=t),n=i._getSoundIds(n);for(var l=0;l<n.length;l++)(r=i._soundById(n[l]))&&(r._volume=t,o[2]||i._stopFade(n[l]),i._webAudio&&r._node&&!r._muted?r._node.gain.setValueAtTime(t,e.ctx.currentTime):r._node&&!r._muted&&(r._node.volume=t*e.volume()),i._emit("volume",r._id));return i},fade:function(t,n,r,i){var o=this;if("loaded"!==o._state||o._playLock)return o._queue.push({event:"fade",action:function(){o.fade(t,n,r,i)}}),o;t=Math.min(Math.max(0,parseFloat(t)),1),n=Math.min(Math.max(0,parseFloat(n)),1),r=parseFloat(r),o.volume(t,i);for(var a=o._getSoundIds(i),s=0;s<a.length;s++){var l=o._soundById(a[s]);if(l){if(i||o._stopFade(a[s]),o._webAudio&&!l._muted){var u=e.ctx.currentTime,c=u+r/1e3;l._volume=t,l._node.gain.setValueAtTime(t,u),l._node.gain.linearRampToValueAtTime(n,c)}o._startFadeInterval(l,t,n,r,a[s],void 0===i)}}return o},_startFadeInterval:function(t,e,n,r,i,o){var a=this,s=e,l=n-e,u=Math.abs(l/.01),c=Math.max(4,u>0?r/u:r),h=Date.now();t._fadeTo=n,t._interval=setInterval((function(){var i=(Date.now()-h)/r;h=Date.now(),s+=l*i,s=Math.round(100*s)/100,s=l<0?Math.max(n,s):Math.min(n,s),a._webAudio?t._volume=s:a.volume(s,t._id,!0),o&&(a._volume=s),(n<e&&s<=n||n>e&&s>=n)&&(clearInterval(t._interval),t._interval=null,t._fadeTo=null,a.volume(n,t._id),a._emit("fade",t._id))}),c)},_stopFade:function(t){var n=this,r=n._soundById(t);return r&&r._interval&&(n._webAudio&&r._node.gain.cancelScheduledValues(e.ctx.currentTime),clearInterval(r._interval),r._interval=null,n.volume(r._fadeTo,t),r._fadeTo=null,n._emit("fade",t)),n},loop:function(){var t,e,n,r=this,i=arguments;if(0===i.length)return r._loop;if(1===i.length){if("boolean"!=typeof i[0])return!!(n=r._soundById(parseInt(i[0],10)))&&n._loop;t=i[0],r._loop=t}else 2===i.length&&(t=i[0],e=parseInt(i[1],10));for(var o=r._getSoundIds(e),a=0;a<o.length;a++)(n=r._soundById(o[a]))&&(n._loop=t,r._webAudio&&n._node&&n._node.bufferSource&&(n._node.bufferSource.loop=t,t&&(n._node.bufferSource.loopStart=n._start||0,n._node.bufferSource.loopEnd=n._stop,r.playing(o[a])&&(r.pause(o[a],!0),r.play(o[a],!0)))));return r},rate:function(){var t,n,r,i=this,o=arguments;if(0===o.length)n=i._sounds[0]._id;else if(1===o.length){var a=i._getSoundIds(),s=a.indexOf(o[0]);s>=0?n=parseInt(o[0],10):t=parseFloat(o[0])}else 2===o.length&&(t=parseFloat(o[0]),n=parseInt(o[1],10));if("number"!=typeof t)return(r=i._soundById(n))?r._rate:i._rate;if("loaded"!==i._state||i._playLock)return i._queue.push({event:"rate",action:function(){i.rate.apply(i,o)}}),i;void 0===n&&(i._rate=t),n=i._getSoundIds(n);for(var l=0;l<n.length;l++)if(r=i._soundById(n[l])){i.playing(n[l])&&(r._rateSeek=i.seek(n[l]),r._playStart=i._webAudio?e.ctx.currentTime:r._playStart),r._rate=t,i._webAudio&&r._node&&r._node.bufferSource?r._node.bufferSource.playbackRate.setValueAtTime(t,e.ctx.currentTime):r._node&&(r._node.playbackRate=t);var u=i.seek(n[l]),c=(i._sprite[r._sprite][0]+i._sprite[r._sprite][1])/1e3-u,h=1e3*c/Math.abs(r._rate);!i._endTimers[n[l]]&&r._paused||(i._clearTimer(n[l]),i._endTimers[n[l]]=setTimeout(i._ended.bind(i,r),h)),i._emit("rate",r._id)}return i},seek:function(){var t,n,r=this,i=arguments;if(0===i.length)r._sounds.length&&(n=r._sounds[0]._id);else if(1===i.length){var o=r._getSoundIds(),a=o.indexOf(i[0]);a>=0?n=parseInt(i[0],10):r._sounds.length&&(n=r._sounds[0]._id,t=parseFloat(i[0]))}else 2===i.length&&(t=parseFloat(i[0]),n=parseInt(i[1],10));if(void 0===n)return 0;if("number"==typeof t&&("loaded"!==r._state||r._playLock))return r._queue.push({event:"seek",action:function(){r.seek.apply(r,i)}}),r;var s=r._soundById(n);if(s){if(!("number"==typeof t&&t>=0)){if(r._webAudio){var l=r.playing(n)?e.ctx.currentTime-s._playStart:0,u=s._rateSeek?s._rateSeek-s._seek:0;return s._seek+(u+l*Math.abs(s._rate))}return s._node.currentTime}var c=r.playing(n);c&&r.pause(n,!0),s._seek=t,s._ended=!1,r._clearTimer(n),r._webAudio||!s._node||isNaN(s._node.duration)||(s._node.currentTime=t);var h=function(){c&&r.play(n,!0),r._emit("seek",n)};if(c&&!r._webAudio){var f=function t(){r._playLock?setTimeout(t,0):h()};setTimeout(f,0)}else h()}return r},playing:function(t){var e=this;if("number"==typeof t){var n=e._soundById(t);return!!n&&!n._paused}for(var r=0;r<e._sounds.length;r++)if(!e._sounds[r]._paused)return!0;return!1},duration:function(t){var e=this,n=e._duration,r=e._soundById(t);return r&&(n=e._sprite[r._sprite][1]/1e3),n},state:function(){return this._state},unload:function(){for(var t=this,n=t._sounds,r=0;r<n.length;r++)n[r]._paused||t.stop(n[r]._id),t._webAudio||(t._clearSound(n[r]._node),n[r]._node.removeEventListener("error",n[r]._errorFn,!1),n[r]._node.removeEventListener(e._canPlayEvent,n[r]._loadFn,!1),n[r]._node.removeEventListener("ended",n[r]._endFn,!1),e._releaseHtml5Audio(n[r]._node)),delete n[r]._node,t._clearTimer(n[r]._id);var o=e._howls.indexOf(t);o>=0&&e._howls.splice(o,1);var a=!0;for(r=0;r<e._howls.length;r++)if(e._howls[r]._src===t._src||t._src.indexOf(e._howls[r]._src)>=0){a=!1;break}return i&&a&&delete i[t._src],e.noAudio=!1,t._state="unloaded",t._sounds=[],t=null,null},on:function(t,e,n,r){var i=this["_on"+t];return"function"==typeof e&&i.push(r?{id:n,fn:e,once:r}:{id:n,fn:e}),this},off:function(t,e,n){var r=this,i=r["_on"+t],o=0;if("number"==typeof e&&(n=e,e=null),e||n)for(o=0;o<i.length;o++){var a=n===i[o].id;if(e===i[o].fn&&a||!e&&a){i.splice(o,1);break}}else if(t)r["_on"+t]=[];else{var s=Object.keys(r);for(o=0;o<s.length;o++)0===s[o].indexOf("_on")&&Array.isArray(r[s[o]])&&(r[s[o]]=[])}return r},once:function(t,e,n){return this.on(t,e,n,1),this},_emit:function(t,e,n){for(var r=this,i=r["_on"+t],o=i.length-1;o>=0;o--)i[o].id&&i[o].id!==e&&"load"!==t||(setTimeout(function(t){t.call(this,e,n)}.bind(r,i[o].fn),0),i[o].once&&r.off(t,i[o].fn,i[o].id));return r._loadQueue(t),r},_loadQueue:function(t){var e=this;if(e._queue.length>0){var n=e._queue[0];n.event===t&&(e._queue.shift(),e._loadQueue()),t||n.action()}return e},_ended:function(t){var n=this,r=t._sprite;if(!n._webAudio&&t._node&&!t._node.paused&&!t._node.ended&&t._node.currentTime<t._stop)return setTimeout(n._ended.bind(n,t),100),n;var i=!(!t._loop&&!n._sprite[r][2]);if(n._emit("end",t._id),!n._webAudio&&i&&n.stop(t._id,!0).play(t._id),n._webAudio&&i){n._emit("play",t._id),t._seek=t._start||0,t._rateSeek=0,t._playStart=e.ctx.currentTime;var o=1e3*(t._stop-t._start)/Math.abs(t._rate);n._endTimers[t._id]=setTimeout(n._ended.bind(n,t),o)}return n._webAudio&&!i&&(t._paused=!0,t._ended=!0,t._seek=t._start||0,t._rateSeek=0,n._clearTimer(t._id),n._cleanBuffer(t._node),e._autoSuspend()),n._webAudio||i||n.stop(t._id,!0),n},_clearTimer:function(t){var e=this;if(e._endTimers[t]){if("function"!=typeof e._endTimers[t])clearTimeout(e._endTimers[t]);else{var n=e._soundById(t);n&&n._node&&n._node.removeEventListener("ended",e._endTimers[t],!1)}delete e._endTimers[t]}return e},_soundById:function(t){for(var e=this,n=0;n<e._sounds.length;n++)if(t===e._sounds[n]._id)return e._sounds[n];return null},_inactiveSound:function(){var t=this;t._drain();for(var e=0;e<t._sounds.length;e++)if(t._sounds[e]._ended)return t._sounds[e].reset();return new r(t)},_drain:function(){var t=this,e=t._pool,n=0,r=0;if(!(t._sounds.length<e)){for(r=0;r<t._sounds.length;r++)t._sounds[r]._ended&&n++;for(r=t._sounds.length-1;r>=0;r--){if(n<=e)return;t._sounds[r]._ended&&(t._webAudio&&t._sounds[r]._node&&t._sounds[r]._node.disconnect(0),t._sounds.splice(r,1),n--)}}},_getSoundIds:function(t){if(void 0===t){for(var e=[],n=0;n<this._sounds.length;n++)e.push(this._sounds[n]._id);return e}return[t]},_refreshBuffer:function(t){return t._node.bufferSource=e.ctx.createBufferSource(),t._node.bufferSource.buffer=i[this._src],t._panner?t._node.bufferSource.connect(t._panner):t._node.bufferSource.connect(t._node),t._node.bufferSource.loop=t._loop,t._loop&&(t._node.bufferSource.loopStart=t._start||0,t._node.bufferSource.loopEnd=t._stop||0),t._node.bufferSource.playbackRate.setValueAtTime(t._rate,e.ctx.currentTime),this},_cleanBuffer:function(t){var n=e._navigator&&e._navigator.vendor.indexOf("Apple")>=0;if(e._scratchBuffer&&t.bufferSource&&(t.bufferSource.onended=null,t.bufferSource.disconnect(0),n))try{t.bufferSource.buffer=e._scratchBuffer}catch(t){}return t.bufferSource=null,this},_clearSound:function(t){/MSIE |Trident\//.test(e._navigator&&e._navigator.userAgent)||(t.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var r=function(t){this._parent=t,this.init()};r.prototype={init:function(){var t=this,n=t._parent;return t._muted=n._muted,t._loop=n._loop,t._volume=n._volume,t._rate=n._rate,t._seek=0,t._paused=!0,t._ended=!0,t._sprite="__default",t._id=++e._counter,n._sounds.push(t),t.create(),t},create:function(){var t=this,n=t._parent,r=e._muted||t._muted||t._parent._muted?0:t._volume;return n._webAudio?(t._node=void 0===e.ctx.createGain?e.ctx.createGainNode():e.ctx.createGain(),t._node.gain.setValueAtTime(r,e.ctx.currentTime),t._node.paused=!0,t._node.connect(e.masterGain)):e.noAudio||(t._node=e._obtainHtml5Audio(),t._errorFn=t._errorListener.bind(t),t._node.addEventListener("error",t._errorFn,!1),t._loadFn=t._loadListener.bind(t),t._node.addEventListener(e._canPlayEvent,t._loadFn,!1),t._endFn=t._endListener.bind(t),t._node.addEventListener("ended",t._endFn,!1),t._node.src=n._src,t._node.preload=!0===n._preload?"auto":n._preload,t._node.volume=r*e.volume(),t._node.load()),t},reset:function(){var t=this,n=t._parent;return t._muted=n._muted,t._loop=n._loop,t._volume=n._volume,t._rate=n._rate,t._seek=0,t._rateSeek=0,t._paused=!0,t._ended=!0,t._sprite="__default",t._id=++e._counter,t},_errorListener:function(){var t=this;t._parent._emit("loaderror",t._id,t._node.error?t._node.error.code:0),t._node.removeEventListener("error",t._errorFn,!1)},_loadListener:function(){var t=this,n=t._parent;n._duration=Math.ceil(10*t._node.duration)/10,0===Object.keys(n._sprite).length&&(n._sprite={__default:[0,1e3*n._duration]}),"loaded"!==n._state&&(n._state="loaded",n._emit("load"),n._loadQueue()),t._node.removeEventListener(e._canPlayEvent,t._loadFn,!1)},_endListener:function(){var t=this,e=t._parent;e._duration===1/0&&(e._duration=Math.ceil(10*t._node.duration)/10,e._sprite.__default[1]===1/0&&(e._sprite.__default[1]=1e3*e._duration),e._ended(t)),t._node.removeEventListener("ended",t._endFn,!1)}};var i={},o=function(t){var e=t._src;if(i[e])return t._duration=i[e].duration,void l(t);if(/^data:[^;]+;base64,/.test(e)){for(var n=atob(e.split(",")[1]),r=new Uint8Array(n.length),o=0;o<n.length;++o)r[o]=n.charCodeAt(o);s(r.buffer,t)}else{var u=new XMLHttpRequest;u.open(t._xhr.method,e,!0),u.withCredentials=t._xhr.withCredentials,u.responseType="arraybuffer",t._xhr.headers&&Object.keys(t._xhr.headers).forEach((function(e){u.setRequestHeader(e,t._xhr.headers[e])})),u.onload=function(){var e=(u.status+"")[0];"0"===e||"2"===e||"3"===e?s(u.response,t):t._emit("loaderror",null,"Failed loading audio file with status: "+u.status+".")},u.onerror=function(){t._webAudio&&(t._html5=!0,t._webAudio=!1,t._sounds=[],delete i[e],t.load())},a(u)}},a=function(t){try{t.send()}catch(e){t.onerror()}},s=function(t,n){var r=function(){n._emit("loaderror",null,"Decoding audio data failed.")},o=function(t){t&&n._sounds.length>0?(i[n._src]=t,l(n,t)):r()};"undefined"!=typeof Promise&&1===e.ctx.decodeAudioData.length?e.ctx.decodeAudioData(t).then(o).catch(r):e.ctx.decodeAudioData(t,o,r)},l=function(t,e){e&&!t._duration&&(t._duration=e.duration),0===Object.keys(t._sprite).length&&(t._sprite={__default:[0,1e3*t._duration]}),"loaded"!==t._state&&(t._state="loaded",t._emit("load"),t._loadQueue())},u=function(){if(e.usingWebAudio){try{"undefined"!=typeof AudioContext?e.ctx=new AudioContext:"undefined"!=typeof webkitAudioContext?e.ctx=new webkitAudioContext:e.usingWebAudio=!1}catch(t){e.usingWebAudio=!1}e.ctx||(e.usingWebAudio=!1);var t=/iP(hone|od|ad)/.test(e._navigator&&e._navigator.platform),n=e._navigator&&e._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),r=n?parseInt(n[1],10):null;if(t&&r&&r<9){var i=/safari/.test(e._navigator&&e._navigator.userAgent.toLowerCase());e._navigator&&!i&&(e.usingWebAudio=!1)}e.usingWebAudio&&(e.masterGain=void 0===e.ctx.createGain?e.ctx.createGainNode():e.ctx.createGain(),e.masterGain.gain.setValueAtTime(e._muted?0:e._volume,e.ctx.currentTime),e.masterGain.connect(e.ctx.destination)),e._setup()}};exports.Howler=e,exports.Howl=n,void 0!==commonjsGlobal?(commonjsGlobal.HowlerGlobal=t,commonjsGlobal.Howler=e,commonjsGlobal.Howl=n,commonjsGlobal.Sound=r):"undefined"!=typeof window&&(window.HowlerGlobal=t,window.Howler=e,window.Howl=n,window.Sound=r)}(),function(){var t;HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(t){var e=this;if(!e.ctx||!e.ctx.listener)return e;for(var n=e._howls.length-1;n>=0;n--)e._howls[n].stereo(t);return e},HowlerGlobal.prototype.pos=function(t,e,n){var r=this;return r.ctx&&r.ctx.listener?(e="number"!=typeof e?r._pos[1]:e,n="number"!=typeof n?r._pos[2]:n,"number"!=typeof t?r._pos:(r._pos=[t,e,n],void 0!==r.ctx.listener.positionX?(r.ctx.listener.positionX.setTargetAtTime(r._pos[0],Howler.ctx.currentTime,.1),r.ctx.listener.positionY.setTargetAtTime(r._pos[1],Howler.ctx.currentTime,.1),r.ctx.listener.positionZ.setTargetAtTime(r._pos[2],Howler.ctx.currentTime,.1)):r.ctx.listener.setPosition(r._pos[0],r._pos[1],r._pos[2]),r)):r},HowlerGlobal.prototype.orientation=function(t,e,n,r,i,o){var a=this;if(!a.ctx||!a.ctx.listener)return a;var s=a._orientation;return e="number"!=typeof e?s[1]:e,n="number"!=typeof n?s[2]:n,r="number"!=typeof r?s[3]:r,i="number"!=typeof i?s[4]:i,o="number"!=typeof o?s[5]:o,"number"!=typeof t?s:(a._orientation=[t,e,n,r,i,o],void 0!==a.ctx.listener.forwardX?(a.ctx.listener.forwardX.setTargetAtTime(t,Howler.ctx.currentTime,.1),a.ctx.listener.forwardY.setTargetAtTime(e,Howler.ctx.currentTime,.1),a.ctx.listener.forwardZ.setTargetAtTime(n,Howler.ctx.currentTime,.1),a.ctx.listener.upX.setTargetAtTime(r,Howler.ctx.currentTime,.1),a.ctx.listener.upY.setTargetAtTime(i,Howler.ctx.currentTime,.1),a.ctx.listener.upZ.setTargetAtTime(o,Howler.ctx.currentTime,.1)):a.ctx.listener.setOrientation(t,e,n,r,i,o),a)},Howl.prototype.init=(t=Howl.prototype.init,function(e){var n=this;return n._orientation=e.orientation||[1,0,0],n._stereo=e.stereo||null,n._pos=e.pos||null,n._pannerAttr={coneInnerAngle:void 0!==e.coneInnerAngle?e.coneInnerAngle:360,coneOuterAngle:void 0!==e.coneOuterAngle?e.coneOuterAngle:360,coneOuterGain:void 0!==e.coneOuterGain?e.coneOuterGain:0,distanceModel:void 0!==e.distanceModel?e.distanceModel:"inverse",maxDistance:void 0!==e.maxDistance?e.maxDistance:1e4,panningModel:void 0!==e.panningModel?e.panningModel:"HRTF",refDistance:void 0!==e.refDistance?e.refDistance:1,rolloffFactor:void 0!==e.rolloffFactor?e.rolloffFactor:1},n._onstereo=e.onstereo?[{fn:e.onstereo}]:[],n._onpos=e.onpos?[{fn:e.onpos}]:[],n._onorientation=e.onorientation?[{fn:e.onorientation}]:[],t.call(this,e)}),Howl.prototype.stereo=function(t,n){var r=this;if(!r._webAudio)return r;if("loaded"!==r._state)return r._queue.push({event:"stereo",action:function(){r.stereo(t,n)}}),r;var i=void 0===Howler.ctx.createStereoPanner?"spatial":"stereo";if(void 0===n){if("number"!=typeof t)return r._stereo;r._stereo=t,r._pos=[t,0,0]}for(var o=r._getSoundIds(n),a=0;a<o.length;a++){var s=r._soundById(o[a]);if(s){if("number"!=typeof t)return s._stereo;s._stereo=t,s._pos=[t,0,0],s._node&&(s._pannerAttr.panningModel="equalpower",s._panner&&s._panner.pan||e(s,i),"spatial"===i?void 0!==s._panner.positionX?(s._panner.positionX.setValueAtTime(t,Howler.ctx.currentTime),s._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),s._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):s._panner.setPosition(t,0,0):s._panner.pan.setValueAtTime(t,Howler.ctx.currentTime)),r._emit("stereo",s._id)}}return r},Howl.prototype.pos=function(t,n,r,i){var o=this;if(!o._webAudio)return o;if("loaded"!==o._state)return o._queue.push({event:"pos",action:function(){o.pos(t,n,r,i)}}),o;if(n="number"!=typeof n?0:n,r="number"!=typeof r?-.5:r,void 0===i){if("number"!=typeof t)return o._pos;o._pos=[t,n,r]}for(var a=o._getSoundIds(i),s=0;s<a.length;s++){var l=o._soundById(a[s]);if(l){if("number"!=typeof t)return l._pos;l._pos=[t,n,r],l._node&&(l._panner&&!l._panner.pan||e(l,"spatial"),void 0!==l._panner.positionX?(l._panner.positionX.setValueAtTime(t,Howler.ctx.currentTime),l._panner.positionY.setValueAtTime(n,Howler.ctx.currentTime),l._panner.positionZ.setValueAtTime(r,Howler.ctx.currentTime)):l._panner.setPosition(t,n,r)),o._emit("pos",l._id)}}return o},Howl.prototype.orientation=function(t,n,r,i){var o=this;if(!o._webAudio)return o;if("loaded"!==o._state)return o._queue.push({event:"orientation",action:function(){o.orientation(t,n,r,i)}}),o;if(n="number"!=typeof n?o._orientation[1]:n,r="number"!=typeof r?o._orientation[2]:r,void 0===i){if("number"!=typeof t)return o._orientation;o._orientation=[t,n,r]}for(var a=o._getSoundIds(i),s=0;s<a.length;s++){var l=o._soundById(a[s]);if(l){if("number"!=typeof t)return l._orientation;l._orientation=[t,n,r],l._node&&(l._panner||(l._pos||(l._pos=o._pos||[0,0,-.5]),e(l,"spatial")),void 0!==l._panner.orientationX?(l._panner.orientationX.setValueAtTime(t,Howler.ctx.currentTime),l._panner.orientationY.setValueAtTime(n,Howler.ctx.currentTime),l._panner.orientationZ.setValueAtTime(r,Howler.ctx.currentTime)):l._panner.setOrientation(t,n,r)),o._emit("orientation",l._id)}}return o},Howl.prototype.pannerAttr=function(){var t,n,r,i=this,o=arguments;if(!i._webAudio)return i;if(0===o.length)return i._pannerAttr;if(1===o.length){if("object"!==_typeof(o[0]))return(r=i._soundById(parseInt(o[0],10)))?r._pannerAttr:i._pannerAttr;t=o[0],void 0===n&&(t.pannerAttr||(t.pannerAttr={coneInnerAngle:t.coneInnerAngle,coneOuterAngle:t.coneOuterAngle,coneOuterGain:t.coneOuterGain,distanceModel:t.distanceModel,maxDistance:t.maxDistance,refDistance:t.refDistance,rolloffFactor:t.rolloffFactor,panningModel:t.panningModel}),i._pannerAttr={coneInnerAngle:void 0!==t.pannerAttr.coneInnerAngle?t.pannerAttr.coneInnerAngle:i._coneInnerAngle,coneOuterAngle:void 0!==t.pannerAttr.coneOuterAngle?t.pannerAttr.coneOuterAngle:i._coneOuterAngle,coneOuterGain:void 0!==t.pannerAttr.coneOuterGain?t.pannerAttr.coneOuterGain:i._coneOuterGain,distanceModel:void 0!==t.pannerAttr.distanceModel?t.pannerAttr.distanceModel:i._distanceModel,maxDistance:void 0!==t.pannerAttr.maxDistance?t.pannerAttr.maxDistance:i._maxDistance,refDistance:void 0!==t.pannerAttr.refDistance?t.pannerAttr.refDistance:i._refDistance,rolloffFactor:void 0!==t.pannerAttr.rolloffFactor?t.pannerAttr.rolloffFactor:i._rolloffFactor,panningModel:void 0!==t.pannerAttr.panningModel?t.pannerAttr.panningModel:i._panningModel})}else 2===o.length&&(t=o[0],n=parseInt(o[1],10));for(var a=i._getSoundIds(n),s=0;s<a.length;s++)if(r=i._soundById(a[s])){var l=r._pannerAttr;l={coneInnerAngle:void 0!==t.coneInnerAngle?t.coneInnerAngle:l.coneInnerAngle,coneOuterAngle:void 0!==t.coneOuterAngle?t.coneOuterAngle:l.coneOuterAngle,coneOuterGain:void 0!==t.coneOuterGain?t.coneOuterGain:l.coneOuterGain,distanceModel:void 0!==t.distanceModel?t.distanceModel:l.distanceModel,maxDistance:void 0!==t.maxDistance?t.maxDistance:l.maxDistance,refDistance:void 0!==t.refDistance?t.refDistance:l.refDistance,rolloffFactor:void 0!==t.rolloffFactor?t.rolloffFactor:l.rolloffFactor,panningModel:void 0!==t.panningModel?t.panningModel:l.panningModel};var u=r._panner;u?(u.coneInnerAngle=l.coneInnerAngle,u.coneOuterAngle=l.coneOuterAngle,u.coneOuterGain=l.coneOuterGain,u.distanceModel=l.distanceModel,u.maxDistance=l.maxDistance,u.refDistance=l.refDistance,u.rolloffFactor=l.rolloffFactor,u.panningModel=l.panningModel):(r._pos||(r._pos=i._pos||[0,0,-.5]),e(r,"spatial"))}return i},Sound.prototype.init=function(t){return function(){var e=this,n=e._parent;e._orientation=n._orientation,e._stereo=n._stereo,e._pos=n._pos,e._pannerAttr=n._pannerAttr,t.call(this),e._stereo?n.stereo(e._stereo):e._pos&&n.pos(e._pos[0],e._pos[1],e._pos[2],e._id)}}(Sound.prototype.init),Sound.prototype.reset=function(t){return function(){var e=this,n=e._parent;return e._orientation=n._orientation,e._stereo=n._stereo,e._pos=n._pos,e._pannerAttr=n._pannerAttr,e._stereo?n.stereo(e._stereo):e._pos?n.pos(e._pos[0],e._pos[1],e._pos[2],e._id):e._panner&&(e._panner.disconnect(0),e._panner=void 0,n._refreshBuffer(e)),t.call(this)}}(Sound.prototype.reset);var e=function(t,e){"spatial"===(e=e||"spatial")?(t._panner=Howler.ctx.createPanner(),t._panner.coneInnerAngle=t._pannerAttr.coneInnerAngle,t._panner.coneOuterAngle=t._pannerAttr.coneOuterAngle,t._panner.coneOuterGain=t._pannerAttr.coneOuterGain,t._panner.distanceModel=t._pannerAttr.distanceModel,t._panner.maxDistance=t._pannerAttr.maxDistance,t._panner.refDistance=t._pannerAttr.refDistance,t._panner.rolloffFactor=t._pannerAttr.rolloffFactor,t._panner.panningModel=t._pannerAttr.panningModel,void 0!==t._panner.positionX?(t._panner.positionX.setValueAtTime(t._pos[0],Howler.ctx.currentTime),t._panner.positionY.setValueAtTime(t._pos[1],Howler.ctx.currentTime),t._panner.positionZ.setValueAtTime(t._pos[2],Howler.ctx.currentTime)):t._panner.setPosition(t._pos[0],t._pos[1],t._pos[2]),void 0!==t._panner.orientationX?(t._panner.orientationX.setValueAtTime(t._orientation[0],Howler.ctx.currentTime),t._panner.orientationY.setValueAtTime(t._orientation[1],Howler.ctx.currentTime),t._panner.orientationZ.setValueAtTime(t._orientation[2],Howler.ctx.currentTime)):t._panner.setOrientation(t._orientation[0],t._orientation[1],t._orientation[2])):(t._panner=Howler.ctx.createStereoPanner(),t._panner.pan.setValueAtTime(t._stereo,Howler.ctx.currentTime)),t._panner.connect(t._node),t._paused||t._parent.pause(t._id,!0).play(t._id,!0)}}();var ObservableVector2d=function(t){_inherits(n,t);var e=_createSuper(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2?arguments[2]:void 0;if(_classCallCheck(this,n),t=e.call(this,r,i),void 0===o)throw new Error("undefined `onUpdate` callback");return t.setCallback(o.onUpdate,o.scope),t}return _createClass(n,[{key:"onResetEvent",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0;return this.setMuted(t,e),void 0!==n&&this.setCallback(n.onUpdate,n.scope),this}},{key:"x",get:function(){return this._x},set:function(t){var e=this.onUpdate.call(this.scope,t,this._y,this._x,this._y);this._x=e&&"x"in e?e.x:t}},{key:"y",get:function(){return this._y},set:function(t){var e=this.onUpdate.call(this.scope,this._x,t,this._x,this._y);this._y=e&&"y"in e?e.y:t}},{key:"_set",value:function(t,e){var n=this.onUpdate.call(this.scope,t,e,this._x,this._y);return n&&"x"in n&&"y"in n?(this._x=n.x,this._y=n.y):(this._x=t,this._y=e),this}},{key:"setMuted",value:function(t,e){return this._x=t,this._y=e,this}},{key:"setCallback",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if("function"!=typeof t)throw new Error("invalid `onUpdate` callback");return this.onUpdate=t,this.scope=e,this}},{key:"add",value:function(t){return this._set(this._x+t.x,this._y+t.y)}},{key:"sub",value:function(t){return this._set(this._x-t.x,this._y-t.y)}},{key:"scale",value:function(t,e){return this._set(this._x*t,this._y*(void 0!==e?e:t))}},{key:"scaleV",value:function(t){return this._set(this._x*t.x,this._y*t.y)}},{key:"div",value:function(t){return this._set(this._x/t,this._y/t)}},{key:"abs",value:function(){return this._set(this._x<0?-this._x:this._x,this._y<0?-this._y:this._y)}},{key:"clamp",value:function(t,e){return new n(_clamp(this.x,t,e),_clamp(this.y,t,e),{onUpdate:this.onUpdate,scope:this.scope})}},{key:"clampSelf",value:function(t,e){return this._set(_clamp(this._x,t,e),_clamp(this._y,t,e))}},{key:"minV",value:function(t){return this._set(this._x<t.x?this._x:t.x,this._y<t.y?this._y:t.y)}},{key:"maxV",value:function(t){return this._set(this._x>t.x?this._x:t.x,this._y>t.y?this._y:t.y)}},{key:"floor",value:function(){return new n(Math.floor(this._x),Math.floor(this._y),{onUpdate:this.onUpdate,scope:this.scope})}},{key:"floorSelf",value:function(){return this._set(Math.floor(this._x),Math.floor(this._y))}},{key:"ceil",value:function(){return new n(Math.ceil(this._x),Math.ceil(this._y),{onUpdate:this.onUpdate,scope:this.scope})}},{key:"ceilSelf",value:function(){return this._set(Math.ceil(this._x),Math.ceil(this._y))}},{key:"negate",value:function(){return new n(-this._x,-this._y,{onUpdate:this.onUpdate,scope:this.scope})}},{key:"negateSelf",value:function(){return this._set(-this._x,-this._y)}},{key:"copy",value:function(t){return this._set(t.x,t.y)}},{key:"equals",value:function(t){return this._x===t.x&&this._y===t.y}},{key:"perp",value:function(){return this._set(this._y,-this._x)}},{key:"rotate",value:function(t,e){var n=0,r=0;"object"===_typeof(e)&&(n=e.x,r=e.y);var i=this._x-n,o=this._y-r,a=Math.cos(t),s=Math.sin(t);return this._set(i*a-o*s+n,i*s+o*a+r)}},{key:"dot",value:function(t){return this._x*t.x+this._y*t.y}},{key:"cross",value:function(t){return this._x*t.y-this._y*t.x}},{key:"lerp",value:function(t,e){return this._x+=(t.x-this._x)*e,this._y+=(t.y-this._y)*e,this}},{key:"distance",value:function(t){return Math.sqrt((this._x-t.x)*(this._x-t.x)+(this._y-t.y)*(this._y-t.y))}},{key:"clone",value:function(){return pool$1.pull("ObservableVector2d",this._x,this._y,{onUpdate:this.onUpdate,scope:this.scope})}},{key:"toVector2d",value:function(){return pool$1.pull("Vector2d",this._x,this._y)}},{key:"toString",value:function(){return"x:"+this._x+",y:"+this._y}}]),n}(Vector2d),Vector3d=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;_classCallCheck(this,t),this.onResetEvent(e,n,r)}return _createClass(t,[{key:"onResetEvent",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.x=t,this.y=e,this.z=n,this}},{key:"_set",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.x=t,this.y=e,this.z=n,this}},{key:"set",value:function(t,e,n){if(t!==+t||e!==+e||void 0!==n&&n!==+n)throw new Error("invalid x, y, z parameters (not a number)");return this._set(t,e,n)}},{key:"setZero",value:function(){return this.set(0,0,0)}},{key:"setV",value:function(t){return this._set(t.x,t.y,t.z)}},{key:"add",value:function(t){return this._set(this.x+t.x,this.y+t.y,this.z+(t.z||0))}},{key:"sub",value:function(t){return this._set(this.x-t.x,this.y-t.y,this.z-(t.z||0))}},{key:"scale",value:function(t,e,n){return e=void 0!==e?e:t,this._set(this.x*t,this.y*e,this.z*(n||1))}},{key:"scaleV",value:function(t){return this.scale(t.x,t.y,t.z)}},{key:"toIso",value:function(){return this._set(this.x-this.y,.5*(this.x+this.y),this.z)}},{key:"to2d",value:function(){return this._set(this.y+this.x/2,this.y-this.x/2,this.z)}},{key:"div",value:function(t){return this._set(this.x/t,this.y/t,this.z/t)}},{key:"abs",value:function(){return this._set(this.x<0?-this.x:this.x,this.y<0?-this.y:this.y,this.z<0?-this.z:this.z)}},{key:"clamp",value:function(e,n){return new t(_clamp(this.x,e,n),_clamp(this.y,e,n),_clamp(this.z,e,n))}},{key:"clampSelf",value:function(t,e){return this._set(_clamp(this.x,t,e),_clamp(this.y,t,e),_clamp(this.z,t,e))}},{key:"minV",value:function(t){var e=t.z||0;return this._set(this.x<t.x?this.x:t.x,this.y<t.y?this.y:t.y,this.z<e?this.z:e)}},{key:"maxV",value:function(t){var e=t.z||0;return this._set(this.x>t.x?this.x:t.x,this.y>t.y?this.y:t.y,this.z>e?this.z:e)}},{key:"floor",value:function(){return new t(Math.floor(this.x),Math.floor(this.y),Math.floor(this.z))}},{key:"floorSelf",value:function(){return this._set(Math.floor(this.x),Math.floor(this.y),Math.floor(this.z))}},{key:"ceil",value:function(){return new t(Math.ceil(this.x),Math.ceil(this.y),Math.ceil(this.z))}},{key:"ceilSelf",value:function(){return this._set(Math.ceil(this.x),Math.ceil(this.y),Math.ceil(this.z))}},{key:"negate",value:function(){return new t(-this.x,-this.y,-this.z)}},{key:"negateSelf",value:function(){return this._set(-this.x,-this.y,-this.z)}},{key:"copy",value:function(t){return this._set(t.x,t.y,t.z||0)}},{key:"equals",value:function(){var t,e,n;return arguments.length>=2?(t=arguments[0],e=arguments[1],n=arguments[2]):(t=arguments[0].x,e=arguments[0].y,n=arguments[0].z),void 0===n&&(n=this.z),this.x===t&&this.y===e&&this.z===n}},{key:"normalize",value:function(){return this.div(this.length()||1)}},{key:"perp",value:function(){return this._set(this.y,-this.x,this.z)}},{key:"rotate",value:function(t,e){var n=0,r=0;"object"===_typeof(e)&&(n=e.x,r=e.y);var i=this.x-n,o=this.y-r,a=Math.cos(t),s=Math.sin(t);return this._set(i*a-o*s+n,i*s+o*a+r,this.z)}},{key:"dot",value:function(t){return this.x*t.x+this.y*t.y+this.z*(void 0!==t.z?t.z:this.z)}},{key:"cross",value:function(t){var e=this.x,n=this.y,r=this.z,i=t.x,o=t.y,a=t.z;return this.x=n*a-r*o,this.y=r*i-e*a,this.z=e*o-n*i,this}},{key:"length2",value:function(){return this.dot(this)}},{key:"length",value:function(){return Math.sqrt(this.length2())}},{key:"lerp",value:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this}},{key:"distance",value:function(t){var e=this.x-t.x,n=this.y-t.y,r=this.z-(t.z||0);return Math.sqrt(e*e+n*n+r*r)}},{key:"angle",value:function(t){return Math.acos(_clamp(this.dot(t)/(this.length()*t.length()),-1,1))}},{key:"project",value:function(t){var e=this.dot(t)/t.length2();return this.scale(e,e,e)}},{key:"projectN",value:function(t){var e=this.dot(t)/t.length2();return this.scale(e,e,e)}},{key:"clone",value:function(){return pool$1.pull("Vector3d",this.x,this.y,this.z)}},{key:"toString",value:function(){return"x:"+this.x+",y:"+this.y+",z:"+this.z}}]),t}(),ObservableVector3d=function(t){_inherits(n,t);var e=_createSuper(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3?arguments[3]:void 0;if(_classCallCheck(this,n),t=e.call(this,r,i,o),void 0===a)throw new Error("undefined `onUpdate` callback");return t.setCallback(a.onUpdate,a.scope),t}return _createClass(n,[{key:"onResetEvent",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3?arguments[3]:void 0;return this.setMuted(t,e,n),void 0!==r&&this.setCallback(r.onUpdate,r.scope),this}},{key:"x",get:function(){return this._x},set:function(t){var e=this.onUpdate.call(this.scope,t,this._y,this._z,this._x,this._y,this._z);this._x=e&&"x"in e?e.x:t}},{key:"y",get:function(){return this._y},set:function(t){var e=this.onUpdate.call(this.scope,this._x,t,this._z,this._x,this._y,this._z);this._y=e&&"y"in e?e.y:t}},{key:"z",get:function(){return this._z},set:function(t){var e=this.onUpdate.call(this.scope,this._x,this._y,t,this._x,this._y,this._z);this._z=e&&"z"in e?e.z:t}},{key:"_set",value:function(t,e,n){var r=this.onUpdate.call(this.scope,t,e,n,this._x,this._y,this._z);return r&&"x"in r&&"y"in r&&"z"in r?(this._x=r.x,this._y=r.y,this._z=r.z):(this._x=t,this._y=e,this._z=n||0),this}},{key:"setMuted",value:function(t,e,n){return this._x=t,this._y=e,this._z=n||0,this}},{key:"setCallback",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if("function"!=typeof t)throw new Error("invalid `onUpdate` callback");return this.onUpdate=t,this.scope=e,this}},{key:"add",value:function(t){return this._set(this._x+t.x,this._y+t.y,this._z+(t.z||0))}},{key:"sub",value:function(t){return this._set(this._x-t.x,this._y-t.y,this._z-(t.z||0))}},{key:"scale",value:function(t,e,n){return e=void 0!==e?e:t,this._set(this._x*t,this._y*e,this._z*(n||1))}},{key:"scaleV",value:function(t){return this._set(this._x*t.x,this._y*t.y,this._z*(t.z||1))}},{key:"div",value:function(t){return this._set(this._x/t,this._y/t,this._z/t)}},{key:"abs",value:function(){return this._set(this._x<0?-this._x:this._x,this._y<0?-this._y:this._y,this._Z<0?-this._z:this._z)}},{key:"clamp",value:function(t,e){return new n(_clamp(this._x,t,e),_clamp(this._y,t,e),_clamp(this._z,t,e),{onUpdate:this.onUpdate,scope:this.scope})}},{key:"clampSelf",value:function(t,e){return this._set(_clamp(this._x,t,e),_clamp(this._y,t,e),_clamp(this._z,t,e))}},{key:"minV",value:function(t){var e=t.z||0;return this._set(this._x<t.x?this._x:t.x,this._y<t.y?this._y:t.y,this._z<e?this._z:e)}},{key:"maxV",value:function(t){var e=t.z||0;return this._set(this._x>t.x?this._x:t.x,this._y>t.y?this._y:t.y,this._z>e?this._z:e)}},{key:"floor",value:function(){return new n(Math.floor(this._x),Math.floor(this._y),Math.floor(this._z),{onUpdate:this.onUpdate,scope:this.scope})}},{key:"floorSelf",value:function(){return this._set(Math.floor(this._x),Math.floor(this._y),Math.floor(this._z))}},{key:"ceil",value:function(){return new n(Math.ceil(this._x),Math.ceil(this._y),Math.ceil(this._z),{onUpdate:this.onUpdate,scope:this.scope})}},{key:"ceilSelf",value:function(){return this._set(Math.ceil(this._x),Math.ceil(this._y),Math.ceil(this._z))}},{key:"negate",value:function(){return new n(-this._x,-this._y,-this._z,{onUpdate:this.onUpdate,scope:this.scope})}},{key:"negateSelf",value:function(){return this._set(-this._x,-this._y,-this._z)}},{key:"copy",value:function(t){return this._set(t.x,t.y,t.z||0)}},{key:"equals",value:function(t){return this._x===t.x&&this._y===t.y&&this._z===(t.z||this._z)}},{key:"perp",value:function(){return this._set(this._y,-this._x,this._z)}},{key:"rotate",value:function(t,e){var n=0,r=0;"object"===_typeof(e)&&(n=e.x,r=e.y);var i=this.x-n,o=this.y-r,a=Math.cos(t),s=Math.sin(t);return this._set(i*a-o*s+n,i*s+o*a+r,this.z)}},{key:"dot",value:function(t){return this._x*t.x+this._y*t.y+this._z*(t.z||1)}},{key:"cross",value:function(t){var e=this._x,n=this._y,r=this._z,i=t.x,o=t.y,a=t.z;return this._set(n*a-r*o,r*i-e*a,e*o-n*i)}},{key:"lerp",value:function(t,e){return this._x+=(t.x-this._x)*e,this._y+=(t.y-this._y)*e,this._z+=(t.z-this._z)*e,this}},{key:"distance",value:function(t){var e=this._x-t.x,n=this._y-t.y,r=this._z-(t.z||0);return Math.sqrt(e*e+n*n+r*r)}},{key:"clone",value:function(){return pool$1.pull("ObservableVector3d",this._x,this._y,this._z,{onUpdate:this.onUpdate})}},{key:"toVector3d",value:function(){return pool$1.pull("Vector3d",this._x,this._y,this._z)}},{key:"toString",value:function(){return"x:"+this._x+",y:"+this._y+",z:"+this._z}}]),n}(Vector3d),earcut$1={exports:{}};function earcut(t,e,n){n=n||2;var r,i,o,a,s,l,u,c=e&&e.length,h=c?e[0]*n:t.length,f=linkedList(t,0,h,n,!0),d=[];if(!f||f.next===f.prev)return d;if(c&&(f=eliminateHoles(t,e,f,n)),t.length>80*n){r=o=t[0],i=a=t[1];for(var p=n;p<h;p+=n)(s=t[p])<r&&(r=s),(l=t[p+1])<i&&(i=l),s>o&&(o=s),l>a&&(a=l);u=0!==(u=Math.max(o-r,a-i))?1/u:0}return earcutLinked(f,d,n,r,i,u),d}function linkedList(t,e,n,r,i){var o,a;if(i===signedArea(t,e,n,r)>0)for(o=e;o<n;o+=r)a=insertNode(o,t[o],t[o+1],a);else for(o=n-r;o>=e;o-=r)a=insertNode(o,t[o],t[o+1],a);return a&&equals(a,a.next)&&(removeNode(a),a=a.next),a}function filterPoints(t,e){if(!t)return t;e||(e=t);var n,r=t;do{if(n=!1,r.steiner||!equals(r,r.next)&&0!==area(r.prev,r,r.next))r=r.next;else{if(removeNode(r),(r=e=r.prev)===r.next)break;n=!0}}while(n||r!==e);return e}function earcutLinked(t,e,n,r,i,o,a){if(t){!a&&o&&indexCurve(t,r,i,o);for(var s,l,u=t;t.prev!==t.next;)if(s=t.prev,l=t.next,o?isEarHashed(t,r,i,o):isEar(t))e.push(s.i/n),e.push(t.i/n),e.push(l.i/n),removeNode(t),t=l.next,u=l.next;else if((t=l)===u){a?1===a?earcutLinked(t=cureLocalIntersections(filterPoints(t),e,n),e,n,r,i,o,2):2===a&&splitEarcut(t,e,n,r,i,o):earcutLinked(filterPoints(t),e,n,r,i,o,1);break}}}function isEar(t){var e=t.prev,n=t,r=t.next;if(area(e,n,r)>=0)return!1;for(var i=t.next.next;i!==t.prev;){if(pointInTriangle(e.x,e.y,n.x,n.y,r.x,r.y,i.x,i.y)&&area(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function isEarHashed(t,e,n,r){var i=t.prev,o=t,a=t.next;if(area(i,o,a)>=0)return!1;for(var s=i.x<o.x?i.x<a.x?i.x:a.x:o.x<a.x?o.x:a.x,l=i.y<o.y?i.y<a.y?i.y:a.y:o.y<a.y?o.y:a.y,u=i.x>o.x?i.x>a.x?i.x:a.x:o.x>a.x?o.x:a.x,c=i.y>o.y?i.y>a.y?i.y:a.y:o.y>a.y?o.y:a.y,h=zOrder(s,l,e,n,r),f=zOrder(u,c,e,n,r),d=t.prevZ,p=t.nextZ;d&&d.z>=h&&p&&p.z<=f;){if(d!==t.prev&&d!==t.next&&pointInTriangle(i.x,i.y,o.x,o.y,a.x,a.y,d.x,d.y)&&area(d.prev,d,d.next)>=0)return!1;if(d=d.prevZ,p!==t.prev&&p!==t.next&&pointInTriangle(i.x,i.y,o.x,o.y,a.x,a.y,p.x,p.y)&&area(p.prev,p,p.next)>=0)return!1;p=p.nextZ}for(;d&&d.z>=h;){if(d!==t.prev&&d!==t.next&&pointInTriangle(i.x,i.y,o.x,o.y,a.x,a.y,d.x,d.y)&&area(d.prev,d,d.next)>=0)return!1;d=d.prevZ}for(;p&&p.z<=f;){if(p!==t.prev&&p!==t.next&&pointInTriangle(i.x,i.y,o.x,o.y,a.x,a.y,p.x,p.y)&&area(p.prev,p,p.next)>=0)return!1;p=p.nextZ}return!0}function cureLocalIntersections(t,e,n){var r=t;do{var i=r.prev,o=r.next.next;!equals(i,o)&&intersects(i,r,r.next,o)&&locallyInside(i,o)&&locallyInside(o,i)&&(e.push(i.i/n),e.push(r.i/n),e.push(o.i/n),removeNode(r),removeNode(r.next),r=t=o),r=r.next}while(r!==t);return filterPoints(r)}function splitEarcut(t,e,n,r,i,o){var a=t;do{for(var s=a.next.next;s!==a.prev;){if(a.i!==s.i&&isValidDiagonal(a,s)){var l=splitPolygon(a,s);return a=filterPoints(a,a.next),l=filterPoints(l,l.next),earcutLinked(a,e,n,r,i,o),void earcutLinked(l,e,n,r,i,o)}s=s.next}a=a.next}while(a!==t)}function eliminateHoles(t,e,n,r){var i,o,a,s=[];for(i=0,o=e.length;i<o;i++)(a=linkedList(t,e[i]*r,i<o-1?e[i+1]*r:t.length,r,!1))===a.next&&(a.steiner=!0),s.push(getLeftmost(a));for(s.sort(compareX),i=0;i<s.length;i++)n=filterPoints(n=eliminateHole(s[i],n),n.next);return n}function compareX(t,e){return t.x-e.x}function eliminateHole(t,e){var n=findHoleBridge(t,e);if(!n)return e;var r=splitPolygon(n,t),i=filterPoints(n,n.next);return filterPoints(r,r.next),e===n?i:e}function findHoleBridge(t,e){var n,r=e,i=t.x,o=t.y,a=-1/0;do{if(o<=r.y&&o>=r.next.y&&r.next.y!==r.y){var s=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=i&&s>a){if(a=s,s===i){if(o===r.y)return r;if(o===r.next.y)return r.next}n=r.x<r.next.x?r:r.next}}r=r.next}while(r!==e);if(!n)return null;if(i===a)return n;var l,u=n,c=n.x,h=n.y,f=1/0;r=n;do{i>=r.x&&r.x>=c&&i!==r.x&&pointInTriangle(o<h?i:a,o,c,h,o<h?a:i,o,r.x,r.y)&&(l=Math.abs(o-r.y)/(i-r.x),locallyInside(r,t)&&(l<f||l===f&&(r.x>n.x||r.x===n.x&&sectorContainsSector(n,r)))&&(n=r,f=l)),r=r.next}while(r!==u);return n}function sectorContainsSector(t,e){return area(t.prev,t,e.prev)<0&&area(e.next,t,t.next)<0}function indexCurve(t,e,n,r){var i=t;do{null===i.z&&(i.z=zOrder(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,sortLinked(i)}function sortLinked(t){var e,n,r,i,o,a,s,l,u=1;do{for(n=t,t=null,o=null,a=0;n;){for(a++,r=n,s=0,e=0;e<u&&(s++,r=r.nextZ);e++);for(l=u;s>0||l>0&&r;)0!==s&&(0===l||!r||n.z<=r.z)?(i=n,n=n.nextZ,s--):(i=r,r=r.nextZ,l--),o?o.nextZ=i:t=i,i.prevZ=o,o=i;n=r}o.nextZ=null,u*=2}while(a>1);return t}function zOrder(t,e,n,r,i){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*i)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*i)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function getLeftmost(t){var e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function pointInTriangle(t,e,n,r,i,o,a,s){return(i-a)*(e-s)-(t-a)*(o-s)>=0&&(t-a)*(r-s)-(n-a)*(e-s)>=0&&(n-a)*(o-s)-(i-a)*(r-s)>=0}function isValidDiagonal(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!intersectsPolygon(t,e)&&(locallyInside(t,e)&&locallyInside(e,t)&&middleInside(t,e)&&(area(t.prev,t,e.prev)||area(t,e.prev,e))||equals(t,e)&&area(t.prev,t,t.next)>0&&area(e.prev,e,e.next)>0)}function area(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function equals(t,e){return t.x===e.x&&t.y===e.y}function intersects(t,e,n,r){var i=sign(area(t,e,n)),o=sign(area(t,e,r)),a=sign(area(n,r,t)),s=sign(area(n,r,e));return i!==o&&a!==s||!(0!==i||!onSegment(t,n,e))||!(0!==o||!onSegment(t,r,e))||!(0!==a||!onSegment(n,t,r))||!(0!==s||!onSegment(n,e,r))}function onSegment(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function sign(t){return t>0?1:t<0?-1:0}function intersectsPolygon(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&intersects(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}function locallyInside(t,e){return area(t.prev,t,t.next)<0?area(t,e,t.next)>=0&&area(t,t.prev,e)>=0:area(t,e,t.prev)<0||area(t,t.next,e)<0}function middleInside(t,e){var n=t,r=!1,i=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&i<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==t);return r}function splitPolygon(t,e){var n=new Node$1(t.i,t.x,t.y),r=new Node$1(e.i,e.x,e.y),i=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function insertNode(t,e,n,r){var i=new Node$1(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function removeNode(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Node$1(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function signedArea(t,e,n,r){for(var i=0,o=e,a=n-r;o<n;o+=r)i+=(t[a]-t[o])*(t[o+1]+t[a+1]),a=o;return i}earcut$1.exports=earcut,earcut$1.exports.default=earcut,earcut.deviation=function(t,e,n,r){var i=e&&e.length,o=i?e[0]*n:t.length,a=Math.abs(signedArea(t,0,o,n));if(i)for(var s=0,l=e.length;s<l;s++){var u=e[s]*n,c=s<l-1?e[s+1]*n:t.length;a-=Math.abs(signedArea(t,u,c,n))}var h=0;for(s=0;s<r.length;s+=3){var f=r[s]*n,d=r[s+1]*n,p=r[s+2]*n;h+=Math.abs((t[f]-t[p])*(t[d+1]-t[f+1])-(t[f]-t[d])*(t[p+1]-t[f+1]))}return 0===a&&0===h?0:Math.abs((h-a)/a)},earcut.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},r=0,i=0;i<t.length;i++){for(var o=0;o<t[i].length;o++)for(var a=0;a<e;a++)n.vertices.push(t[i][o][a]);i>0&&(r+=t[i-1].length,n.holes.push(r))}return n};var Polygon=function(){function t(e,n,r){_classCallCheck(this,t),this.pos=pool$1.pull("Vector2d"),this._bounds,this.points=[],this.edges=[],this.indices=[],this.normals=[],this.shapeType="Polygon",this.setShape(e,n,r)}return _createClass(t,[{key:"onResetEvent",value:function(t,e,n){this.setShape(t,e,n)}},{key:"setShape",value:function(t,e,n){return this.pos.set(t,e),this.setVertices(n),this}},{key:"setVertices",value:function(t){var e=this;if(!Array.isArray(t))return this;if(t[0]instanceof Vector2d)this.points=t;else if(this.points.length=0,"object"===_typeof(t[0]))t.forEach((function(t){e.points.push(pool$1.pull("Vector2d",t.x,t.y))}));else for(var n=0;n<t.length;n+=2)this.points.push(pool$1.pull("Vector2d",t[n],t[n+1]));return this.recalc(),this.updateBounds(),this}},{key:"transform",value:function(t){for(var e=this.points,n=e.length,r=0;r<n;r++)t.apply(e[r]);return this.recalc(),this.updateBounds(),this}},{key:"toIso",value:function(){return this.rotate(Math.PI/4).scale(Math.SQRT2,Math.SQRT1_2)}},{key:"to2d",value:function(){return this.scale(Math.SQRT1_2,Math.SQRT2).rotate(-Math.PI/4)}},{key:"rotate",value:function(t,e){if(0!==t){for(var n=this.points,r=n.length,i=0;i<r;i++)n[i].rotate(t,e);this.recalc(),this.updateBounds()}return this}},{key:"scale",value:function(t,e){e=void 0!==e?e:t;for(var n=this.points,r=n.length,i=0;i<r;i++)n[i].scale(t,e);return this.recalc(),this.updateBounds(),this}},{key:"scaleV",value:function(t){return this.scale(t.x,t.y)}},{key:"recalc",value:function(){var t,e=this.edges,n=this.normals,r=this.indices,i=this.points,o=i.length;if(o<3)throw new Error("Requires at least 3 points");for(t=0;t<o;t++)void 0===e[t]&&(e[t]=pool$1.pull("Vector2d")),e[t].copy(i[(t+1)%o]).sub(i[t]),void 0===n[t]&&(n[t]=pool$1.pull("Vector2d")),n[t].copy(e[t]).perp().normalize();return e.length=o,n.length=o,r.length=0,this}},{key:"getIndices",value:function(){return 0===this.indices.length&&(this.indices=earcut$1.exports(this.points.flatMap((function(t){return[t.x,t.y]})))),this.indices}},{key:"isConvex",value:function(){var t,e,n,r,i=0,o=this.points,a=o.length;if(a<3)return null;for(t=0;t<a;t++)if(n=(t+2)%a,r=(o[e=(t+1)%a].x-o[t].x)*(o[n].y-o[e].y),(r-=(o[e].y-o[t].y)*(o[n].x-o[e].x))<0?i|=1:r>0&&(i|=2),3===i)return!1;return 0!==i||null}},{key:"translate",value:function(){var t,e;return 2===arguments.length?(t=arguments[0],e=arguments[1]):(t=arguments[0].x,e=arguments[0].y),this.pos.x+=t,this.pos.y+=e,this.getBounds().translate(t,e),this}},{key:"shift",value:function(){var t,e;2===arguments.length?(t=arguments[0],e=arguments[1]):(t=arguments[0].x,e=arguments[0].y),this.pos.x=t,this.pos.y=e,this.updateBounds()}},{key:"contains",value:function(){var t,e;2===arguments.length?(t=arguments[0],e=arguments[1]):(t=arguments[0].x,e=arguments[0].y);for(var n=!1,r=this.pos.x,i=this.pos.y,o=this.points,a=o.length,s=0,l=a-1;s<a;l=s++){var u=o[s].y+i,c=o[s].x+r,h=o[l].y+i,f=o[l].x+r;u>e!=h>e&&t<(f-c)*(e-u)/(h-u)+c&&(n=!n)}return n}},{key:"getBounds",value:function(){return void 0===this._bounds&&(this._bounds=pool$1.pull("Bounds")),this._bounds}},{key:"updateBounds",value:function(){var t=this.getBounds();return t.update(this.points),t.translate(this.pos),t}},{key:"clone",value:function(){var e=[];return this.points.forEach((function(t){e.push(t.clone())})),new t(this.pos.x,this.pos.y,e)}}]),t}(),Rect=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i,o){var a;return _classCallCheck(this,n),(a=e.call(this,t,r,[pool$1.pull("Vector2d",0,0),pool$1.pull("Vector2d",i,0),pool$1.pull("Vector2d",i,o),pool$1.pull("Vector2d",0,o)])).shapeType="Rectangle",a}return _createClass(n,[{key:"onResetEvent",value:function(t,e,n,r){this.setShape(t,e,n,r)}},{key:"setShape",value:function(t,e,n,r){var i=n;return this.pos.set(t,e),4===arguments.length&&((i=this.points)[0].set(0,0),i[1].set(n,0),i[2].set(n,r),i[3].set(0,r)),this.setVertices(i),this}},{key:"left",get:function(){return this.pos.x}},{key:"right",get:function(){var t=this.width;return this.pos.x+t||t}},{key:"top",get:function(){return this.pos.y}},{key:"bottom",get:function(){var t=this.height;return this.pos.y+t||t}},{key:"width",get:function(){return this.points[2].x},set:function(t){this.points[1].x=this.points[2].x=t,this.recalc(),this.updateBounds()}},{key:"height",get:function(){return this.points[2].y},set:function(t){this.points[2].y=this.points[3].y=t,this.recalc(),this.updateBounds()}},{key:"centerX",get:function(){return isFinite(this.width)?this.pos.x+this.width/2:this.width},set:function(t){this.pos.x=t-this.width/2}},{key:"centerY",get:function(){return isFinite(this.height)?this.pos.y+this.height/2:this.height},set:function(t){this.pos.y=t-this.height/2}},{key:"centerOn",value:function(t,e){return this.centerX=t,this.centerY=e,this}},{key:"resize",value:function(t,e){return this.width=t,this.height=e,this}},{key:"scale",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;return this.width*=t,this.height*=e,this}},{key:"clone",value:function(){return new n(this.pos.x,this.pos.y,this.width,this.height)}},{key:"copy",value:function(t){return this.setShape(t.pos.x,t.pos.y,t.width,t.height)}},{key:"union",value:function(t){var e=Math.min(this.left,t.left),n=Math.min(this.top,t.top);return this.resize(Math.max(this.right,t.right)-e,Math.max(this.bottom,t.bottom)-n),this.pos.set(e,n),this}},{key:"overlaps",value:function(t){return this.left<t.right&&t.left<this.right&&this.top<t.bottom&&t.top<this.bottom}},{key:"contains",value:function(){var t,e,r,i,o=arguments[0];return 2===arguments.length?(t=e=o,r=i=arguments[1]):o instanceof n?(t=o.left,e=o.right,r=o.top,i=o.bottom):(t=e=o.x,r=i=o.y),t>=this.left&&e<=this.right&&r>=this.top&&i<=this.bottom}},{key:"equals",value:function(t){return t.left===this.left&&t.right===this.right&&t.top===this.top&&t.bottom===this.bottom}},{key:"isFinite",value:function(t){function e(){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(){return isFinite(this.pos.x)&&isFinite(this.pos.y)&&isFinite(this.width)&&isFinite(this.height)}))},{key:"toPolygon",value:function(){return pool$1.pull("Polygon",this.pos.x,this.pos.y,this.points)}}]),n}(Polygon),_keyStatus={},_keyLock={},_keyLocked={},_keyRefs={},_preventDefaultForKeys={},_keyBindings={},keyDownEvent=function(t,e,n){e=e||t.keyCode||t.button;var r=_keyBindings[e];if(emit(KEYDOWN,r,e,!r||!_keyLocked[r]),r){if(!_keyLocked[r]){var i=void 0!==n?n:e;_keyRefs[r][i]||(_keyStatus[r]++,_keyRefs[r][i]=!0)}return!_preventDefaultForKeys[e]||"function"!=typeof t.preventDefault||t.preventDefault()}return!0},keyUpEvent=function(t,e,n){e=e||t.keyCode||t.button;var r=_keyBindings[e];if(emit(KEYUP,r,e),r){var i=void 0!==n?n:e;return _keyRefs[r][i]=void 0,_keyStatus[r]>0&&_keyStatus[r]--,_keyLocked[r]=!1,!_preventDefaultForKeys[e]||"function"!=typeof t.preventDefault||t.preventDefault()}return!0},keyBoardEventTarget=null,KEY={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PRINT_SCREEN:42,INSERT:45,DELETE:46,NUM0:48,NUM1:49,NUM2:50,NUM3:51,NUM4:52,NUM5:53,NUM6:54,NUM7:55,NUM8:56,NUM9:57,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,WINDOW_KEY:91,NUMPAD0:96,NUMPAD1:97,NUMPAD2:98,NUMPAD3:99,NUMPAD4:100,NUMPAD5:101,NUMPAD6:102,NUMPAD7:103,NUMPAD8:104,NUMPAD9:105,MULTIPLY:106,ADD:107,SUBSTRACT:109,DECIMAL:110,DIVIDE:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,TILDE:126,NUM_LOCK:144,SCROLL_LOCK:145,SEMICOLON:186,PLUS:187,COMMA:188,MINUS:189,PERIOD:190,FORWAND_SLASH:191,GRAVE_ACCENT:192,OPEN_BRACKET:219,BACK_SLASH:220,CLOSE_BRACKET:221,SINGLE_QUOTE:222};function initKeyboardEvent(){null===keyBoardEventTarget&&!1===device$1.isMobile&&"function"==typeof(keyBoardEventTarget=globalThis).addEventListener&&(keyBoardEventTarget.addEventListener("keydown",keyDownEvent,!1),keyBoardEventTarget.addEventListener("keyup",keyUpEvent,!1))}function isKeyPressed(t){return!(!_keyStatus[t]||_keyLocked[t]||(_keyLock[t]&&(_keyLocked[t]=!0),0))}function keyStatus(t){return _keyStatus[t]>0}function triggerKeyEvent(t,e,n){!0===e?keyDownEvent({},t,n):keyUpEvent({},t,n)}function bindKey(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:preventDefault;_keyBindings[t]=e,_preventDefaultForKeys[t]=r,_keyStatus[e]=0,_keyLock[e]=n||!1,_keyLocked[e]=!1,_keyRefs[e]={}}function getBindingKey(t){return _keyBindings[t]}function unlockKey(t){_keyLocked[t]=!1}function unbindKey(t){var e=_keyBindings[t];_keyStatus[e]=0,_keyLock[e]=!1,_keyRefs[e]={},_keyBindings[t]=null,_preventDefaultForKeys[t]=null}var Bounds$1=function(){function t(e){_classCallCheck(this,t),this._center=new Vector2d,this.onResetEvent(e)}return _createClass(t,[{key:"onResetEvent",value:function(t){void 0===this.min?(this.min={x:1/0,y:1/0},this.max={x:-1/0,y:-1/0}):this.clear(),void 0!==t&&this.update(t)}},{key:"clear",value:function(){this.setMinMax(1/0,1/0,-1/0,-1/0)}},{key:"setMinMax",value:function(t,e,n,r){this.min.x=t,this.min.y=e,this.max.x=n,this.max.y=r}},{key:"x",get:function(){return this.min.x},set:function(t){var e=this.max.x-this.min.x;this.min.x=t,this.max.x=t+e}},{key:"y",get:function(){return this.min.y},set:function(t){var e=this.max.y-this.min.y;this.min.y=t,this.max.y=t+e}},{key:"width",get:function(){return this.max.x-this.min.x},set:function(t){this.max.x=this.min.x+t}},{key:"height",get:function(){return this.max.y-this.min.y},set:function(t){this.max.y=this.min.y+t}},{key:"left",get:function(){return this.min.x}},{key:"right",get:function(){return this.max.x}},{key:"top",get:function(){return this.min.y}},{key:"bottom",get:function(){return this.max.y}},{key:"centerX",get:function(){return this.min.x+this.width/2}},{key:"centerY",get:function(){return this.min.y+this.height/2}},{key:"center",get:function(){return this._center.set(this.centerX,this.centerY)}},{key:"update",value:function(t){this.add(t,!0)}},{key:"add",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];!0===e&&this.clear();for(var n=0;n<t.length;n++){var r=t[n];r.x>this.max.x&&(this.max.x=r.x),r.x<this.min.x&&(this.min.x=r.x),r.y>this.max.y&&(this.max.y=r.y),r.y<this.min.y&&(this.min.y=r.y)}}},{key:"addBounds",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];!0===e&&this.clear(),t.max.x>this.max.x&&(this.max.x=t.max.x),t.min.x<this.min.x&&(this.min.x=t.min.x),t.max.y>this.max.y&&(this.max.y=t.max.y),t.min.y<this.min.y&&(this.min.y=t.min.y)}},{key:"addPoint",value:function(t,e){void 0!==e&&(t=e.apply(t)),this.min.x=Math.min(this.min.x,t.x),this.max.x=Math.max(this.max.x,t.x),this.min.y=Math.min(this.min.y,t.y),this.max.y=Math.max(this.max.y,t.y)}},{key:"addFrame",value:function(t,e,n,r,i){var o=me.pool.pull("Vector2d");this.addPoint(o.set(t,e),i),this.addPoint(o.set(n,e),i),this.addPoint(o.set(t,r),i),this.addPoint(o.set(n,r),i),me.pool.push(o)}},{key:"contains",value:function(){var e,n,r,i,o=arguments[0];return 2===arguments.length?(e=n=o,r=i=arguments[1]):o instanceof t?(e=o.min.x,n=o.max.x,r=o.min.y,i=o.max.y):(e=n=o.x,r=i=o.y),e>=this.min.x&&n<=this.max.x&&r>=this.min.y&&i<=this.max.y}},{key:"overlaps",value:function(t){return!(this.right<t.left||this.left>t.right||this.bottom<t.top||this.top>t.bottom)}},{key:"isFinite",value:function(t){function e(){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(){return isFinite(this.min.x)&&isFinite(this.max.x)&&isFinite(this.min.y)&&isFinite(this.max.y)}))},{key:"translate",value:function(){var t,e;2===arguments.length?(t=arguments[0],e=arguments[1]):(t=arguments[0].x,e=arguments[0].y),this.min.x+=t,this.max.x+=t,this.min.y+=e,this.max.y+=e}},{key:"shift",value:function(){var t,e;2===arguments.length?(t=arguments[0],e=arguments[1]):(t=arguments[0].x,e=arguments[0].y);var n=this.max.x-this.min.x,r=this.max.y-this.min.y;this.min.x=t,this.max.x=t+n,this.min.y=e,this.max.y=e+r}},{key:"clone",value:function(){var e=new t;return e.addBounds(this),e}},{key:"toPolygon",value:function(){return pool$1.pull("Polygon",this.x,this.y,[pool$1.pull("Vector2d",0,0),pool$1.pull("Vector2d",this.width,0),pool$1.pull("Vector2d",this.width,this.height),pool$1.pull("Vector2d",0,this.height)])}}]),t}(),tmpVec=new Vector2d,Pointer=function(t){_inherits(n,t);var e=_createSuper(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return _classCallCheck(this,n),(t=e.call(this)).setMinMax(r,i,r+o,i+a),t.LEFT=0,t.MIDDLE=1,t.RIGHT=2,t.event=void 0,t.type=void 0,t.button=0,t.isPrimary=!1,t.pageX=0,t.pageY=0,t.clientX=0,t.clientY=0,t.movementX=0,t.movementY=0,t.deltaMode=0,t.deltaX=0,t.deltaY=0,t.deltaZ=0,t.gameX=0,t.gameY=0,t.gameScreenX=0,t.gameScreenY=0,t.gameWorldX=0,t.gameWorldY=0,t.gameLocalX=0,t.gameLocalY=0,t.pointerId=void 0,t.isNormalized=!1,t.locked=!1,t.bind=[0,0,0],t}return _createClass(n,[{key:"setEvent",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1;this.event=t,this.pageX=e,this.pageY=n,this.clientX=r,this.clientY=i,globalToLocal(this.pageX,this.pageY,tmpVec),this.gameScreenX=this.x=tmpVec.x,this.gameScreenY=this.y=tmpVec.y,this.isNormalized=!device$1.PointerEvent||device$1.PointerEvent&&!(t instanceof globalThis.PointerEvent),this.locked=locked,this.movementX=t.movementX||0,this.movementY=t.movementY||0,"wheel"===t.type?(this.deltaMode=t.deltaMode||0,this.deltaX=t.deltaX||0,this.deltaY=t.deltaY||0,this.deltaZ=t.deltaZ||0):(this.deltaMode=0,this.deltaX=0,this.deltaY=0,this.deltaZ=0),this.pointerId=o,this.isPrimary=void 0===t.isPrimary||t.isPrimary,this.button=t.button||0,this.type=t.type,void 0!==viewport&&viewport.localToWorld(this.gameScreenX,this.gameScreenY,tmpVec),this.gameWorldX=tmpVec.x,this.gameWorldY=tmpVec.y,!1===this.isNormalized?(this.width=t.width||1,this.height=t.height||1):"number"==typeof t.radiusX?(this.width=2*t.radiusX||1,this.height=2*t.radiusY||1):this.width=this.height=1}}]),n}(Bounds$1),T_POINTERS=[],eventHandlers=new Map,currentPointer,pointerInitialized=!1,lastTimeStamp=0,activeEventList=[],WHEEL=["wheel"],POINTER_MOVE=["pointermove","mousemove","touchmove"],POINTER_DOWN=["pointerdown","mousedown","touchstart"],POINTER_UP=["pointerup","mouseup","touchend"],POINTER_CANCEL=["pointercancel","mousecancel","touchcancel"],POINTER_ENTER=["pointerenter","mouseenter","touchenter"],POINTER_OVER=["pointerover","mouseover","touchover"],POINTER_LEAVE=["pointerleave","mouseleave","touchleave"],pointerEventList=[WHEEL[0],POINTER_MOVE[0],POINTER_DOWN[0],POINTER_UP[0],POINTER_CANCEL[0],POINTER_ENTER[0],POINTER_OVER[0],POINTER_LEAVE[0]],mouseEventList=[WHEEL[0],POINTER_MOVE[1],POINTER_DOWN[1],POINTER_UP[1],POINTER_CANCEL[1],POINTER_ENTER[1],POINTER_OVER[1],POINTER_LEAVE[1]],touchEventList=[POINTER_MOVE[2],POINTER_DOWN[2],POINTER_UP[2],POINTER_CANCEL[2],POINTER_ENTER[2],POINTER_OVER[2],POINTER_LEAVE[2]],pointerEventMap={wheel:WHEEL,pointermove:POINTER_MOVE,pointerdown:POINTER_DOWN,pointerup:POINTER_UP,pointercancel:POINTER_CANCEL,pointerenter:POINTER_ENTER,pointerover:POINTER_OVER,pointerleave:POINTER_LEAVE},normalizedEvents=[];function registerEventListener(t,e){for(var n=0;n<t.length;n++)-1===POINTER_MOVE.indexOf(t[n])&&pointerEventTarget.addEventListener(t[n],e,{passive:!1===preventDefault})}function enablePointerEvent(){if(!pointerInitialized){currentPointer=new Rect(0,0,1,1);for(var t=0;t<device$1.maxTouchPoints;t++)T_POINTERS.push(new Pointer);var e;null===pointerEventTarget&&(pointerEventTarget=renderer.getScreenCanvas()),activeEventList=device$1.PointerEvent?pointerEventList:mouseEventList,device$1.touch&&!device$1.PointerEvent&&(activeEventList=activeEventList.concat(touchEventList)),registerEventListener(activeEventList,onPointerEvent),void 0===throttlingInterval&&(throttlingInterval=~~(1e3/timer$1.maxfps)),!0===device$1.autoFocus&&(device$1.focus(),pointerEventTarget.addEventListener(activeEventList[2],(function(){device$1.focus()}),{passive:!1===preventDefault}));var n=findAllActiveEvents(activeEventList,POINTER_MOVE);if(throttlingInterval<17)for(e=0;e<n.length;e++)-1!==activeEventList.indexOf(n[e])&&pointerEventTarget.addEventListener(n[e],onMoveEvent,{passive:!0});else for(e=0;e<n.length;e++)-1!==activeEventList.indexOf(n[e])&&pointerEventTarget.addEventListener(n[e],throttle(onMoveEvent,throttlingInterval,!1),{passive:!0});setTouchAction(pointerEventTarget),device$1.hasPointerLockSupport&&document.addEventListener("pointerlockchange",(function(){locked=document.pointerLockElement===getParent(),emit(POINTERLOCKCHANGE,locked)}),!0),pointerInitialized=!0}}function findActiveEvent(t,e){for(var n=0;n<e.length;n++)if(-1!==t.indexOf(e[n]))return e[n]}function findAllActiveEvents(t,e){for(var n=[],r=0;r<e.length;r++)-1!==t.indexOf(e[r])&&n.push(e[r]);return n}function triggerEvent(t,e,n,r){var i;if(t.callbacks[e]){t.pointerId=r;for(var o=t.callbacks[e].length-1;o>=0&&(i=t.callbacks[e][o]);o--)if(!1===i(n))return!0}return!1}function dispatchEvent(t){for(var e=!1;t.length>0;){var n=t.pop();if(T_POINTERS.push(n),void 0!==n.event.timeStamp){if(n.event.timeStamp<lastTimeStamp)continue;lastTimeStamp=n.event.timeStamp}currentPointer.setShape(n.gameWorldX,n.gameWorldY,n.width,n.height),POINTER_MOVE.includes(n.type)&&(n.gameX=n.gameLocalX=n.gameScreenX,n.gameY=n.gameLocalY=n.gameScreenY,emit(POINTERMOVE,n));for(var r,i=world.broadphase.retrieve(currentPointer,Container.prototype._sortReverseZ),o=(i=i.concat([viewport])).length;r=i[--o];){if(eventHandlers.has(r)&&!0!==r.isKinematic){var a,s=eventHandlers.get(r),l=s.region,u=l.ancestor,c=l.getBounds();if(!0===l.isFloating?(n.gameX=n.gameLocalX=n.gameScreenX,n.gameY=n.gameLocalY=n.gameScreenY):(n.gameX=n.gameLocalX=n.gameWorldX,n.gameY=n.gameLocalY=n.gameWorldY),void 0!==u){var h=u.getBounds();n.gameLocalX=n.gameX-h.x,n.gameLocalY=n.gameY-h.y}var f=n.gameX,d=n.gameY;if(void 0!==l.currentTransform&&!l.currentTransform.isIdentity()){var p=l.currentTransform.applyInverse(pool$1.pull("Vector2d",f,d));f=p.x,d=p.y,pool$1.push(p)}switch(a=c.contains(f,d),n.type){case POINTER_MOVE[0]:case POINTER_MOVE[1]:case POINTER_MOVE[2]:case POINTER_MOVE[3]:if(s.pointerId!==n.pointerId||a){if(null===s.pointerId&&a&&triggerEvent(s,findActiveEvent(activeEventList,POINTER_ENTER),n,n.pointerId)){e=!0;break}}else if(triggerEvent(s,findActiveEvent(activeEventList,POINTER_LEAVE),n,null)){e=!0;break}if(a&&triggerEvent(s,n.type,n,n.pointerId)){e=!0;break}break;case POINTER_UP[0]:case POINTER_UP[1]:case POINTER_UP[2]:case POINTER_UP[3]:if(s.pointerId===n.pointerId&&a&&triggerEvent(s,n.type,n,null)){e=!0;break}break;case POINTER_CANCEL[0]:case POINTER_CANCEL[1]:case POINTER_CANCEL[2]:case POINTER_CANCEL[3]:if(s.pointerId===n.pointerId&&triggerEvent(s,n.type,n,null)){e=!0;break}break;default:if(a&&triggerEvent(s,n.type,n,n.pointerId)){e=!0;break}}}if(!0===e)break}}return e}function normalizeEvent(t){var e;if(device$1.TouchEvent&&t.changedTouches)for(var n=0,r=t.changedTouches.length;n<r;n++){var i=t.changedTouches[n];(e=T_POINTERS.pop()).setEvent(t,i.pageX,i.pageY,i.clientX,i.clientY,i.identifier),normalizedEvents.push(e)}else(e=T_POINTERS.pop()).setEvent(t,t.pageX,t.pageY,t.clientX,t.clientY,t.pointerId),normalizedEvents.push(e);return!1===t.isPrimary||(normalizedEvents[0].isPrimary=!0,Object.assign(pointer,normalizedEvents[0])),normalizedEvents}function onMoveEvent(t){dispatchEvent(normalizeEvent(t))}function onPointerEvent(t){normalizeEvent(t);var e=normalizedEvents[0].button;(dispatchEvent(normalizedEvents)||"wheel"===t.type)&&t.preventDefault();var n=pointer.bind[e];n&&triggerKeyEvent(n,POINTER_DOWN.includes(t.type),e+1)}var pointerEventTarget=null,pointer=new Pointer(0,0,1,1),locked=!1,throttlingInterval;function globalToLocal(t,e,n){n=n||pool$1.pull("Vector2d");var r=device$1.getElementBounds(renderer.getScreenCanvas()),i=device$1.devicePixelRatio;t-=r.left+(globalThis.pageXOffset||0),e-=r.top+(globalThis.pageYOffset||0);var o=scaleRatio;return 1===o.x&&1===o.y||(t/=o.x,e/=o.y),n.set(t*i,e*i)}function setTouchAction(t,e){t.style["touch-action"]=e||"none"}function bindPointer(){var t=arguments.length<2?pointer.LEFT:arguments[0],e=arguments.length<2?arguments[0]:arguments[1];if(enablePointerEvent(),!getBindingKey(e))throw new Error("no action defined for keycode "+e);pointer.bind[t]=e}function unbindPointer(t){pointer.bind[void 0===t?pointer.LEFT:t]=null}function registerPointerEvent(t,e,n){if(enablePointerEvent(),-1===pointerEventList.indexOf(t))throw new Error("invalid event type : "+t);if(void 0===e)throw new Error("registerPointerEvent: region for "+toString(e)+" event is undefined ");var r=findAllActiveEvents(activeEventList,pointerEventMap[t]);eventHandlers.has(e)||eventHandlers.set(e,{region:e,callbacks:{},pointerId:null});for(var i=eventHandlers.get(e),o=0;o<r.length;o++)t=r[o],i.callbacks[t]?i.callbacks[t].push(n):i.callbacks[t]=[n]}function releasePointerEvent(t,e,n){if(-1===pointerEventList.indexOf(t))throw new Error("invalid event type : "+t);var r=findAllActiveEvents(activeEventList,pointerEventMap[t]),i=eventHandlers.get(e);if(void 0!==i){for(var o=0;o<r.length;o++)if(t=r[o],i.callbacks[t]){if(void 0!==n)_remove(i.callbacks[t],n);else for(;i.callbacks[t].length>0;)i.callbacks[t].pop();0===i.callbacks[t].length&&delete i.callbacks[t]}0===Object.keys(i.callbacks).length&&eventHandlers.delete(e)}}function releaseAllPointerEvents(t){if(eventHandlers.has(t))for(var e=0;e<pointerEventList.length;e++)releasePointerEvent(pointerEventList[e],t)}function requestPointerLock(){return!!device$1.hasPointerLockSupport&&(getParent().requestPointerLock(),!0)}function exitPointerLock(){return!!device$1.hasPointerLockSupport&&(document.exitPointerLock(),!0)}var deadzone=.1;function wiredXbox360NormalizeFn(t,e,n){return n===this.GAMEPAD.BUTTONS.L2||n===this.GAMEPAD.BUTTONS.R2?(t+1)/2:t}function ouyaNormalizeFn(t,e,n){return t>0?n===this.GAMEPAD.BUTTONS.L2?Math.max(0,t-2e4)/111070:(t-1)/131070:(65536+t)/131070+.5}var vendorProductRE=/^([0-9a-f]{1,4})-([0-9a-f]{1,4})-/i,leadingZeroRE=/^0+/;function addMapping(t,e){var n=t.replace(vendorProductRE,(function(t,e,n){return"000".slice(e.length-1)+e+"-"+"000".slice(n.length-1)+n+"-"})),r=t.replace(vendorProductRE,(function(t,e,n){return e.replace(leadingZeroRE,"")+"-"+n.replace(leadingZeroRE,"")+"-"}));e.analog=e.analog||e.buttons.map((function(){return-1})),e.normalize_fn=e.normalize_fn||function(t){return t},remap.set(n,e),remap.set(r,e)}var bindings={},remap=new Map,updateEventHandler;[["45e-28e-Xbox 360 Wired Controller",{axes:[0,1,3,4],buttons:[11,12,13,14,8,9,-1,-1,5,4,6,7,0,1,2,3,10],analog:[-1,-1,-1,-1,-1,-1,2,5,-1,-1,-1,-1,-1,-1,-1,-1,-1],normalize_fn:wiredXbox360NormalizeFn}],["54c-268-PLAYSTATION(R)3 Controller",{axes:[0,1,2,3],buttons:[14,13,15,12,10,11,8,9,0,3,1,2,4,6,7,5,16]}],["54c-5c4-Wireless Controller",{axes:[0,1,2,3],buttons:[1,0,2,3,4,5,6,7,8,9,10,11,14,15,16,17,12,13]}],["2836-1-OUYA Game Controller",{axes:[0,3,7,9],buttons:[3,6,4,5,7,8,15,16,-1,-1,9,10,11,12,13,14,-1],analog:[-1,-1,-1,-1,-1,-1,5,11,-1,-1,-1,-1,-1,-1,-1,-1,-1],normalize_fn:ouyaNormalizeFn}],["OUYA Game Controller (Vendor: 2836 Product: 0001)",{axes:[0,1,3,4],buttons:[0,3,1,2,4,5,12,13,-1,-1,6,7,8,9,10,11,-1],analog:[-1,-1,-1,-1,-1,-1,2,5,-1,-1,-1,-1,-1,-1,-1,-1,-1],normalize_fn:ouyaNormalizeFn}]].forEach((function(t){addMapping(t[0],t[1])}));var updateGamepads=function(){var t=navigator.getGamepads();Object.keys(bindings).forEach((function(e){var n=t[e];if(n){var r=null;"standard"!==n.mapping&&(r=remap.get(n.id));var i=bindings[e];Object.keys(i.buttons).forEach((function(t){var o=i.buttons[t],a=t,s=-1;if(!(r&&(a=r.buttons[t],s=r.analog[t],a<0&&s<0))){var l=n.buttons[a]||{};if(r&&s>=0){var u=r.normalize_fn(n.axes[s],-1,+t);l={value:u,pressed:l.pressed||Math.abs(u)>=deadzone}}emit(GAMEPAD_UPDATE,e,"buttons",+t,l),!o.pressed&&l.pressed?triggerKeyEvent(o.keyCode,!0,a+256):o.pressed&&!l.pressed&&triggerKeyEvent(o.keyCode,!1,a+256),o.value=l.value,o.pressed=l.pressed}})),Object.keys(i.axes).forEach((function(t){var o=i.axes[t],a=t;if(!(r&&(a=r.axes[t])<0)){var s=n.axes[a];if(void 0!==s){r&&(s=r.normalize_fn(s,+t,-1));var l=Math.sign(s)||1;if(0!==o[l].keyCode){var u=Math.abs(s)>=deadzone+Math.abs(o[l].threshold);emit(GAMEPAD_UPDATE,e,"axes",+t,s),!o[l].pressed&&u?(o[-l].pressed&&(triggerKeyEvent(o[-l].keyCode,!1,a+256),o[-l].value=0,o[-l].pressed=!1),triggerKeyEvent(o[l].keyCode,!0,a+256)):!o[l].pressed&&!o[-l].pressed||u||triggerKeyEvent(o[l=o[l].pressed?l:-l].keyCode,!1,a+256),o[l].value=s,o[l].pressed=u}}}}))}}))};globalThis.navigator&&"function"==typeof globalThis.navigator.getGamepads&&(globalThis.addEventListener("gamepadconnected",(function(t){emit(GAMEPAD_CONNECTED,t.gamepad)}),!1),globalThis.addEventListener("gamepaddisconnected",(function(t){emit(GAMEPAD_DISCONNECTED,t.gamepad)}),!1));var GAMEPAD={AXES:{LX:0,LY:1,RX:2,RY:3,EXTRA_1:4,EXTRA_2:5,EXTRA_3:6,EXTRA_4:7},BUTTONS:{FACE_1:0,FACE_2:1,FACE_3:2,FACE_4:3,L1:4,R1:5,L2:6,R2:7,SELECT:8,BACK:8,START:9,FORWARD:9,L3:10,R3:11,UP:12,DOWN:13,LEFT:14,RIGHT:15,HOME:16,EXTRA_1:17,EXTRA_2:18,EXTRA_3:19,EXTRA_4:20}};function bindGamepad(t,e,n){if(!getBindingKey(n))throw new Error("no action defined for keycode "+n);void 0===updateEventHandler&&"function"==typeof navigator.getGamepads&&(updateEventHandler=on(GAME_BEFORE_UPDATE,updateGamepads)),bindings[t]||(bindings[t]={axes:{},buttons:{}});var r={keyCode:n,value:0,pressed:!1,threshold:e.threshold},i=bindings[t][e.type];if("buttons"===e.type)i[e.code]=r;else if("axes"===e.type){var o=Math.sign(e.threshold)||1;i[e.code]||(i[e.code]={});var a=i[e.code];a[o]=r,a[-o]||(a[-o]={keyCode:0,value:0,pressed:!1,threshold:-o})}}function unbindGamepad(t,e){if(!bindings[t])throw new Error("no bindings for gamepad "+t);bindings[t].buttons[e]={}}function setGamepadDeadzone(t){deadzone=t}for(var setGamepadMapping=addMapping,preventDefault=!0,input=Object.freeze({__proto__:null,preventDefault,get pointerEventTarget(){return pointerEventTarget},pointer,get locked(){return locked},get throttlingInterval(){return throttlingInterval},globalToLocal,setTouchAction,bindPointer,unbindPointer,registerPointerEvent,releasePointerEvent,releaseAllPointerEvents,requestPointerLock,exitPointerLock,get keyBoardEventTarget(){return keyBoardEventTarget},KEY,initKeyboardEvent,isKeyPressed,keyStatus,triggerKeyEvent,bindKey,getBindingKey,unlockKey,unbindKey,GAMEPAD,bindGamepad,unbindGamepad,setGamepadDeadzone,setGamepadMapping}),Renderable=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i,o){var a;return _classCallCheck(this,n),(a=e.call(this,t,r,i,o)).isRenderable=!0,a.isKinematic=!0,a.body=void 0,void 0===a.currentTransform&&(a.currentTransform=pool$1.pull("Matrix2d")),a.currentTransform.identity(),a.GUID=void 0,a.onVisibilityChange=void 0,a.alwaysUpdate=!1,a.updateWhenPaused=!1,a.isPersistent=!1,a.floating=!1,a.anchorPoint instanceof ObservableVector2d?a.anchorPoint.setMuted(.5,.5).setCallback(a.onAnchorUpdate,_assertThisInitialized(a)):a.anchorPoint=pool$1.pull("ObservableVector2d",.5,.5,{onUpdate:a.onAnchorUpdate,scope:_assertThisInitialized(a)}),a.autoTransform=!0,a.alpha=1,a.ancestor=void 0,a.mask=void 0,a.tint=pool$1.pull("Color",255,255,255,1),a.blendMode="normal",a.name="",a.pos instanceof ObservableVector3d?a.pos.setMuted(t,r,0).setCallback(a.updateBoundsPos,_assertThisInitialized(a)):a.pos=pool$1.pull("ObservableVector3d",t,r,0,{onUpdate:a.updateBoundsPos,scope:_assertThisInitialized(a)}),a.isDirty=!1,a._flip={x:!1,y:!1},a._inViewport=!1,a.setOpacity(1),a}return _createClass(n,[{key:"isFloating",get:function(){return!0===this.floating||void 0!==this.ancestor&&!0===this.ancestor.floating}},{key:"inViewport",get:function(){return this._inViewport},set:function(t){this._inViewport!==t&&(this._inViewport=t,"function"==typeof this.onVisibilityChange&&this.onVisibilityChange.call(this,t))}},{key:"isFlippedX",get:function(){return!0===this._flip.x}},{key:"isFlippedY",get:function(){return!0===this._flip.y}},{key:"getBounds",value:function(){return void 0===this._bounds&&(_get(_getPrototypeOf(n.prototype),"getBounds",this).call(this),this.isFinite()?this._bounds.setMinMax(this.pos.x,this.pos.y,this.pos.x+this.width,this.pos.y+this.height):this._bounds.setMinMax(this.pos.x,this.pos.y,this.width,this.height)),this._bounds}},{key:"getOpacity",value:function(){return this.alpha}},{key:"setOpacity",value:function(t){"number"==typeof t&&(this.alpha=_clamp(t,0,1),isNaN(this.alpha)&&(this.alpha=1),this.isDirty=!0)}},{key:"flipX",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._flip.x=!!t,this.isDirty=!0,this}},{key:"flipY",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._flip.y=!!t,this.isDirty=!0,this}},{key:"transform",value:function(t){return this.currentTransform.multiply(t),this.updateBoundsPos(this.pos.x,this.pos.y),this.isDirty=!0,this}},{key:"angleTo",value:function(t){var e,r,i=this.getBounds();if(t instanceof n){var o=t.getBounds();e=o.centerX-i.centerX,r=o.centerY-i.centerY}else e=t.x-i.centerX,r=t.y-i.centerY;return Math.atan2(r,e)}},{key:"distanceTo",value:function(t){var e,r,i=this.getBounds();if(t instanceof n){var o=t.getBounds();e=i.centerX-o.centerX,r=i.centerY-o.centerY}else e=i.centerX-t.x,r=i.centerY-t.y;return Math.sqrt(e*e+r*r)}},{key:"lookAt",value:function(t){var e;e=t instanceof n?t.pos:t;var r=this.angleTo(e);return this.rotate(r),this}},{key:"rotate",value:function(t,e){return isNaN(t)||(this.currentTransform.rotate(t,e),this.isDirty=!0),this}},{key:"scale",value:function(t,e){return this.currentTransform.scale(t,e),_get(_getPrototypeOf(n.prototype),"scale",this).call(this,t,e),this.isDirty=!0,this}},{key:"scaleV",value:function(t){return this.scale(t.x,t.y),this}},{key:"update",value:function(t){return this.isDirty}},{key:"updateBounds",value:function(){return _get(_getPrototypeOf(n.prototype),"updateBounds",this).call(this),this.updateBoundsPos(this.pos.x,this.pos.y),this.getBounds()}},{key:"updateBoundsPos",value:function(t,e){var n=this.getBounds();n.shift(t,e),void 0!==this.anchorPoint&&n.isFinite()&&n.translate(-this.anchorPoint.x*n.width,-this.anchorPoint.y*n.height),this.ancestor instanceof Container&&!0!==this.floating&&n.translate(this.ancestor.getAbsolutePosition())}},{key:"getAbsolutePosition",value:function(){return void 0===this._absPos&&(this._absPos=pool$1.pull("Vector2d")),this._absPos.set(this.pos.x,this.pos.y),this.ancestor instanceof Container&&!0!==this.floating&&this._absPos.add(this.ancestor.getAbsolutePosition()),this._absPos}},{key:"onAnchorUpdate",value:function(t,e){this.anchorPoint.setMuted(t,e),this.updateBoundsPos(this.pos.x,this.pos.y)}},{key:"preDraw",value:function(t){var e=this.getBounds(),n=e.width*this.anchorPoint.x,r=e.height*this.anchorPoint.y;if(t.save(),t.setGlobalAlpha(t.globalAlpha()*this.getOpacity()),this._flip.x||this._flip.y){var i=this._flip.x?this.centerX-n:0,o=this._flip.y?this.centerY-r:0;t.translate(i,o),t.scale(this._flip.x?-1:1,this._flip.y?-1:1),t.translate(-i,-o)}void 0!==this.mask&&(t.translate(this.pos.x,this.pos.y),t.setMask(this.mask),t.translate(-this.pos.x,-this.pos.y)),!0!==this.autoTransform||this.currentTransform.isIdentity()||(t.translate(this.pos.x,this.pos.y),t.transform(this.currentTransform),t.translate(-this.pos.x,-this.pos.y)),t.translate(-n,-r),t.setTint(this.tint,this.getOpacity()),this.blendMode!==t.getBlendMode()&&t.setBlendMode(this.blendMode)}},{key:"draw",value:function(t){}},{key:"postDraw",value:function(t){t.clearTint(),void 0!==this.mask&&t.clearMask(),t.restore(),this.isDirty=!1}},{key:"onCollision",value:function(){return!1}},{key:"destroy",value:function(){pool$1.push(this.currentTransform),this.currentTransform=void 0,pool$1.push(this.anchorPoint),this.anchorPoint=void 0,pool$1.push(this.pos),this.pos=void 0,void 0!==this._absPos&&(pool$1.push(this._absPos),this._absPos=void 0),pool$1.push(this._bounds),this._bounds=void 0,this.onVisibilityChange=void 0,void 0!==this.mask&&(pool$1.push(this.mask),this.mask=void 0),void 0!==this.tint&&(pool$1.push(this.tint),this.tint=void 0),this.ancestor=void 0,void 0!==this.body&&(this.body.destroy.apply(this.body,arguments),this.body=void 0),releaseAllPointerEvents(this),this.onDestroyEvent.apply(this,arguments)}},{key:"onDestroyEvent",value:function(){}}]),n}(Rect),Ellipse=function(){function t(e,n,r,i){_classCallCheck(this,t),this.pos=pool$1.pull("Vector2d"),this._bounds=void 0,this.radius=NaN,this.radiusV=pool$1.pull("Vector2d"),this.radiusSq=pool$1.pull("Vector2d"),this.ratio=pool$1.pull("Vector2d"),this.shapeType="Ellipse",this.setShape(e,n,r,i)}return _createClass(t,[{key:"onResetEvent",value:function(t,e,n,r){this.setShape(t,e,n,r)}},{key:"setShape",value:function(t,e,n,r){var i=n/2,o=r/2;this.pos.set(t,e),this.radius=Math.max(i,o),this.ratio.set(i/this.radius,o/this.radius),this.radiusV.set(this.radius,this.radius).scaleV(this.ratio);var a=this.radius*this.radius;return this.radiusSq.set(a,a).scaleV(this.ratio),this.getBounds().setMinMax(t,e,t+n,t+r),this.getBounds().translate(-this.radiusV.x,-this.radiusV.y),this}},{key:"rotate",value:function(t,e){return this.pos.rotate(t,e),this.getBounds().shift(this.pos),this.getBounds().translate(-this.radiusV.x,-this.radiusV.y),this}},{key:"scale",value:function(t,e){return e=void 0!==e?e:t,this.setShape(this.pos.x,this.pos.y,2*this.radiusV.x*t,2*this.radiusV.y*e)}},{key:"scaleV",value:function(t){return this.scale(t.x,t.y)}},{key:"transform",value:function(){return this}},{key:"translate",value:function(){var t,e;return 2===arguments.length?(t=arguments[0],e=arguments[1]):(t=arguments[0].x,e=arguments[0].y),this.pos.x+=t,this.pos.y+=e,this.getBounds().translate(t,e),this}},{key:"contains",value:function(){var t,e;return 2===arguments.length?(t=arguments[0],e=arguments[1]):(t=arguments[0].x,e=arguments[0].y),t-=this.pos.x,e-=this.pos.y,t*t/this.radiusSq.x+e*e/this.radiusSq.y<=1}},{key:"getBounds",value:function(){return void 0===this._bounds&&(this._bounds=pool$1.pull("Bounds")),this._bounds}},{key:"clone",value:function(){return new t(this.pos.x,this.pos.y,2*this.radiusV.x,2*this.radiusV.y)}}]),t}(),LEFT_VORNOI_REGION=-1,MIDDLE_VORNOI_REGION=0,RIGHT_VORNOI_REGION=1,T_VECTORS=[],v=0;v<10;v++)T_VECTORS.push(new Vector2d);for(var T_ARRAYS=[],a=0;a<5;a++)T_ARRAYS.push([]);function flattenPointsOn(t,e,n){for(var r=Number.MAX_VALUE,i=-Number.MAX_VALUE,o=t.length,a=0;a<o;a++){var s=t[a].dot(e);s<r&&(r=s),s>i&&(i=s)}n[0]=r,n[1]=i}function isSeparatingAxis(t,e,n,r,i,o){var a=T_ARRAYS.pop(),s=T_ARRAYS.pop(),l=T_VECTORS.pop().copy(e).sub(t),u=l.dot(i);if(flattenPointsOn(n,i,a),flattenPointsOn(r,i,s),s[0]+=u,s[1]+=u,a[0]>s[1]||s[0]>a[1])return T_VECTORS.push(l),T_ARRAYS.push(a),T_ARRAYS.push(s),!0;if(o){var c=0;if(a[0]<s[0])if(o.aInB=!1,a[1]<s[1])c=a[1]-s[0],o.bInA=!1;else{var h=a[1]-s[0],f=s[1]-a[0];c=h<f?h:-f}else if(o.bInA=!1,a[1]>s[1])c=a[0]-s[1],o.aInB=!1;else{var d=a[1]-s[0],p=s[1]-a[0];c=d<p?d:-p}var y=Math.abs(c);y<o.overlap&&(o.overlap=y,o.overlapN.copy(i),c<0&&o.overlapN.negateSelf())}return T_VECTORS.push(l),T_ARRAYS.push(a),T_ARRAYS.push(s),!1}function vornoiRegion(t,e){var n=t.length2(),r=e.dot(t);return r<0?LEFT_VORNOI_REGION:r>n?RIGHT_VORNOI_REGION:MIDDLE_VORNOI_REGION}function testPolygonPolygon(t,e,n,r,i){var o,a=e.points,s=e.normals,l=s.length,u=r.points,c=r.normals,h=c.length,f=T_VECTORS.pop().copy(t.pos).add(t.ancestor.getAbsolutePosition()).add(e.pos),d=T_VECTORS.pop().copy(n.pos).add(n.ancestor.getAbsolutePosition()).add(r.pos);for(o=0;o<l;o++)if(isSeparatingAxis(f,d,a,u,s[o],i))return T_VECTORS.push(f),T_VECTORS.push(d),!1;for(o=0;o<h;o++)if(isSeparatingAxis(f,d,a,u,c[o],i))return T_VECTORS.push(f),T_VECTORS.push(d),!1;return i&&(i.a=t,i.b=n,i.overlapV.copy(i.overlapN).scale(i.overlap)),T_VECTORS.push(f),T_VECTORS.push(d),!0}function testEllipseEllipse(t,e,n,r,i){var o=T_VECTORS.pop().copy(n.pos).add(n.ancestor.getAbsolutePosition()).add(r.pos).sub(t.pos).add(t.ancestor.getAbsolutePosition()).sub(e.pos),a=e.radius,s=r.radius,l=a+s,u=l*l,c=o.length2();if(c>u)return T_VECTORS.push(o),!1;if(i){var h=Math.sqrt(c);i.a=t,i.b=n,i.overlap=l-h,i.overlapN.copy(o.normalize()),i.overlapV.copy(o).scale(i.overlap),i.aInB=a<=s&&h<=s-a,i.bInA=s<=a&&h<=a-s}return T_VECTORS.push(o),!0}function testPolygonEllipse(t,e,n,r,i){for(var o=T_VECTORS.pop().copy(n.pos).add(n.ancestor.getAbsolutePosition()).add(r.pos).sub(t.pos).add(t.ancestor.getAbsolutePosition()).sub(e.pos),a=r.radius,s=a*a,l=e.points,u=e.edges,c=u.length,h=T_VECTORS.pop(),f=T_VECTORS.pop(),d=T_VECTORS.pop(),p=0,y=0;y<c;y++){var v=y===c-1?0:y+1,g=0===y?c-1:y-1,m=0,_=null;h.copy(u[y]),d.copy(o).sub(l[y]),i&&d.length2()>s&&(i.aInB=!1);var b=vornoiRegion(h,d),x=!0;if(b===LEFT_VORNOI_REGION){var w=null;if(c>1&&(h.copy(u[g]),(b=vornoiRegion(h,w=T_VECTORS.pop().copy(o).sub(l[g])))!==RIGHT_VORNOI_REGION&&(x=!1)),x){if((p=d.length())>a)return T_VECTORS.push(o),T_VECTORS.push(h),T_VECTORS.push(f),T_VECTORS.push(d),w&&T_VECTORS.push(w),!1;i&&(i.bInA=!1,_=d.normalize(),m=a-p)}w&&T_VECTORS.push(w)}else if(b===RIGHT_VORNOI_REGION){if(c>1&&(h.copy(u[v]),d.copy(o).sub(l[v]),(b=vornoiRegion(h,d))!==LEFT_VORNOI_REGION&&(x=!1)),x){if((p=d.length())>a)return T_VECTORS.push(o),T_VECTORS.push(h),T_VECTORS.push(f),T_VECTORS.push(d),!1;i&&(i.bInA=!1,_=d.normalize(),m=a-p)}}else{f.copy(e.normals[y]),p=d.dot(f);var T=Math.abs(p);if((1===c||p>0)&&T>a)return T_VECTORS.push(o),T_VECTORS.push(h),T_VECTORS.push(f),T_VECTORS.push(d),!1;i&&(_=f,m=a-p,(p>=0||m<2*a)&&(i.bInA=!1))}_&&i&&Math.abs(m)<Math.abs(i.overlap)&&(i.overlap=m,i.overlapN.copy(_))}return i&&(i.a=t,i.b=n,i.overlapV.copy(i.overlapN).scale(i.overlap)),T_VECTORS.push(o),T_VECTORS.push(h),T_VECTORS.push(f),T_VECTORS.push(d),!0}function testEllipsePolygon(t,e,n,r,i){var o=this.testPolygonEllipse(n,r,t,e,i);if(o&&i){var a=i.a,s=i.aInB;i.overlapN.negateSelf(),i.overlapV.negateSelf(),i.a=i.b,i.b=a,i.aInB=i.bInA,i.bInA=s}return o}var SAT=Object.freeze({__proto__:null,testPolygonPolygon,testEllipseEllipse,testPolygonEllipse,testEllipsePolygon}),dummyObj={pos:new Vector2d(0,0),ancestor:{_absPos:new Vector2d(0,0),getAbsolutePosition:function(){return this._absPos}}};function shouldCollide(t,e){return!0!==t.isKinematic&&!0!==e.isKinematic&&"object"===_typeof(t.body)&&"object"===_typeof(e.body)&&!(!0===t.body.isStatic&&!0===e.body.isStatic)&&0!=(t.body.collisionMask&e.body.collisionType)&&0!=(t.body.collisionType&e.body.collisionMask)}var ResponseObject=function(){function t(){_classCallCheck(this,t),this.a=null,this.b=null,this.overlapN=new Vector2d,this.overlapV=new Vector2d,this.aInB=!0,this.bInA=!0,this.indexShapeA=-1,this.indexShapeB=-1,this.overlap=Number.MAX_VALUE}return _createClass(t,[{key:"clear",value:function(){return this.aInB=!0,this.bInA=!0,this.overlap=Number.MAX_VALUE,this.indexShapeA=-1,this.indexShapeB=-1,this}}]),t}(),globalResponse=new ResponseObject;function collisionCheck(t){for(var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:globalResponse,r=0,i=world.broadphase.retrieve(t),o=i.length;e=i[--o];)if(e!==t&&shouldCollide(t,e)&&t.body.getBounds().overlaps(e.body.getBounds())){var a=t.body.shapes.length,s=e.body.shapes.length;if(0===a||0===s)continue;var l=0;do{var u=t.body.getShape(l),c=0;do{var h=e.body.getShape(c);!0===SAT["test"+u.shapeType+h.shapeType].call(this,t,u,e,h,n.clear())&&(r++,n.indexShapeA=l,n.indexShapeB=c,t.onCollision&&!1!==t.onCollision(n,e)&&!1===t.body.isStatic&&t.body.respondToCollision.call(t.body,n),e.onCollision&&!1!==e.onCollision(n,t)&&!1===e.body.isStatic&&e.body.respondToCollision.call(e.body,n)),c++}while(c<s);l++}while(l<a)}return r>0}function _rayCast(t){for(var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=0,i=world.broadphase.retrieve(t),o=i.length;e=i[--o];)if(e.body&&t.getBounds().overlaps(e.getBounds())){var a=e.body.shapes.length;if(0===e.body.shapes.length)continue;var s=t,l=0;do{var u=e.body.getShape(l);SAT["test"+s.shapeType+u.shapeType].call(this,dummyObj,s,e,u)&&(n[r]=e,r++),l++}while(l<a)}return n.length=r,n}var collision={maxChildren:8,maxDepth:4,types:{NO_OBJECT:0,PLAYER_OBJECT:1,NPC_OBJECT:2,ENEMY_OBJECT:4,COLLECTABLE_OBJECT:8,ACTION_OBJECT:16,PROJECTILE_OBJECT:32,WORLD_SHAPE:64,USER:128,ALL_OBJECT:4294967295},response:globalResponse,rayCast:function(t,e){return _rayCast(t,e)}},Body=function(){function t(e,n,r){if(_classCallCheck(this,t),this.ancestor=e,void 0===this.bounds&&(this.bounds=pool$1.pull("Bounds")),void 0===this.shapes&&(this.shapes=[]),this.collisionMask=collision.types.ALL_OBJECT,this.collisionType=collision.types.ENEMY_OBJECT,void 0===this.vel&&(this.vel=pool$1.pull("Vector2d")),this.vel.set(0,0),void 0===this.force&&(this.force=pool$1.pull("Vector2d")),this.force.set(0,0),void 0===this.friction&&(this.friction=pool$1.pull("Vector2d")),this.friction.set(0,0),this.bounce=0,this.mass=1,void 0===this.maxVel&&(this.maxVel=pool$1.pull("Vector2d")),this.maxVel.set(490,490),this.isStatic=!1,this.gravityScale=1,this.ignoreGravity=!1,this.falling=!1,this.jumping=!1,"function"==typeof r&&(this.onBodyUpdate=r),this.bounds.clear(),void 0!==n)if(Array.isArray(n))for(var i=0;i<n.length;i++)this.addShape(n[i]);else this.addShape(n);this.ancestor.isKinematic=!1}return _createClass(t,[{key:"setStatic",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.isStatic=!0===t}},{key:"addShape",value:function(t){if(t instanceof Rect||t instanceof Bounds$1){var e=t.toPolygon();this.shapes.push(e),this.bounds.add(e.points),this.bounds.translate(e.pos)}else t instanceof Ellipse?(this.shapes.includes(t)||this.shapes.push(t),this.bounds.addBounds(t.getBounds()),this.bounds.translate(t.getBounds().x,t.getBounds().y)):t instanceof Polygon?(this.shapes.includes(t)||this.shapes.push(t),this.bounds.add(t.points),this.bounds.translate(t.pos)):this.fromJSON(t);return"function"==typeof this.onBodyUpdate&&this.onBodyUpdate(this),this.shapes.length}},{key:"setVertices",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=this.getShape(e);r instanceof Polygon?r.setShape(0,0,t):this.shapes[e]=pool$1.pull("Polygon",0,0,t),this.bounds.add(this.shapes[e].points,n),"function"==typeof this.onBodyUpdate&&this.onBodyUpdate(this)}},{key:"addVertices",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.setVertices(t,e,!1)}},{key:"fromJSON",value:function(t,e){var n=t;if(void 0!==e&&(n=t[e]),void 0===n)throw new Error("Identifier ("+e+") undefined for the given JSON object)");if(n.length){for(var r=0;r<n.length;r++)this.addVertices(n[r].shape,r);this.mass=n[0].density||0,this.friction.set(n[0].friction||0,n[0].friction||0),this.bounce=n[0].bounce||0}return n.length}},{key:"getShape",value:function(t){return this.shapes[t||0]}},{key:"getBounds",value:function(){return this.bounds}},{key:"removeShape",value:function(t){this.bounds.clear(),_remove(this.shapes,t);for(var e=0;e<this.shapes.length;e++)this.addShape(this.shapes[e]);return this.shapes.length}},{key:"removeShapeAt",value:function(t){return this.removeShape(this.getShape(t))}},{key:"setCollisionMask",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:collision.types.ALL_OBJECT;this.collisionMask=t}},{key:"setCollisionType",value:function(t){if(void 0!==t){if(void 0===collision.types[t])throw new Error("Invalid value for the collisionType property");this.collisionType=collision.types[t]}}},{key:"respondToCollision",value:function(t){var e=t.overlapV;if(this.ancestor.pos.sub(e),0!==e.x&&(this.vel.x=~~(.5+this.vel.x-e.x)||0,this.bounce>0&&(this.vel.x*=-this.bounce)),0!==e.y){this.vel.y=~~(.5+this.vel.y-e.y)||0,this.bounce>0&&(this.vel.y*=-this.bounce);var n=Math.sign(world.gravity.y*this.gravityScale)||1;this.falling=e.y>=n,this.jumping=e.y<=-n}}},{key:"forEach",value:function(t,e){var n=this,r=0,i=this.shapes,o=i.length;if("function"!=typeof t)throw new Error(t+" is not a function");for(arguments.length>1&&(n=e);r<o;)t.call(n,i[r],r,i),r++}},{key:"contains",value:function(){var t,e;if(2===arguments.length?(t=arguments[0],e=arguments[1]):(t=arguments[0].x,e=arguments[0].y),this.getBounds().contains(t,e))for(var n,r=this.shapes.length;r--,n=this.shapes[r];)if(n.contains(t,e))return!0;return!1}},{key:"rotate",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getBounds().center;return this.bounds.clear(),this.forEach((function(r){r.rotate(t,n),e.bounds.addBounds(r.getBounds()),r instanceof Ellipse?e.bounds.translate(r.getBounds().x,r.getBounds().y):e.bounds.translate(r.pos)})),this}},{key:"setMaxVelocity",value:function(t,e){this.maxVel.x=t,this.maxVel.y=e}},{key:"setFriction",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.friction.x=t,this.friction.y=e}},{key:"computeVelocity",value:function(){var t=timer$1.tick;if(!this.ignoreGravity){var e=world.gravity;this.vel.x+=e.x*this.gravityScale*t,this.vel.y+=e.y*this.gravityScale*t,this.falling=this.vel.y*Math.sign(e.y*this.gravityScale)>0,this.jumping=!this.falling&&this.jumping}if(0!==this.force.x&&(this.vel.x+=this.force.x*t),0!==this.force.y&&(this.vel.y+=this.force.y*t),this.friction.x>0){var n=this.friction.x*t,r=this.vel.x+n,i=this.vel.x-n;this.vel.x=r<0?r:i>0?i:0}if(this.friction.y>0){var o=this.friction.y*t,a=this.vel.y+o,s=this.vel.y-o;this.vel.y=a<0?a:s>0?s:0}0!==this.vel.y&&(this.vel.y=_clamp(this.vel.y,-this.maxVel.y,this.maxVel.y)),0!==this.vel.x&&(this.vel.x=_clamp(this.vel.x,-this.maxVel.x,this.maxVel.x))}},{key:"update",value:function(t){return this.computeVelocity(t),this.ancestor.pos.add(this.vel),0!==this.vel.x||0!==this.vel.y}},{key:"destroy",value:function(){pool$1.push(this.bounds),pool$1.push(this.vel),pool$1.push(this.force),pool$1.push(this.friction),pool$1.push(this.maxVel),this.shapes.forEach((function(t){pool$1.push(t)})),this.onBodyUpdate=void 0,this.ancestor=void 0,this.bounds=void 0,this.vel=void 0,this.force=void 0,this.friction=void 0,this.maxVel=void 0,this.shapes.length=0,this.setStatic(!1)}}]),t}(),deferredRemove=function(t,e){this.removeChildNow(t,e)},globalFloatingCounter=0,Container=function(t){_inherits(n,t);var e=_createSuper(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:viewport.width,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:viewport.height,s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return _classCallCheck(this,n),(t=e.call(this,r,i,o,a)).pendingSort=null,t.root=s,t.children=void 0,t.sortOn=sortOn,t.autoSort=!0,t.autoDepth=!0,t.clipping=!1,t.onChildChange=function(){},t.enableChildBoundsUpdate=!1,t.backgroundColor=pool$1.pull("Color",0,0,0,0),t.drawCount=0,t.autoTransform=!0,t.isKinematic=!1,t.anchorPoint.set(0,0),!0===t.root&&on(CANVAS_ONRESIZE,t.updateBounds.bind(_assertThisInitialized(t),!0)),t}return _createClass(n,[{key:"reset",value:function(){this.pendingSort&&(clearTimeout(this.pendingSort),this.pendingSort=null);for(var t,e=this.getChildren(),n=e.length;n>=0;t=e[--n])t&&!0!==t.isPersistent&&this.removeChildNow(t);void 0!==this.currentTransform&&this.currentTransform.identity(),this.backgroundColor.setColor(0,0,0,0)}},{key:"addChild",value:function(t,e){return t.ancestor instanceof n?t.ancestor.removeChildNow(t):t.isRenderable&&(t.GUID=utils.createGUID(t.id)),t.ancestor=this,this.getChildren().push(t),void 0!==t.pos&&("number"==typeof e?t.pos.z=e:!0===this.autoDepth&&(t.pos.z=this.getChildren().length)),!0===this.autoSort&&this.sort(),"function"==typeof t.onActivateEvent&&this.isAttachedToRoot()&&t.onActivateEvent(),!0===this.isAttachedToRoot()&&repaint(),this.enableChildBoundsUpdate&&this.updateBounds(!0),t.body instanceof Body&&world.addBody(t.body),this.onChildChange.call(this,this.getChildren().length-1),t}},{key:"addChildAt",value:function(t,e){if(e>=0&&e<this.getChildren().length)return t.ancestor instanceof n?t.ancestor.removeChildNow(t):t.isRenderable&&(t.GUID=utils.createGUID()),t.ancestor=this,this.getChildren().splice(e,0,t),"function"==typeof t.onActivateEvent&&this.isAttachedToRoot()&&t.onActivateEvent(),!0===this.isAttachedToRoot()&&repaint(),this.enableChildBoundsUpdate&&this.updateBounds(!0),t.body instanceof Body&&world.addBody(t.body),this.onChildChange.call(this,e),t;throw new Error("Index ("+e+") Out Of Bounds for addChildAt()")}},{key:"forEach",value:function(t,e){var n=this,r=0,i=this.getChildren(),o=i.length;if("function"!=typeof t)throw new Error(t+" is not a function");for(arguments.length>1&&(n=e);r<o;)t.call(n,i[r],r,i),r++}},{key:"swapChildren",value:function(t,e){var n=this.getChildIndex(t),r=this.getChildIndex(e);if(-1===n||-1===r)throw new Error(t+" Both the supplied childs must be a child of the caller "+this);var i=t.pos.z;t.pos.z=e.pos.z,e.pos.z=i,this.getChildren()[n]=e,this.getChildren()[r]=t,this.isDirty=!0}},{key:"getChildAt",value:function(t){if(t>=0&&t<this.getChildren().length)return this.getChildren()[t];throw new Error("Index ("+t+") Out Of Bounds for getChildAt()")}},{key:"getChildIndex",value:function(t){return this.getChildren().indexOf(t)}},{key:"getNextChild",value:function(t){var e=this.getChildren().indexOf(t)-1;if(e>=0&&e<this.getChildren().length)return this.getChildAt(e)}},{key:"hasChild",value:function(t){return this===t.ancestor}},{key:"getChildByProp",value:function(t,e){var r=[];return this.forEach((function(i){!function(t,n){var i=t[n];e instanceof RegExp&&"string"==typeof i?e.test(i)&&r.push(t):i===e&&r.push(t)}(i,t),i instanceof n&&(r=r.concat(i.getChildByProp(t,e)))})),r}},{key:"getChildByType",value:function(t){var e=[];return this.forEach((function(r){r instanceof t&&e.push(r),r instanceof n&&(e=e.concat(r.getChildByType(t)))})),e}},{key:"getChildByName",value:function(t){return this.getChildByProp("name",t)}},{key:"getChildByGUID",value:function(t){var e=this.getChildByProp("GUID",t);return e.length>0?e[0]:null}},{key:"getChildren",value:function(){return void 0===this.children&&(this.children=[]),this.children}},{key:"updateBounds",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];_get(_getPrototypeOf(n.prototype),"updateBounds",this).call(this);var e=this.getBounds();return!0!==t&&!0!==this.enableChildBoundsUpdate||this.forEach((function(t){t.isRenderable&&t.getBounds().isFinite()&&e.addBounds(t.getBounds())})),e}},{key:"isAttachedToRoot",value:function(){if(!0===this.root)return!0;for(var t=this.ancestor;t;){if(!0===t.root)return!0;t=t.ancestor}return!1}},{key:"updateBoundsPos",value:function(t,e){var r=this;return _get(_getPrototypeOf(n.prototype),"updateBoundsPos",this).call(this,t,e),this.forEach((function(n){n.isRenderable&&n.updateBoundsPos(n.pos.x+t-r.pos.x,n.pos.y+e-r.pos.y)})),this.getBounds()}},{key:"onActivateEvent",value:function(){this.forEach((function(t){"function"==typeof t.onActivateEvent&&t.onActivateEvent()}))}},{key:"removeChild",value:function(t,e){if(!this.hasChild(t))throw new Error("Child is not mine.");utils.function.defer(deferredRemove,this,t,e)}},{key:"removeChildNow",value:function(t,e){if(this.hasChild(t)&&this.getChildIndex(t)>=0){"function"==typeof t.onDeactivateEvent&&t.onDeactivateEvent(),t.body instanceof Body&&world.removeBody(t.body),e||!1===pool$1.push(t,!1)&&"function"==typeof t.destroy&&t.destroy();var n=this.getChildIndex(t);n>=0&&(this.getChildren().splice(n,1),t.ancestor=void 0),!0===this.isAttachedToRoot()&&repaint(),this.enableChildBoundsUpdate&&this.updateBounds(!0),this.onChildChange.call(this,n)}}},{key:"setChildsProperty",value:function(t,e,r){this.forEach((function(i){!0===r&&i instanceof n&&i.setChildsProperty(t,e,r),i[t]=e}))}},{key:"moveUp",value:function(t){var e=this.getChildIndex(t);e-1>=0&&(this.swapChildren(t,this.getChildAt(e-1)),this.isDirty=!0)}},{key:"moveDown",value:function(t){var e=this.getChildIndex(t);e>=0&&e+1<this.getChildren().length&&(this.swapChildren(t,this.getChildAt(e+1)),this.isDirty=!0)}},{key:"moveToTop",value:function(t){var e=this.getChildIndex(t);if(e>0){var n=this.getChildren();n.splice(0,0,n.splice(e,1)[0]),t.pos.z=n[1].pos.z+1,this.isDirty=!0}}},{key:"moveToBottom",value:function(t){var e=this.getChildIndex(t),n=this.getChildren();e>=0&&e<n.length-1&&(n.splice(n.length-1,0,n.splice(e,1)[0]),t.pos.z=n[n.length-2].pos.z-1,this.isDirty=!0)}},{key:"sort",value:function(t){this.pendingSort||(!0===t&&this.forEach((function(e){e instanceof n&&e.sort(t)})),this.pendingSort=utils.function.defer((function(){this.getChildren().sort(this["_sort"+this.sortOn.toUpperCase()]),this.pendingSort=null,repaint()}),this))}},{key:"onDeactivateEvent",value:function(){this.forEach((function(t){"function"==typeof t.onDeactivateEvent&&t.onDeactivateEvent()}))}},{key:"_sortZ",value:function(t,e){return e.pos&&t.pos?e.pos.z-t.pos.z:t.pos?-1/0:1/0}},{key:"_sortReverseZ",value:function(t,e){return t.pos&&e.pos?t.pos.z-e.pos.z:t.pos?1/0:-1/0}},{key:"_sortX",value:function(t,e){return e.pos&&t.pos?e.pos.z-t.pos.z||e.pos.x-t.pos.x:t.pos?-1/0:1/0}},{key:"_sortY",value:function(t,e){return e.pos&&t.pos?e.pos.z-t.pos.z||e.pos.y-t.pos.y:t.pos?-1/0:1/0}},{key:"destroy",value:function(){this.reset(),_get(_getPrototypeOf(n.prototype),"destroy",this).call(this,arguments)}},{key:"update",value:function(t){for(var e,r=!1,i=state.isPaused(),o=this.getChildren(),a=o.length;a--,e=o[a];)i&&!e.updateWhenPaused||(e.isRenderable?((r=globalFloatingCounter>0||e.floating)&&globalFloatingCounter++,e.inViewport=!1,state.current().cameras.forEach((function(t){t.isVisible(e,r)&&(e.inViewport=!0)})),this.isDirty|=(e.inViewport||e.alwaysUpdate)&&e.update(t),globalFloatingCounter>0&&globalFloatingCounter--):this.isDirty|=e.update(t));return _get(_getPrototypeOf(n.prototype),"update",this).call(this,t)}},{key:"draw",value:function(t,e){var n=!1,r=this.getBounds();this.drawCount=0,!1===this.root&&!0===this.clipping&&!0===r.isFinite()&&t.clipRect(r.left,r.top,r.width,r.height),t.translate(this.pos.x,this.pos.y),this.backgroundColor.alpha>1/255&&t.clearColor(this.backgroundColor);for(var i,o=this.getChildren(),a=o.length;i=o[--a];)i.isRenderable&&(n=!0===i.floating,(i.inViewport||n)&&(n&&(t.save(),t.resetTransform()),i.preDraw(t),i.draw(t,e),i.postDraw(t),n&&t.restore(),this.drawCount++))}}]),n}(Renderable),QT_ARRAY=[];function QT_ARRAY_POP(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(QT_ARRAY.length>0){var i=QT_ARRAY.pop();return i.bounds=t,i.max_objects=e,i.max_levels=n,i.level=r,i}return new QuadTree(t,e,n,r)}function QT_ARRAY_PUSH(t){QT_ARRAY.push(t)}var QT_VECTOR=new Vector2d,QuadTree=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;_classCallCheck(this,t),this.max_objects=n,this.max_levels=r,this.level=i,this.bounds=e,this.objects=[],this.nodes=[]}return _createClass(t,[{key:"split",value:function(){var t=this.level+1,e=this.bounds.width/2,n=this.bounds.height/2,r=this.bounds.left,i=this.bounds.top;this.nodes[0]=QT_ARRAY_POP({left:r+e,top:i,width:e,height:n},this.max_objects,this.max_levels,t),this.nodes[1]=QT_ARRAY_POP({left:r,top:i,width:e,height:n},this.max_objects,this.max_levels,t),this.nodes[2]=QT_ARRAY_POP({left:r,top:i+n,width:e,height:n},this.max_objects,this.max_levels,t),this.nodes[3]=QT_ARRAY_POP({left:r+e,top:i+n,width:e,height:n},this.max_objects,this.max_levels,t)}},{key:"getIndex",value:function(t){var e,n=t.getBounds(),r=-1,i=(e=!0===t.isFloating?viewport.localToWorld(n.left,n.top,QT_VECTOR):QT_VECTOR.set(t.left,t.top)).x,o=e.y,a=n.width,s=n.height,l=this.bounds.left+this.bounds.width/2,u=this.bounds.top+this.bounds.height/2,c=o<u&&o+s<u,h=o>u;return i<l&&i+a<l?c?r=1:h&&(r=2):i>l&&(c?r=0:h&&(r=3)),r}},{key:"insertContainer",value:function(t){for(var e,n=t.children.length;n--,e=t.children[n];)!0!==e.isKinematic&&(e instanceof Container?("rootContainer"!==e.name&&this.insert(e),this.insertContainer(e)):"function"==typeof e.getBounds&&this.insert(e))}},{key:"insert",value:function(t){var e=-1;if(this.nodes.length>0&&-1!==(e=this.getIndex(t)))this.nodes[e].insert(t);else if(this.objects.push(t),this.objects.length>this.max_objects&&this.level<this.max_levels){0===this.nodes.length&&this.split();for(var n=0;n<this.objects.length;)-1!==(e=this.getIndex(this.objects[n]))?this.nodes[e].insert(this.objects.splice(n,1)[0]):n+=1}}},{key:"retrieve",value:function(t,e){var n=this.objects;if(this.nodes.length>0){var r=this.getIndex(t);if(-1!==r)n=n.concat(this.nodes[r].retrieve(t));else for(var i=0;i<this.nodes.length;i+=1)n=n.concat(this.nodes[i].retrieve(t))}return"function"==typeof e&&n.sort(e),n}},{key:"remove",value:function(t){var e=!1;if(void 0===t.getBounds)return!1;if(this.nodes.length>0){var n=this.getIndex(t);-1!==n&&(e=_remove(this.nodes[n],t))&&this.nodes[n].isPrunable()&&this.nodes.splice(n,1)}return!1===e&&-1!==this.objects.indexOf(t)&&(_remove(this.objects,t),e=!0),e}},{key:"isPrunable",value:function(){return!(this.hasChildren()||this.objects.length>0)}},{key:"hasChildren",value:function(){for(var t=0;t<this.nodes.length;t+=1){var e=this.nodes[t];if(e.length>0||e.objects.length>0)return!0}return!1}},{key:"clear",value:function(t){this.objects.length=0;for(var e=0;e<this.nodes.length;e++)this.nodes[e].clear(),QT_ARRAY_PUSH(this.nodes[e]);this.nodes.length=0,void 0!==t&&this.bounds.setMinMax(t.min.x,t.min.y,t.max.x,t.max.y)}}]),t}(),World=function(t){_inherits(n,t);var e=_createSuper(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0;return _classCallCheck(this,n),(t=e.call(this,r,i,o,a,!0)).name="rootContainer",t.anchorPoint.set(0,0),t.fps=60,t.gravity=new Vector2d(0,.98),t.preRender=!1,t.bodies=new Set,t.broadphase=new QuadTree(t.getBounds().clone(),collision.maxChildren,collision.maxDepth),on(GAME_RESET,t.reset,_assertThisInitialized(t)),on(LEVEL_LOADED,(function(){t.broadphase.clear(t.getBounds())})),t}return _createClass(n,[{key:"reset",value:function(){this.broadphase.clear(),this.anchorPoint.set(0,0),_get(_getPrototypeOf(n.prototype),"reset",this).call(this),this.bodies.clear()}},{key:"addBody",value:function(t){return this.bodies.add(t),this}},{key:"removeBody",value:function(t){return this.bodies.delete(t),this}},{key:"update",value:function(t){var e=state.isPaused();return this.broadphase.clear(),this.broadphase.insertContainer(this),this.bodies.forEach((function(n){if(!n.isStatic){var r=n.ancestor;e&&!r.updateWhenPaused||!r.inViewport&&!r.alwaysUpdate||(!0===n.update(t)&&(r.isDirty=!0),collisionCheck(r))}})),_get(_getPrototypeOf(n.prototype),"update",this).call(this,t)}}]),n}(Container),isDirty=!0,isAlwaysDirty=!1,frameCounter=0,frameRate=1,accumulator=0,accumulatorMax=0,accumulatorUpdateDelta=0,stepSize=1e3/60,updateDelta=0,lastUpdateStart=null,updateAverageDelta=0,viewport,world;on(BOOT,(function(){world=new World,emit(GAME_INIT)}));var mergeGroup=!0,sortOn="z",lastUpdate=globalThis.performance.now();function onLevelLoaded(){}function _reset(){var t=state.current();void 0!==t&&(viewport=t.cameras.get("default")),emit(GAME_RESET),updateFrameRate()}function updateFrameRate(){frameCounter=0,frameRate=~~(.5+60/timer$1.maxfps),stepSize=1e3/world.fps,accumulator=0,accumulatorMax=10*stepSize,isAlwaysDirty=timer$1.maxfps>world.fps}function getParentContainer(t){return t.ancestor}function repaint(){isDirty=!0}function update$1(t,e){if(++frameCounter%frameRate==0){for(frameCounter=0,emit(GAME_BEFORE_UPDATE,t),accumulator+=timer$1.getDelta(),accumulator=Math.min(accumulator,accumulatorMax),updateDelta=timer$1.interpolation?timer$1.getDelta():stepSize,accumulatorUpdateDelta=timer$1.interpolation?updateDelta:Math.max(updateDelta,updateAverageDelta);accumulator>=accumulatorUpdateDelta||timer$1.interpolation;)if(lastUpdateStart=globalThis.performance.now(),!0!==state.isPaused()&&emit(GAME_UPDATE,t),isDirty=e.update(updateDelta)||isDirty,lastUpdate=globalThis.performance.now(),updateAverageDelta=lastUpdate-lastUpdateStart,accumulator-=accumulatorUpdateDelta,timer$1.interpolation){accumulator=0;break}emit(GAME_AFTER_UPDATE,lastUpdate)}}function draw(t){!0===renderer.isContextValid&&(isDirty||isAlwaysDirty)&&(emit(GAME_BEFORE_DRAW,globalThis.performance.now()),renderer.clear(),t.draw(renderer),isDirty=!1,renderer.flush(),emit(GAME_AFTER_DRAW,globalThis.performance.now()))}var game=Object.freeze({__proto__:null,get viewport(){return viewport},get world(){return world},mergeGroup,sortOn,get lastUpdate(){return lastUpdate},onLevelLoaded,reset:_reset,updateFrameRate,getParentContainer,repaint,update:update$1,draw}),MIN=Math.min,MAX=Math.max,targetV=new Vector2d,Camera2d=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i,o){var a;return _classCallCheck(this,n),(a=e.call(this,t,r,i-t,o-r)).AXIS={NONE:0,HORIZONTAL:1,VERTICAL:2,BOTH:3},a.bounds=pool$1.pull("Bounds"),a.smoothFollow=!0,a.damping=1,a.near=-1e3,a.far=1e3,a.projectionMatrix=new Matrix3d,a.invCurrentTransform=new Matrix2d,a.offset=new Vector2d,a.target=null,a.follow_axis=a.AXIS.NONE,a._shake={intensity:0,duration:0,axis:a.AXIS.BOTH,onComplete:null},a._fadeOut={color:null,tween:null},a._fadeIn={color:null,tween:null},a.name="default",a.setDeadzone(a.width/6,a.height/6),a.anchorPoint.set(0,0),a.isKinematic=!1,a.bounds.setMinMax(t,r,i,o),a._updateProjectionMatrix(),on(GAME_RESET,a.reset,_assertThisInitialized(a)),on(CANVAS_ONRESIZE,a.resize,_assertThisInitialized(a)),a}return _createClass(n,[{key:"_updateProjectionMatrix",value:function(){this.projectionMatrix.ortho(0,this.width,this.height,0,this.near,this.far)}},{key:"_followH",value:function(t){var e=this.pos.x;return t.x-this.pos.x>this.deadzone.right?e=MIN(t.x-this.deadzone.right,this.bounds.width-this.width):t.x-this.pos.x<this.deadzone.pos.x&&(e=MAX(t.x-this.deadzone.pos.x,this.bounds.left)),e}},{key:"_followV",value:function(t){var e=this.pos.y;return t.y-this.pos.y>this.deadzone.bottom?e=MIN(t.y-this.deadzone.bottom,this.bounds.height-this.height):t.y-this.pos.y<this.deadzone.pos.y&&(e=MAX(t.y-this.deadzone.pos.y,this.bounds.top)),e}},{key:"reset",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.pos.x=t,this.pos.y=e,this.unfollow(),this.smoothFollow=!0,this.damping=1,this.currentTransform.identity(),this.invCurrentTransform.identity().invert(),this._updateProjectionMatrix()}},{key:"setDeadzone",value:function(t,e){void 0===this.deadzone&&(this.deadzone=new Rect(0,0,0,0)),this.deadzone.pos.set(~~((this.width-t)/2),~~((this.height-e)/2-.25*e)),this.deadzone.resize(t,e),this.smoothFollow=!1,this.updateTarget(),this.smoothFollow=!0}},{key:"resize",value:function(t,e){return _get(_getPrototypeOf(n.prototype),"resize",this).call(this,t,e),this.smoothFollow=!1,this.setBounds(0,0,t,e),this.setDeadzone(t/6,e/6),this.update(),this.smoothFollow=!0,this._updateProjectionMatrix(),emit(VIEWPORT_ONRESIZE,this.width,this.height),this}},{key:"setBounds",value:function(t,e,n,r){this.smoothFollow=!1,this.bounds.setMinMax(t,e,n+t,r+e),this.moveTo(this.pos.x,this.pos.y),this.update(),this.smoothFollow=!0}},{key:"follow",value:function(t,e,n){if(t instanceof Renderable)this.target=t.pos;else{if(!(t instanceof Vector2d||t instanceof Vector3d||t instanceof ObservableVector2d||t instanceof ObservableVector3d))throw new Error("invalid target for me.Camera2d.follow");this.target=t}this.follow_axis=void 0===e?this.AXIS.BOTH:e,this.smoothFollow=!1,this.damping="number"!=typeof n?1:_clamp(n,0,1),this.updateTarget(),this.smoothFollow=!0}},{key:"unfollow",value:function(){this.target=null,this.follow_axis=this.AXIS.NONE}},{key:"move",value:function(t,e){this.moveTo(this.pos.x+t,this.pos.y+e)}},{key:"moveTo",value:function(t,e){var n=this.pos.x,r=this.pos.y;this.pos.x=_clamp(t,this.bounds.left,this.bounds.width),this.pos.y=_clamp(e,this.bounds.top,this.bounds.height),n===this.pos.x&&r===this.pos.y||(this.isDirty=!0)}},{key:"updateTarget",value:function(){if(this.target){switch(targetV.setV(this.pos),this.follow_axis){case this.AXIS.NONE:break;case this.AXIS.HORIZONTAL:targetV.x=this._followH(this.target);break;case this.AXIS.VERTICAL:targetV.y=this._followV(this.target);break;case this.AXIS.BOTH:targetV.x=this._followH(this.target),targetV.y=this._followV(this.target)}if(!this.pos.equals(targetV)){if(!0===this.smoothFollow&&this.damping<1){if(toBeCloseTo(targetV.x,this.pos.x,2)&&toBeCloseTo(targetV.y,this.pos.y,2))return void this.pos.setV(targetV);this.pos.lerp(targetV,this.damping)}else this.pos.setV(targetV);this.isDirty=!0}}}},{key:"update",value:function(t){return this.updateTarget(t),this._shake.duration>0&&(this._shake.duration-=t,this._shake.duration<=0?(this._shake.duration=0,this.offset.setZero(),"function"==typeof this._shake.onComplete&&this._shake.onComplete()):(this._shake.axis!==this.AXIS.BOTH&&this._shake.axis!==this.AXIS.HORIZONTAL||(this.offset.x=(Math.random()-.5)*this._shake.intensity),this._shake.axis!==this.AXIS.BOTH&&this._shake.axis!==this.AXIS.VERTICAL||(this.offset.y=(Math.random()-.5)*this._shake.intensity)),this.isDirty=!0),!0===this.isDirty&&emit(VIEWPORT_ONCHANGE,this.pos),null==this._fadeIn.tween&&null==this._fadeOut.tween||(this.isDirty=!0),this.currentTransform.isIdentity()?this.invCurrentTransform.identity():this.invCurrentTransform.copy(this.currentTransform).invert(),_get(_getPrototypeOf(n.prototype),"update",this).call(this,t)}},{key:"shake",value:function(t,e,n,r,i){0!==this._shake.duration&&!0!==i||(this._shake.intensity=t,this._shake.duration=e,this._shake.axis=n||this.AXIS.BOTH,this._shake.onComplete="function"==typeof r?r:void 0)}},{key:"fadeOut",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3,n=arguments.length>2?arguments[2]:void 0;this._fadeOut.color=pool$1.pull("Color").copy(t),this._fadeOut.tween=pool$1.pull("Tween",this._fadeOut.color).to({alpha:0},e).onComplete(n||null),this._fadeOut.tween.isPersistent=!0,this._fadeOut.tween.start()}},{key:"fadeIn",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3,n=arguments.length>2?arguments[2]:void 0;this._fadeIn.color=pool$1.pull("Color").copy(t);var r=this._fadeIn.color.alpha;this._fadeIn.color.alpha=0,this._fadeIn.tween=pool$1.pull("Tween",this._fadeIn.color).to({alpha:r},e).onComplete(n||null),this._fadeIn.tween.isPersistent=!0,this._fadeIn.tween.start()}},{key:"focusOn",value:function(t){var e=t.getBounds();this.moveTo(t.pos.x+e.left+e.width/2,t.pos.y+e.top+e.height/2)}},{key:"isVisible",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.floating;return!0===e||!0===t.floating?renderer.overlaps(t.getBounds()):t.getBounds().overlaps(this)}},{key:"localToWorld",value:function(t,e,n){return(n=n||pool$1.pull("Vector2d")).set(t,e).add(this.pos).sub(world.pos),this.currentTransform.isIdentity()||this.invCurrentTransform.apply(n),n}},{key:"worldToLocal",value:function(t,e,n){return(n=n||pool$1.pull("Vector2d")).set(t,e),this.currentTransform.isIdentity()||this.currentTransform.apply(n),n.sub(this.pos).add(world.pos)}},{key:"drawFX",value:function(t){this._fadeIn.tween&&(t.save(),t.resetTransform(),t.setColor(this._fadeIn.color),t.fillRect(0,0,this.width,this.height),t.restore(),1===this._fadeIn.color.alpha&&(this._fadeIn.tween=null,pool$1.push(this._fadeIn.color),this._fadeIn.color=null)),this._fadeOut.tween&&(t.save(),t.resetTransform(),t.setColor(this._fadeOut.color),t.fillRect(0,0,this.width,this.height),t.restore(),0===this._fadeOut.color.alpha&&(this._fadeOut.tween=null,pool$1.push(this._fadeOut.color),this._fadeOut.color=null))}},{key:"draw",value:function(t,e){var n=this.pos.x+this.offset.x,r=this.pos.y+this.offset.y;e.currentTransform.translate(-n,-r),t.setProjection(this.projectionMatrix),t.clipRect(0,0,this.width,this.height),this.preDraw(t),e.preDraw(t),e.draw(t,this),this.drawFX(t),e.postDraw(t),this.postDraw(t),e.currentTransform.translate(n,r)}}]),n}(Renderable),default_camera,default_settings={cameras:[]},Stage=function(){function t(e){_classCallCheck(this,t),this.cameras=new Map,this.settings=Object.assign(default_settings,e||{})}return _createClass(t,[{key:"reset",value:function(){var t=this;if(this.settings.cameras.forEach((function(e){t.cameras.set(e.name,e)})),!1===this.cameras.has("default")){if(void 0===default_camera){var e=renderer.getWidth(),n=renderer.getHeight();default_camera=new Camera2d(0,0,e,n)}this.cameras.set("default",default_camera)}_reset(),this.onResetEvent.apply(this,arguments)}},{key:"update",value:function(t){var e=world.update(t);return this.cameras.forEach((function(n){n.update(t)&&(e=!0)})),e}},{key:"draw",value:function(t){this.cameras.forEach((function(e){e.draw(t,world)}))}},{key:"destroy",value:function(){this.cameras.clear(),this.onDestroyEvent.apply(this,arguments)}},{key:"onResetEvent",value:function(){"function"==typeof this.settings.onResetEvent&&this.settings.onResetEvent.apply(this,arguments)}},{key:"onDestroyEvent",value:function(){"function"==typeof this.settings.onDestroyEvent&&this.settings.onDestroyEvent.apply(this,arguments)}}]),t}(),ProgressBar=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i,o){var a;return _classCallCheck(this,n),(a=e.call(this,t,r,i,o)).barHeight=o,a.anchorPoint.set(0,0),on(LOADER_PROGRESS,a.onProgressUpdate,_assertThisInitialized(a)),on(VIEWPORT_ONRESIZE,a.resize,_assertThisInitialized(a)),a.anchorPoint.set(0,0),a.progress=0,a}return _createClass(n,[{key:"onProgressUpdate",value:function(t){this.progress=~~(t*this.width),this.isDirty=!0}},{key:"draw",value:function(t){t.setColor("black"),t.fillRect(this.pos.x,viewport.centerY,t.getWidth(),this.barHeight/2),t.setColor("#55aa00"),t.fillRect(this.pos.x,viewport.centerY,this.progress,this.barHeight/2)}},{key:"onDestroyEvent",value:function(){off(LOADER_PROGRESS,this.onProgressUpdate),off(VIEWPORT_ONRESIZE,this.resize)}}]),n}(Renderable),IconLogo=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r){var i;_classCallCheck(this,n),(i=e.call(this,t,r,100,85)).iconCanvas=createCanvas(renderer.WebGLVersion>1?i.width:nextPowerOfTwo(i.width),renderer.WebGLVersion>1?i.height:nextPowerOfTwo(i.height),!1);var o=renderer.getContext2d(i.iconCanvas);return o.beginPath(),o.moveTo(.7,48.9),o.bezierCurveTo(10.8,68.9,38.4,75.8,62.2,64.5),o.bezierCurveTo(86.1,53.1,97.2,27.7,87,7.7),o.lineTo(87,7.7),o.bezierCurveTo(89.9,15.4,73.9,30.2,50.5,41.4),o.bezierCurveTo(27.1,52.5,5.2,55.8,.7,48.9),o.lineTo(.7,48.9),o.closePath(),o.fillStyle="rgb(255, 255, 255)",o.fill(),o.beginPath(),o.moveTo(84,7),o.bezierCurveTo(87.6,14.7,72.5,30.2,50.2,41.6),o.bezierCurveTo(27.9,53,6.9,55.9,3.2,48.2),o.bezierCurveTo(-.5,40.4,14.6,24.9,36.9,13.5),o.bezierCurveTo(59.2,2.2,80.3,-.8,84,7),o.lineTo(84,7),o.closePath(),o.lineWidth=5.3,o.strokeStyle="rgb(255, 255, 255)",o.lineJoin="miter",o.miterLimit=4,o.stroke(),i.anchorPoint.set(.5,.5),i}return _createClass(n,[{key:"draw",value:function(t){t.drawImage(this.iconCanvas,t.getWidth()/2,this.pos.y)}}]),n}(Renderable),DefaultLoadingScreen=function(t){_inherits(n,t);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"onResetEvent",value:function(){world.backgroundColor.parseCSS("#202020"),world.addChild(new ProgressBar(0,renderer.getHeight()/2,renderer.getWidth(),8),1),world.addChild(new IconLogo(renderer.getWidth()/2,renderer.getHeight()/2-16-35),2);var t=pool$1.pull("Text",renderer.getWidth()/2,renderer.getHeight()/2+16,{font:"century gothic",size:32,fillStyle:"white",textAlign:"left",textBaseline:"top",text:"melon",offScreenCanvas:renderer.WebGLVersion>=1});t.anchorPoint.set(0,0);var e=pool$1.pull("Text",renderer.getWidth()/2,renderer.getHeight()/2+16,{font:"century gothic",size:32,fillStyle:"#55aa00",textAlign:"left",textBaseline:"top",bold:!0,text:"JS",offScreenCanvas:renderer.WebGLVersion>=1});e.anchorPoint.set(0,0);var n=t.getBounds().width+e.getBounds().width;t.pos.x=renderer.getWidth()/2-n/2,e.pos.x=t.pos.x+t.getBounds().width,world.addChild(t,2),world.addChild(e,2)}}]),n}(Stage),_state=-1,_animFrameId=-1,_isPaused=!1,_stages={},_fade={color:"",duration:0},_onSwitchComplete=null,_extraArgs=null,_pauseTime=0;function _startRunLoop(){-1===_animFrameId&&-1!==_state&&(timer$1.reset(),_animFrameId=globalThis.requestAnimationFrame(_renderFrame))}function _resumeRunLoop(){_isPaused&&-1!==_state&&(timer$1.reset(),_isPaused=!1)}function _pauseRunLoop(){_isPaused=!0}function _renderFrame(t){var e=_stages[_state].stage;update$1(t,e),draw(e),-1!==_animFrameId&&(_animFrameId=globalThis.requestAnimationFrame(_renderFrame))}function _stopRunLoop(){globalThis.cancelAnimationFrame(_animFrameId),_animFrameId=-1}function _switchState(t){_stopRunLoop(),_stages[_state]&&_stages[_state].stage.destroy(),_stages[t]&&(_stages[_state=t].stage.reset.apply(_stages[_state].stage,_extraArgs),_startRunLoop(),_onSwitchComplete&&_onSwitchComplete(),repaint())}on(BOOT,(function(){state.set(state.LOADING,new DefaultLoadingScreen),state.set(state.DEFAULT,new Stage),on(VIDEO_INIT,(function(){state.change(state.DEFAULT,!0)}))}));var state={LOADING:0,MENU:1,READY:2,PLAY:3,GAMEOVER:4,GAME_END:5,SCORE:6,CREDITS:7,SETTINGS:8,DEFAULT:9,USER:100,stop:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];_state!==this.LOADING&&this.isRunning()&&(_stopRunLoop(),!0===t&&t(),_pauseTime=globalThis.performance.now(),emit(STATE_STOP))},pause:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];_state===this.LOADING||this.isPaused()||(_pauseRunLoop(),!0===t&&pauseTrack(),_pauseTime=globalThis.performance.now(),emit(STATE_PAUSE))},restart:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.isRunning()||(_startRunLoop(),!0===t&&resumeTrack(),_pauseTime=globalThis.performance.now()-_pauseTime,repaint(),emit(STATE_RESTART,_pauseTime))},resume:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.isPaused()&&(_resumeRunLoop(),!0===t&&resumeTrack(),_pauseTime=globalThis.performance.now()-_pauseTime,emit(STATE_RESUME,_pauseTime))},isRunning:function(){return-1!==_animFrameId},isPaused:function(){return _isPaused},set:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!(e instanceof Stage))throw new Error(e+" is not an instance of me.Stage");_stages[t]={},_stages[t].stage=e,_stages[t].transition=!0,!0===n&&this.change(t)},current:function(){if(void 0!==_stages[_state])return _stages[_state].stage},transition:function(t,e,n){"fade"===t&&(_fade.color=e,_fade.duration=n)},setTransition:function(t,e){_stages[t].transition=e},change:function(t,e){if(void 0===_stages[t])throw new Error("Undefined Stage for state '"+t+"'");this.isCurrent(t)||(_extraArgs=null,arguments.length>1&&(_extraArgs=Array.prototype.slice.call(arguments,1)),_fade.duration&&_stages[t].transition?(_onSwitchComplete=function(){viewport.fadeOut(_fade.color,_fade.duration)},viewport.fadeIn(_fade.color,_fade.duration,(function(){defer(_switchState,this,t)}))):!0===e?_switchState(t):defer(_switchState,this,t))},isCurrent:function(t){return _state===t}};function setTMXValue(name,type,value){var match;if("string"!=typeof value)return value;switch(type){case"int":case"float":value=Number(value);break;case"bool":value="true"===value;break;default:if(!value||isBoolean(value))value=!value||"true"===value;else if(isNumeric(value))value=Number(value);else if(0===value.search(/^json:/i)){match=value.split(/^json:/i)[1];try{value=JSON.parse(match)}catch(t){throw new Error("Unable to parse JSON: "+match)}}else if(0===value.search(/^eval:/i)){match=value.split(/^eval:/i)[1];try{value=eval(match)}catch(t){throw new Error("Unable to evaluate: "+match)}}else((match=value.match(/^#([\da-fA-F])([\da-fA-F]{3})$/))||(match=value.match(/^#([\da-fA-F]{2})([\da-fA-F]{6})$/)))&&(value="#"+match[2]+match[1]);0===name.search(/^(ratio|anchorPoint)$/)&&"number"==typeof value&&(value={x:value,y:value})}return value}function parseAttributes(t,e){if(e.attributes&&e.attributes.length>0)for(var n=0;n<e.attributes.length;n++){var r=e.attributes.item(n);void 0!==r.name?t[r.name]=r.value:t[r.nodeName]=r.nodeValue}}function decompress(){throw new Error("GZIP/ZLIB compressed TMX Tile Map not supported!")}function decodeCSV(t){for(var e=t.replace("\n","").trim().split(","),n=[],r=0;r<e.length;r++)n.push(+e[r]);return n}function decodeBase64AsArray(t,e){var n,r,i;e=e||1;var o=globalThis.atob(t.replace(/[^A-Za-z0-9\+\/\=]/g,"")),a=new Uint32Array(o.length/e);for(n=0,i=o.length/e;n<i;n++)for(a[n]=0,r=e-1;r>=0;--r)a[n]+=o.charCodeAt(n*e+r)<<(r<<3);return a}function decode(t,e,n){switch(n=n||"none",e=e||"none"){case"csv":return decodeCSV(t);case"base64":var r=decodeBase64AsArray(t,4);return"none"===n?r:decompress();case"none":return t;case"xml":throw new Error("XML encoding is deprecated, use base64 instead");default:throw new Error("Unknown layer encoding: "+e)}}function normalize(t,e){var n=e.nodeName;switch(n){case"data":var r=parse(e);r.text=r.text||r.chunk.text,r.encoding=r.encoding||"xml",t.data=decode(r.text,r.encoding,r.compression),t.encoding="none";break;case"imagelayer":case"layer":case"objectgroup":case"group":var i=parse(e);i.type="layer"===n?"tilelayer":n,i.image&&(i.image=i.image.source),t.layers=t.layers||[],t.layers.push(i);break;case"animation":t.animation=parse(e).frames;break;case"frame":case"object":var o=n+"s";t[o]=t[o]||[],t[o].push(parse(e));break;case"tile":var a=parse(e);a.image&&(a.imagewidth=a.image.width,a.imageheight=a.image.height,a.image=a.image.source),t.tiles=t.tiles||{},t.tiles[a.id]=a;break;case"tileset":var s=parse(e);s.image&&(s.imagewidth=s.image.width,s.imageheight=s.image.height,s.image=s.image.source),t.tilesets=t.tilesets||[],t.tilesets.push(s);break;case"polygon":case"polyline":t[n]=[];for(var l,u=parse(e).points.split(" "),c=0;c<u.length;c++)l=u[c].split(","),t[n].push({x:+l[0],y:+l[1]});break;case"properties":t.properties=parse(e);break;case"property":var h=parse(e),f=void 0!==h.value?h.value:h.text;t[h.name]=setTMXValue(h.name,h.type||"string",f);break;default:t[n]=parse(e)}}function parse(t){var e={},n="";if(1===t.nodeType&&parseAttributes(e,t),t.hasChildNodes())for(var r=0;r<t.childNodes.length;r++){var i=t.childNodes.item(r);switch(i.nodeType){case 1:normalize(e,i);break;case 3:n+=i.nodeValue.trim()}}return n&&(e.text=n),e}function applyTMXProperties(t,e){var n=e.properties,r=e.propertytypes;if(void 0!==n)for(var i in n)if(n.hasOwnProperty(i)){var o="string",a=i,s=n[i];void 0!==n[i].name&&(a=n[i].name),void 0!==r?o=r[i]:void 0!==n[i].type&&(o=n[i].type),void 0!==n[i].value&&(s=n[i].value),t[a]=setTMXValue(a,o,s)}}var src={},arraymultimap={},multimap={},__generator=commonjsGlobal&&commonjsGlobal.__generator||function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},__values=commonjsGlobal&&commonjsGlobal.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},__read=commonjsGlobal&&commonjsGlobal.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a};Object.defineProperty(multimap,"__esModule",{value:!0}),multimap.Multimap=void 0;var Multimap=function(){function t(t,e){var n,r;if(this.size_=0,this.map=new Map,this.operator=t,e)try{for(var i=__values(e),o=i.next();!o.done;o=i.next()){var a=__read(o.value,2),s=a[0],l=a[1];this.put(s,l)}}catch(t){n={error:t}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return this}return Object.defineProperty(t.prototype,"size",{get:function(){return this.size_},enumerable:!1,configurable:!0}),t.prototype.get=function(t){var e=this.map.get(t);return e?this.operator.clone(e):this.operator.create()},t.prototype.put=function(t,e){var n=this.map.get(t);return n||(n=this.operator.create()),!!this.operator.add(e,n)&&(this.map.set(t,n),this.size_++,!0)},t.prototype.putAll=function(e,n){var r,i,o,a,s=0;if(n){var l=e,u=n;try{for(var c=__values(u),h=c.next();!h.done;h=c.next()){var f=h.value;this.put(l,f),s++}}catch(t){r={error:t}}finally{try{h&&!h.done&&(i=c.return)&&i.call(c)}finally{if(r)throw r.error}}}else{if(!(e instanceof t))throw new TypeError("unexpected arguments");try{for(var d=__values(e.entries()),p=d.next();!p.done;p=d.next()){var y=__read(p.value,2);l=y[0],f=y[1],this.put(l,f),s++}}catch(t){o={error:t}}finally{try{p&&!p.done&&(a=d.return)&&a.call(d)}finally{if(o)throw o.error}}}return s>0},t.prototype.has=function(t){return this.map.has(t)},t.prototype.hasEntry=function(t,e){return this.operator.has(e,this.get(t))},t.prototype.delete=function(t){return this.size_-=this.operator.size(this.get(t)),this.map.delete(t)},t.prototype.deleteEntry=function(t,e){var n=this.get(t);return!!this.operator.delete(e,n)&&(this.map.set(t,n),this.size_--,!0)},t.prototype.clear=function(){this.map.clear(),this.size_=0},t.prototype.keys=function(){return this.map.keys()},t.prototype.entries=function(){var t=this;return function(){var e,n,r,i,o,a,s,l,u,c,h,f,d,p;return __generator(this,(function(y){switch(y.label){case 0:y.trys.push([0,11,12,13]),e=__values(t.map.entries()),n=e.next(),y.label=1;case 1:if(n.done)return[3,10];r=__read(n.value,2),i=r[0],o=r[1],y.label=2;case 2:y.trys.push([2,7,8,9]),d=void 0,a=__values(o),s=a.next(),y.label=3;case 3:return s.done?[3,6]:(l=s.value,[4,[i,l]]);case 4:y.sent(),y.label=5;case 5:return s=a.next(),[3,3];case 6:return[3,9];case 7:return u=y.sent(),d={error:u},[3,9];case 8:try{s&&!s.done&&(p=a.return)&&p.call(a)}finally{if(d)throw d.error}return[7];case 9:return n=e.next(),[3,1];case 10:return[3,13];case 11:return c=y.sent(),h={error:c},[3,13];case 12:try{n&&!n.done&&(f=e.return)&&f.call(e)}finally{if(h)throw h.error}return[7];case 13:return[2]}}))}()},t.prototype.values=function(){var t=this;return function(){var e,n,r,i,o;return __generator(this,(function(a){switch(a.label){case 0:a.trys.push([0,5,6,7]),e=__values(t.entries()),n=e.next(),a.label=1;case 1:return n.done?[3,4]:[4,__read(n.value,2)[1]];case 2:a.sent(),a.label=3;case 3:return n=e.next(),[3,1];case 4:return[3,7];case 5:return r=a.sent(),i={error:r},[3,7];case 6:try{n&&!n.done&&(o=e.return)&&o.call(e)}finally{if(i)throw i.error}return[7];case 7:return[2]}}))}()},t.prototype.forEach=function(t,e){var n,r;try{for(var i=__values(this.entries()),o=i.next();!o.done;o=i.next()){var a=__read(o.value,2),s=a[0],l=a[1];t.call(void 0===e?this:e,l,s,this)}}catch(t){n={error:t}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}},t.prototype[Symbol.iterator]=function(){return this.entries()},t.prototype.asMap=function(){var t,e,n=new Map;try{for(var r=__values(this.keys()),i=r.next();!i.done;i=r.next()){var o=i.value;n.set(o,this.operator.clone(this.get(o)))}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}return n},t}();multimap.Multimap=Multimap;var __extends$1=commonjsGlobal&&commonjsGlobal.__extends||(_extendStatics=function(t,e){return _extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},_extendStatics(t,e)},function(t,e){function n(){this.constructor=t}_extendStatics(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),_extendStatics;Object.defineProperty(arraymultimap,"__esModule",{value:!0}),arraymultimap.ArrayMultimap=void 0;var multimap_1$1=multimap,ArrayMultimap=function(t){function e(e){return t.call(this,new ArrayOperator,e)||this}return __extends$1(e,t),Object.defineProperty(e.prototype,Symbol.toStringTag,{get:function(){return"ArrayMultimap"},enumerable:!1,configurable:!0}),e}(multimap_1$1.Multimap);arraymultimap.ArrayMultimap=ArrayMultimap;var ArrayOperator=function(){function t(){}return t.prototype.create=function(){return[]},t.prototype.clone=function(t){return t.slice()},t.prototype.add=function(t,e){return e.push(t),!0},t.prototype.size=function(t){return t.length},t.prototype.delete=function(t,e){var n=e.indexOf(t);return n>-1&&(e.splice(n,1),!0)},t.prototype.has=function(t,e){return e.includes(t)},t}(),setmultimap={},__extends=commonjsGlobal&&commonjsGlobal.__extends||(_extendStatics2=function(t,e){return _extendStatics2=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},_extendStatics2(t,e)},function(t,e){function n(){this.constructor=t}_extendStatics2(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),_extendStatics2;Object.defineProperty(setmultimap,"__esModule",{value:!0}),setmultimap.SetMultimap=void 0;var multimap_1=multimap,SetMultimap=function(t){function e(e){return t.call(this,new SetOperator,e)||this}return __extends(e,t),Object.defineProperty(e.prototype,Symbol.toStringTag,{get:function(){return"SetMultimap"},enumerable:!1,configurable:!0}),e}(multimap_1.Multimap);setmultimap.SetMultimap=SetMultimap;var SetOperator=function(){function t(){}return t.prototype.create=function(){return new Set},t.prototype.clone=function(t){return new Set(t)},t.prototype.add=function(t,e){var n=e.size;return e.add(t),n!==e.size},t.prototype.size=function(t){return t.size},t.prototype.delete=function(t,e){return e.delete(t)},t.prototype.has=function(t,e){return e.has(t)},t}();!function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.SetMultimap=t.ArrayMultimap=void 0;var e=arraymultimap;Object.defineProperty(t,"ArrayMultimap",{enumerable:!0,get:function(){return e.ArrayMultimap}});var n=setmultimap;Object.defineProperty(t,"SetMultimap",{enumerable:!0,get:function(){return n.SetMultimap}})}(src);var TextureCache=function(){function t(e){_classCallCheck(this,t),this.cache=new src.ArrayMultimap,this.tinted=new Map,this.units=new Map,this.max_size=e||1/0,this.clear()}return _createClass(t,[{key:"clear",value:function(){this.cache.clear(),this.tinted.clear(),this.units.clear(),this.length=0}},{key:"validate",value:function(){if(this.length>=this.max_size)throw new Error("Texture cache overflow: "+this.max_size+" texture units available for this GPU.")}},{key:"get",value:function(t,e){var n;return void 0===e?n=this.cache.get(t)[0]:this.cache.forEach((function(r,i){var o=r.getAtlas();i===t&&o[0].width===e.framewidth&&o[0].height===e.frameheight&&(n=r)})),void 0===n&&(e||(e=createAtlas(t.width,t.height,t.src?getBasename(t.src):void 0)),n=new TextureAtlas(e,t,!1),this.set(t,n)),n}},{key:"delete",value:function(t){this.cache.has(t)||this.cache.delete(t)}},{key:"tint",value:function(t,e){var n=this.tinted.get(t);return void 0===n&&(n=this.tinted.set(t,new Map)),n.has(e)||n.set(e,renderer.tint(t,e,"multiply")),n.get(e)}},{key:"set",value:function(t,e){var n=t.width,r=t.height;if(!(1!==renderer.WebGLVersion||isPowerOfTwo(n)&&isPowerOfTwo(r))){var i=void 0!==t.src?t.src:t;console.warn("[Texture] "+i+" is not a POT texture ("+n+"x"+r+")")}return this.cache.put(t,e)}},{key:"getUnit",value:function(t){return this.units.has(t)||(this.validate(),this.units.set(t,this.length++)),this.units.get(t)}}]),t}();function createAtlas(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"default",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"no-repeat";return{meta:{app:"melonJS",size:{w:t,h:e},repeat:r,image:"default"},frames:[{filename:n,frame:{x:0,y:0,w:t,h:e}}]}}var TextureAtlas=function(){function t(e,n,r){var i=this;if(_classCallCheck(this,t),this.format=null,this.sources=new Map,this.atlases=new Map,void 0!==e)for(var o in e=Array.isArray(e)?e:[e]){var a=e[o];if(void 0!==a.meta){if(a.meta.app.includes("texturepacker")||a.meta.app.includes("free-tex-packer")){if(this.format="texturepacker",void 0===n){var s=loader.getImage(a.meta.image);if(!s)throw new Error("Atlas texture '"+s+"' not found");this.sources.set(a.meta.image,s)}else this.sources.set(a.meta.image||"default","string"==typeof n?loader.getImage(n):n);this.repeat="no-repeat"}else if(a.meta.app.includes("ShoeBox")){if(!a.meta.exporter||!a.meta.exporter.includes("melonJS"))throw new Error("ShoeBox requires the JSON exporter : https://github.com/melonjs/melonJS/tree/master/media/shoebox_JSON_export.sbx");this.format="ShoeBox",this.repeat="no-repeat",this.sources.set("default","string"==typeof n?loader.getImage(n):n)}else a.meta.app.includes("melonJS")&&(this.format="melonJS",this.repeat=a.meta.repeat||"no-repeat",this.sources.set("default","string"==typeof n?loader.getImage(n):n));this.atlases.set(a.meta.image||"default",this.parse(a))}else void 0!==a.framewidth&&void 0!==a.frameheight&&(this.format="Spritesheet (fixed cell size)",this.repeat="no-repeat",void 0!==n&&(a.image="string"==typeof n?loader.getImage(n):n),this.atlases.set("default",this.parseFromSpriteSheet(a)),this.sources.set("default",a.image))}if(0===this.atlases.length)throw new Error("texture atlas format not supported");!1!==r&&this.sources.forEach((function(t){r instanceof TextureCache?r.set(t,i):renderer.cache.set(t,i)}))}return _createClass(t,[{key:"parse",value:function(t){var e=this,n={};return t.frames.forEach((function(r){if(r.hasOwnProperty("filename")){var i,o,a=r.frame,s=r.spriteSourceSize&&r.sourceSize&&r.pivot;s&&(i=r.sourceSize.w*r.pivot.x-(r.trimmed?r.spriteSourceSize.x:0),o=r.sourceSize.h*r.pivot.y-(r.trimmed?r.spriteSourceSize.y:0)),n[r.filename]={name:r.filename,texture:t.meta.image||"default",offset:new Vector2d(a.x,a.y),anchorPoint:s?new Vector2d(i/a.w,o/a.h):null,trimmed:!!r.trimmed,width:a.w,height:a.h,angle:!0===r.rotated?-ETA:0},e.addUVs(n,r.filename,t.meta.size.w,t.meta.size.h)}})),n}},{key:"parseFromSpriteSheet",value:function(t){var e={},n=t.image,r=t.spacing||0,i=t.margin||0,o=n.width,a=n.height,s=pool$1.pull("Vector2d",~~((o-i+r)/(t.framewidth+r)),~~((a-i+r)/(t.frameheight+r)));if(o%(t.framewidth+r)!=0||a%(t.frameheight+r)!=0){var l=s.x*(t.framewidth+r),u=s.y*(t.frameheight+r);l-o!==r&&u-a!==r&&(o=l,a=u,console.warn("Spritesheet Texture for image: "+n.src+" is not divisible by "+(t.framewidth+r)+"x"+(t.frameheight+r)+", truncating effective size to "+o+"x"+a))}for(var c=0,h=s.x*s.y;c<h;c++){var f=""+c;e[f]={name:f,texture:"default",offset:new Vector2d(i+(r+t.framewidth)*(c%s.x),i+(r+t.frameheight)*~~(c/s.x)),anchorPoint:t.anchorPoint||null,trimmed:!1,width:t.framewidth,height:t.frameheight,angle:0},this.addUVs(e,f,o,a)}return pool$1.push(s),e}},{key:"getAtlas",value:function(t){return"string"==typeof t?this.atlases.get(t):this.atlases.values().next().value}},{key:"getFormat",value:function(){return this.format}},{key:"getTexture",value:function(t){return"object"===_typeof(t)&&"string"==typeof t.texture?this.sources.get(t.texture):this.sources.values().next().value}},{key:"addRegion",value:function(t,e,n,r,i){!0===renderer.settings.verbose&&console.warn("Adding texture region",t,"for texture",this);var o=this.getTexture(),a=this.getAtlas(),s=o.width,l=o.height;return a[t]={name:t,offset:new Vector2d(e,n),width:r,height:i,angle:0},this.addUVs(a,t,s,l),a[t]}},{key:"getRegion",value:function(t,e){var n;return"string"==typeof e?n=this.getAtlas(e)[t]:this.atlases.forEach((function(e){void 0!==e[t]&&(n=e[t])})),n}},{key:"getUVs",value:function(t){var e=this.getRegion(t);if(void 0===e){var n=t.split(","),r=+n[0],i=+n[1],o=+n[2],a=+n[3];e=this.addRegion(t,r,i,o,a)}return e.uvs}},{key:"addUVs",value:function(t,e,n,r){if(renderer instanceof WebGLRenderer){var i=t[e].offset,o=t[e].width,a=t[e].height;t[e].uvs=new Float32Array([i.x/n,i.y/r,(i.x+o)/n,(i.y+a)/r]),t[i.x+","+i.y+","+n+","+r]=t[e]}return t[e].uvs}},{key:"createSpriteFromName",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return pool$1.pull(!0===n?"me.NineSliceSprite":"me.Sprite",0,0,Object.assign({image:this,region:t},e||{}))}},{key:"createAnimationFromName",value:function(t,e){for(var n,r=[],i={},o=0,a=0,s=0;s<t.length;++s){if(null==(n=this.getRegion(t[s])))throw new Error("Texture - region for "+t[s]+" not found");r[s]=n,i[t[s]]=s,o=Math.max(n.width,o),a=Math.max(n.height,a)}return new Sprite(0,0,Object.assign({image:this,framewidth:o,frameheight:a,margin:0,spacing:0,atlas:r,atlasIndices:i},e||{}))}}]),t}(),Sprite=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i){var o;if(_classCallCheck(this,n),(o=e.call(this,t,r,0,0)).animationpause=!1,o.animationspeed=100,o.offset=pool$1.pull("Vector2d",0,0),o.source=null,o.anim={},o.resetAnim=void 0,o.current={name:"default",length:0,offset:pool$1.pull("Vector2d"),width:0,height:0,angle:0,idx:0},o.dt=0,o._flicker={isFlickering:!1,duration:0,callback:null,state:!1},i.image instanceof TextureAtlas){if(o.source=i.image,o.image=o.source.getTexture(),o.textureAtlas=i.image,void 0!==i.region){var a=o.source.getRegion(i.region);if(!a)throw new Error("Texture - region for "+i.region+" not found");o.setRegion(a),o.current.width=i.framewidth||a.width,o.current.height=i.frameheight||a.height}}else{if(o.image="object"===_typeof(i.image)?i.image:loader.getImage(i.image),!o.image)throw new Error("me.Sprite: '"+i.image+"' image/texture not found!");o.current.width=i.framewidth=i.framewidth||o.image.width,o.current.height=i.frameheight=i.frameheight||o.image.height,o.source=renderer.cache.get(o.image,i),o.textureAtlas=o.source.getAtlas()}return void 0!==i.atlas&&(o.textureAtlas=i.atlas,o.atlasIndices=i.atlasIndices),o.width=o.current.width,o.height=o.current.height,void 0!==i.flipX&&o.flipX(!!i.flipX),void 0!==i.flipY&&o.flipY(!!i.flipY),void 0!==i.rotation&&o.rotate(i.rotation),i.anchorPoint&&o.anchorPoint.set(i.anchorPoint.x,i.anchorPoint.y),void 0!==i.tint&&o.tint.setColor(i.tint),"string"==typeof i.name&&(o.name=i.name),void 0!==i.z&&(o.pos.z=i.z),0!==o.addAnimation("default",null)&&o.setCurrentAnimation("default"),o.autoTransform=!0,o}return _createClass(n,[{key:"isFlickering",value:function(){return this._flicker.isFlickering}},{key:"flicker",value:function(t,e){return this._flicker.duration=t,this._flicker.duration<=0?(this._flicker.isFlickering=!1,this._flicker.callback=null):this._flicker.isFlickering||(this._flicker.callback=e,this._flicker.isFlickering=!0),this}},{key:"addAnimation",value:function(t,e,n){this.anim[t]={name:t,frames:[],idx:0,length:0};var r=0;if("object"!==_typeof(this.textureAtlas))return 0;null==e&&(e=[],Object.keys(this.textureAtlas).forEach((function(t,n){e[n]=n})));for(var i=0,o=e.length;i<o;i++){var a,s=e[i],l=(a="number"==typeof s||"string"==typeof s?{name:s,delay:n||this.animationspeed}:s).name;if("number"==typeof l)void 0!==this.textureAtlas[l]&&(this.anim[t].frames[i]=Object.assign({},this.textureAtlas[l],a),r++);else{if(this.source.getFormat().includes("Spritesheet"))throw new Error("string parameters for addAnimation are not allowed for standard spritesheet based Texture");this.anim[t].frames[i]=Object.assign({},this.textureAtlas[this.atlasIndices[l]],a),r++}}return this.anim[t].length=r,r}},{key:"setCurrentAnimation",value:function(t,e,n){if(!this.anim[t])throw new Error("animation id '"+t+"' not defined");return this.current.name=t,this.current.length=this.anim[this.current.name].length,this.resetAnim="string"==typeof e?this.setCurrentAnimation.bind(this,e,null,!0):"function"==typeof e?e:void 0,this.setAnimationFrame(this.current.idx),n||(this.dt=0),this.isDirty=!0,this}},{key:"reverseAnimation",value:function(t){return void 0!==t&&void 0!==this.anim[t]?this.anim[t].frames.reverse():this.anim[this.current.name].frames.reverse(),this.isDirty=!0,this}},{key:"isCurrentAnimation",value:function(t){return this.current.name===t}},{key:"setRegion",value:function(t){return this.image=this.source.getTexture(t),this.current.offset.setV(t.offset),this.current.angle=t.angle,this.width=this.current.width=t.width,this.height=this.current.height=t.height,t.anchorPoint&&this.anchorPoint.set(this._flip.x&&!0===t.trimmed?1-t.anchorPoint.x:t.anchorPoint.x,this._flip.y&&!0===t.trimmed?1-t.anchorPoint.y:t.anchorPoint.y),this.isDirty=!0,this}},{key:"setAnimationFrame",value:function(t){return this.current.idx=(t||0)%this.current.length,this.setRegion(this.getAnimationFrameObjectByIndex(this.current.idx))}},{key:"getCurrentAnimationFrame",value:function(){return this.current.idx}},{key:"getAnimationFrameObjectByIndex",value:function(t){return this.anim[this.current.name].frames[t]}},{key:"update",value:function(t){if(!this.animationpause&&this.current&&this.current.length>0){var e=this.getAnimationFrameObjectByIndex(this.current.idx).delay;for(this.dt+=t;this.dt>=e;){this.isDirty=!0,this.dt-=e;var r=this.current.length>1?this.current.idx+1:this.current.idx;if(this.setAnimationFrame(r),0===this.current.idx&&"function"==typeof this.resetAnim&&!1===this.resetAnim()){this.setAnimationFrame(this.current.length-1),this.dt%=e;break}e=this.getAnimationFrameObjectByIndex(this.current.idx).delay}}return this._flicker.isFlickering&&(this._flicker.duration-=t,this._flicker.duration<0&&("function"==typeof this._flicker.callback&&this._flicker.callback(),this.flicker(-1)),this.isDirty=!0),_get(_getPrototypeOf(n.prototype),"update",this).call(this,t)}},{key:"destroy",value:function(){pool$1.push(this.offset),this.offset=void 0,_get(_getPrototypeOf(n.prototype),"destroy",this).call(this)}},{key:"draw",value:function(t){if(!this._flicker.isFlickering||(this._flicker.state=!this._flicker.state,this._flicker.state)){var e=this.current,n=this.pos.x,r=this.pos.y,i=e.width,o=e.height,a=e.offset,s=this.offset;0!==e.angle&&(t.translate(-n,-r),t.rotate(e.angle),n-=o,i=e.height,o=e.width),t.drawImage(this.image,s.x+a.x,s.y+a.y,i,o,n,r,i,o)}}}]),n}(Renderable),TMX_FLIP_H=2147483648,TMX_FLIP_V=1073741824,TMX_FLIP_AD=536870912,TMX_CLEAR_BIT_MASK$1=536870911,Tile=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i,o){var a,s,l;if(_classCallCheck(this,n),a=e.call(this),o.isCollection){var u=o.getTileImage(i&TMX_CLEAR_BIT_MASK$1);s=u.width,l=u.height}else s=o.tilewidth,l=o.tileheight;return a.setMinMax(0,0,s,l),a.tileset=o,a.currentTransform=null,a.col=t,a.row=r,a.tileId=i,a.flippedX=0!=(a.tileId&TMX_FLIP_H),a.flippedY=0!=(a.tileId&TMX_FLIP_V),a.flippedAD=0!=(a.tileId&TMX_FLIP_AD),a.flipped=a.flippedX||a.flippedY||a.flippedAD,!0===a.flipped&&(null===a.currentTransform&&(a.currentTransform=new Matrix2d),a.setTileTransform(a.currentTransform.identity())),a.tileId&=TMX_CLEAR_BIT_MASK$1,a}return _createClass(n,[{key:"setTileTransform",value:function(t){t.translate(this.width/2,this.height/2),this.flippedAD&&(t.rotate(-90*Math.PI/180),t.scale(-1,1)),this.flippedX&&t.scale(this.flippedAD?1:-1,this.flippedAD?-1:1),this.flippedY&&t.scale(this.flippedAD?-1:1,this.flippedAD?1:-1),t.translate(-this.width/2,-this.height/2)}},{key:"getRenderable",value:function(t){var e,n=this.tileset;if(n.animations.has(this.tileId)){var r=[],i=[];n.animations.get(this.tileId).frames.forEach((function(t){i.push(t.tileid),r.push({name:""+t.tileid,delay:t.duration})})),(e=n.texture.createAnimationFromName(i,t)).addAnimation(this.tileId-n.firstgid,r),e.setCurrentAnimation(this.tileId-n.firstgid)}else if(!0===n.isCollection){var o=n.getTileImage(this.tileId);(e=new Sprite(0,0,Object.assign({image:o}))).anchorPoint.set(0,0),e.scale(t.width/this.width,t.height/this.height),void 0!==t.rotation&&(e.anchorPoint.set(.5,.5),e.currentTransform.rotate(t.rotation),e.currentTransform.translate(t.width/2,t.height/2),t.rotation=void 0)}else(e=n.texture.createSpriteFromName(this.tileId-n.firstgid,t)).anchorPoint.set(0,0);return this.setTileTransform(e.currentTransform),e}}]),n}(Bounds$1),RoundRect=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i,o){var a,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:20;return _classCallCheck(this,n),(a=e.call(this,t,r,i,o)).radius=s,a}return _createClass(n,[{key:"onResetEvent",value:function(t,e,r,i,o){_get(_getPrototypeOf(n.prototype),"setShape",this).call(this,t,e,r,i),this.radius=o}},{key:"radius",get:function(){return this._radius},set:function(t){this.width<2*t&&(t=this.width/2),this.height<2*t&&(t=this.height/2),this._radius=t}},{key:"copy",value:function(t){return _get(_getPrototypeOf(n.prototype),"setShape",this).call(this,t.pos.x,t.pos.y,t.width,t.height),this.radius=t.radius,this}},{key:"contains",value:function(){var t,e,r,i,o=arguments[0];if(2===arguments.length)t=o,e=arguments[1];else{if(o instanceof Rect)return _get(_getPrototypeOf(n.prototype),"contains",this).call(this,o);t=o.x,e=o.y}if(t<this.left||t>=this.right||e<this.top||e>=this.bottom)return!1;if(t>=this.left+this.radius&&t<=this.right-this.radius||e>=this.top+this.radius&&e<=this.bottom-this.radius)return!0;var a=Math.max(0,Math.min(this.radius,this.width/2)),s=Math.max(0,Math.min(this.radius,this.height/2));if(t<this.left+a&&e<this.top+s)r=t-this.left-a,i=e-this.top-s;else if(t>this.right-a&&e<this.top+s)r=t-this.right+a,i=e-this.top-s;else if(t>this.right-a&&e>this.bottom-s)r=t-this.right+a,i=e-this.bottom+s;else{if(!(t<this.left+a&&e>this.bottom-s))return!1;r=t-this.left-a,i=e-this.bottom+s}return r*r+i*i<=a*s}},{key:"equals",value:function(t){return _get(_getPrototypeOf(n.prototype),"equals",this).call(this,t)&&this.radius===t.radius}},{key:"clone",value:function(){return new n(this.pos.x,this.pos.y,this.width,this.height,radius)}}]),n}(Rect),Line=function(t){_inherits(n,t);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"contains",value:function(){var t,e;2===arguments.length?(t=arguments[0],e=arguments[1]):(t=arguments[0].x,e=arguments[0].y),t-=this.pos.x,e-=this.pos.y;var n=this.points[0],r=this.points[1];return(e-n.y)*(r.x-n.x)==(r.y-n.y)*(t-n.x)}},{key:"recalc",value:function(){var t=this.edges,e=this.normals,n=this.indices,r=this.points;if(2!==r.length)throw new Error("Requires exactly 2 points");return void 0===t[0]&&(t[0]=pool$1.pull("Vector2d")),t[0].copy(r[1]).sub(r[0]),void 0===e[0]&&(e[0]=pool$1.pull("Vector2d")),e[0].copy(t[0]).perp().normalize(),n.length=0,this}},{key:"clone",value:function(){var t=[];return this.points.forEach((function(e){t.push(e.clone())})),new n(this.pos.x,this.pos.y,t)}}]),n}(Polygon),Path2D$1=function(){function t(){_classCallCheck(this,t),this.points=[],this.arcResolution=5,this.vertices=[]}return _createClass(t,[{key:"beginPath",value:function(){this.points.forEach((function(t){pool$1.push(t)})),this.points.length=0}},{key:"closePath",value:function(){var t=this.points;t.length>1&&!t[t.length-1].equals(t[0])&&t.push(pool$1.pull("Vector2d",t[0].x,t[0].y))}},{key:"triangulatePath",value:function(){var t=0,e=this.points,n=this.vertices,r=earcut$1.exports(e.flatMap((function(t){return[t.x,t.y]})));for(t=0;t<r.length;t++)void 0===n[t]&&(n[t]=pool$1.pull("Vector2d")),n[t].set(e[r[t]].x,e[r[t]].y);for(;n.length>r.length;)pool$1.push(n[n.length-1]),n.length-=1;return n}},{key:"moveTo",value:function(t,e){this.points.push(pool$1.pull("Vector2d",t,e))}},{key:"lineTo",value:function(t,e){this.points.push(pool$1.pull("Vector2d",t,e))}},{key:"arc",value:function(t,e,n,r,i){var o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],a=this.points;if(r!==i){var s=o?Math.abs(r-i)>=TAU:Math.abs(i-r)>=TAU;(r%=TAU)<0&&(r+=TAU),(i%=TAU)<0&&(i+=TAU),r>=i&&(i+=TAU);var l=i-r,u=1;o&&(u=-1,l=TAU-l),s&&(l=TAU);for(var c=l*n,h=c/this.arcResolution,f=l/h,d=r,p=0;p<h;p++)a.push(pool$1.pull("Vector2d",t+n*Math.cos(d),e+n*Math.sin(d))),d+=u*f;a.push(pool$1.pull("Vector2d",t+n*Math.cos(i),e+n*Math.sin(i)))}}},{key:"arcTo",value:function(t,e,n,r,i){var o=this.points,a=[o[o.length-1].x-t,o[o.length-1].y-e],s=[n-t,r-e],l=Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)),u=Math.sqrt(Math.pow(s[0],2)+Math.pow(s[1],2));a[0]/=l,a[1]/=l,s[0]/=u,s[1]/=u;var c=Math.atan2(a[1],a[0])-Math.atan2(s[1],s[0]),h=i/Math.tan(c/2),f=[t+a[0]*h,e+a[1]*h],d=[t+s[0]*h,e+s[1]*h];o.push(pool$1.pull("Vector2d",f[0],f[1]));var p=[(a[0]+s[0])/2,(a[1]+s[1])/2],y=Math.sqrt(Math.pow(p[0],2)+Math.pow(p[1],2));p[0]/=y,p[1]/=y;var v=Math.sqrt(Math.pow(i,2)+Math.pow(h,2)),g=[t+v*p[0],e+v*p[1]],m=Math.atan2(f[1]-g[1],f[0]-g[0]),_=Math.atan2(d[1]-g[1],d[0]-g[0]);this.arc(g[0],g[1],i,m,_)}},{key:"ellipse",value:function(t,e,n,r,i,o,a){var s=arguments.length>7&&void 0!==arguments[7]&&arguments[7],l=this.points;if(o!==a){var u=s?Math.abs(o-a)>=TAU:Math.abs(a-o)>=TAU;(o%=TAU)<0&&(o+=TAU),(a%=TAU)<0&&(a+=TAU),o>=a&&(a+=TAU);var c=a-o,h=1;s&&(h=-1,c=TAU-c),u&&(c=TAU);for(var f=(c*n+c*r)/2,d=f/this.arcResolution,p=c/d,y=o,v=Math.cos(i),g=Math.sin(i),m=0;m<d;m++){var _=n*Math.cos(y),b=r*Math.sin(y),x=t+_*v-b*g,w=e+_*g+b*v;l.push(pool$1.pull("Vector2d",x,w)),y+=h*p}}}},{key:"rect",value:function(t,e,n,r){this.moveTo(t,e),this.lineTo(t+n,e),this.lineTo(t+n,e+r),this.lineTo(t,e+r),this.lineTo(t,e)}},{key:"roundRect",value:function(t,e,n,r,i){this.moveTo(t+i,e),this.lineTo(t+n-i,e),this.arcTo(t+n,e,t+n,e+i,i),this.lineTo(t+n,e+r-i),this.arcTo(t+n,e+r,t+n-i,e+r,i),this.lineTo(t+i,e+r),this.arcTo(t,e+r,t,e+r-i,i),this.lineTo(t,e+i),this.arcTo(t,e,t+i,e,i)}}]),t}(),Renderer=function(){function t(e){_classCallCheck(this,t),this.settings=e,this.isContextValid=!0,this.path2D=new Path2D$1,this.currentScissor=new Int32Array([0,0,this.settings.width,this.settings.height]),this.currentBlendMode="none",!0===device$1.ejecta?this.canvas=document.getElementById("canvas"):void 0!==globalThis.canvas?this.canvas=globalThis.canvas:void 0!==this.settings.canvas?this.canvas=this.settings.canvas:this.canvas=createCanvas(this.settings.zoomX,this.settings.zoomY),this.backBufferCanvas=this.canvas,this.context=null,this.currentColor=new Color(0,0,0,1),this.currentTint=new Color(255,255,255,1),this.projectionMatrix=new Matrix3d,this.uvOffset=0,on(GAME_RESET,(function(){renderer.reset()}))}return _createClass(t,[{key:"clear",value:function(){}},{key:"reset",value:function(){this.resetTransform(),this.setBlendMode(this.settings.blendMode),this.setColor("#000000"),this.clearTint(),this.cache.clear(),this.currentScissor[0]=0,this.currentScissor[1]=0,this.currentScissor[2]=this.backBufferCanvas.width,this.currentScissor[3]=this.backBufferCanvas.height}},{key:"getCanvas",value:function(){return this.backBufferCanvas}},{key:"getScreenCanvas",value:function(){return this.canvas}},{key:"getScreenContext",value:function(){return this.context}},{key:"getBlendMode",value:function(){return this.currentBlendMode}},{key:"getContext2d",value:function(t,e){if(null==t)throw new Error("You must pass a canvas element in order to create a 2d context");if(void 0===t.getContext)throw new Error("Your browser does not support HTML5 canvas.");"boolean"!=typeof e&&(e=!0);var n=t.getContext("2d",{alpha:e});return n.canvas||(n.canvas=t),this.setAntiAlias(n,this.settings.antiAlias),n}},{key:"getWidth",value:function(){return this.backBufferCanvas.width}},{key:"getHeight",value:function(){return this.backBufferCanvas.height}},{key:"getColor",value:function(){return this.currentColor}},{key:"globalAlpha",value:function(){return this.currentColor.glArray[3]}},{key:"overlaps",value:function(t){return t.left<=this.getWidth()&&t.right>=0&&t.top<=this.getHeight()&&t.bottom>=0}},{key:"resize",value:function(t,e){t===this.backBufferCanvas.width&&e===this.backBufferCanvas.height||(this.canvas.width=this.backBufferCanvas.width=t,this.canvas.height=this.backBufferCanvas.height=e,this.currentScissor[0]=0,this.currentScissor[1]=0,this.currentScissor[2]=t,this.currentScissor[3]=e,emit(CANVAS_ONRESIZE,t,e))}},{key:"setAntiAlias",value:function(t,e){var n=t.canvas;setPrefixed("imageSmoothingEnabled",!0===e,t),!0!==e?(n.style["image-rendering"]="optimizeSpeed",n.style["image-rendering"]="-moz-crisp-edges",n.style["image-rendering"]="-o-crisp-edges",n.style["image-rendering"]="-webkit-optimize-contrast",n.style["image-rendering"]="optimize-contrast",n.style["image-rendering"]="crisp-edges",n.style["image-rendering"]="pixelated",n.style.msInterpolationMode="nearest-neighbor"):n.style["image-rendering"]="auto"}},{key:"setProjection",value:function(t){this.projectionMatrix.copy(t)}},{key:"stroke",value:function(t,e){if(t instanceof Rect||t instanceof Bounds$1)this.strokeRect(t.left,t.top,t.width,t.height,e);else if(t instanceof Line||t instanceof Polygon)this.strokePolygon(t,e);else if(t instanceof RoundRect)this.strokeRoundRect(t.left,t.top,t.width,t.height,t.radius,e);else{if(!(t instanceof Ellipse))throw new Error("Invalid geometry for fill/stroke");this.strokeEllipse(t.pos.x,t.pos.y,t.radiusV.x,t.radiusV.y,e)}}},{key:"fill",value:function(t){this.stroke(t,!0)}},{key:"tint",value:function(t,e,n){var r=createCanvas(t.width,t.height,!0),i=this.getContext2d(r);return i.save(),i.fillStyle=e instanceof Color?e.toRGB():e,i.fillRect(0,0,t.width,t.height),i.globalCompositeOperation=n||"multiply",i.drawImage(t,0,0),i.globalCompositeOperation="destination-atop",i.drawImage(t,0,0),i.restore(),r}},{key:"setMask",value:function(t){}},{key:"clearMask",value:function(){}},{key:"setTint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.alpha;this.currentTint.copy(t),this.currentTint.alpha*=e}},{key:"clearTint",value:function(){this.currentTint.setColor(255,255,255,1)}},{key:"drawFont",value:function(){}}]),t}(),CanvasRenderer=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r;return _classCallCheck(this,n),(r=e.call(this,t)).context=r.getContext2d(r.getScreenCanvas(),r.settings.transparent),r.settings.doubleBuffering?(r.backBufferCanvas=createCanvas(r.settings.width,r.settings.height,!0),r.backBufferContext2D=r.getContext2d(r.backBufferCanvas)):(r.backBufferCanvas=r.getScreenCanvas(),r.backBufferContext2D=r.context),r.setBlendMode(r.settings.blendMode),r.setColor(r.currentColor),r.cache=new TextureCache,!1===r.settings.textureSeamFix||r.settings.antiAlias||(r.uvOffset=1),r.getScreenCanvas().addEventListener("contextlost",(function(t){t.preventDefault(),r.isContextValid=!1,event.emit(event.ONCONTEXT_LOST,_assertThisInitialized(r))}),!1),r.getScreenCanvas().addEventListener("contextrestored",(function(){r.isContextValid=!0,event.emit(event.ONCONTEXT_RESTORED,_assertThisInitialized(r))}),!1),r}return _createClass(n,[{key:"reset",value:function(){_get(_getPrototypeOf(n.prototype),"reset",this).call(this),this.clearColor(this.currentColor,!0!==this.settings.transparent)}},{key:"resetTransform",value:function(){this.backBufferContext2D.setTransform(1,0,0,1,0,0)}},{key:"setBlendMode",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"normal",e=arguments.length>1?arguments[1]:void 0;switch(e=e||this.getContext(),this.currentBlendMode=t,t){case"screen":e.globalCompositeOperation="screen";break;case"lighter":case"additive":e.globalCompositeOperation="lighter";break;case"multiply":e.globalCompositeOperation="multiply";break;default:e.globalCompositeOperation="source-over",this.currentBlendMode="normal"}this.settings.doubleBuffering&&this.settings.transparent&&(this.context.globalCompositeOperation="copy")}},{key:"clear",value:function(){this.settings.transparent&&this.clearColor("rgba(0,0,0,0)",!0)}},{key:"flush",value:function(){this.settings.doubleBuffering&&this.context.drawImage(this.backBufferCanvas,0,0)}},{key:"clearColor",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"#000000",e=arguments.length>1?arguments[1]:void 0;this.save(),this.resetTransform(),this.backBufferContext2D.globalCompositeOperation=e?"copy":"source-over",this.backBufferContext2D.fillStyle=t instanceof Color?t.toRGBA():t,this.fillRect(0,0,this.backBufferCanvas.width,this.backBufferCanvas.height),this.restore()}},{key:"clearRect",value:function(t,e,n,r){this.getContext().clearRect(t,e,n,r)}},{key:"createPattern",value:function(t,e){return this.getContext().createPattern(t,e)}},{key:"drawImage",value:function(t,e,n,r,i,o,a,s,l){if(!(this.getGlobalAlpha()<1/255)){var u=this.getContext();void 0===r?(r=s=t.width,i=l=t.height,o=e,a=n,e=0,n=0):void 0===o&&(o=e,a=n,s=r,l=i,r=t.width,i=t.height,e=0,n=0),!1===this.settings.subPixel&&(o=~~o,a=~~a);var c=t,h=this.currentTint.toArray();1===h[0]&&1===h[1]&&1===h[2]||(c=this.cache.tint(t,this.currentTint.toRGB())),u.drawImage(c,e,n,r,i,o,a,s,l)}}},{key:"drawPattern",value:function(t,e,n,r,i){if(!(this.getGlobalAlpha()<1/255)){var o=this.getContext(),a=o.fillStyle;o.fillStyle=t,o.fillRect(e,n,r,i),o.fillStyle=a}}},{key:"strokeArc",value:function(t,e,n,r,i,o){var a=arguments.length>6&&void 0!==arguments[6]&&arguments[6];if(!(this.getGlobalAlpha()<1/255)){var s=this.getContext();s.translate(t,e),s.beginPath(),s.arc(0,0,n,r,i,o||!1),s[!0===a?"fill":"stroke"](),s.translate(-t,-e)}}},{key:"fillArc",value:function(t,e,n,r,i,o){this.strokeArc(t,e,n,r,i,o||!1,!0)}},{key:"strokeEllipse",value:function(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!(this.getGlobalAlpha()<1/255)){var o=this.getContext(),a=n,s=r,l=t-a,u=t+a,c=e-s,h=e+s,f=.551784*a,d=.551784*s,p=t-f,y=t+f,v=e-d,g=e+d;o.beginPath(),o.moveTo(t,c),o.bezierCurveTo(y,c,u,v,u,e),o.bezierCurveTo(u,g,y,h,t,h),o.bezierCurveTo(p,h,l,g,l,e),o.bezierCurveTo(l,v,p,c,t,c),o[!0===i?"fill":"stroke"](),o.closePath()}}},{key:"fillEllipse",value:function(t,e,n,r){this.strokeEllipse(t,e,n,r,!0)}},{key:"strokeLine",value:function(t,e,n,r){this.getGlobalAlpha()<1/255||(context.beginPath(),context.moveTo(t,e),context.lineTo(n,r),context.stroke())}},{key:"fillLine",value:function(t,e,n,r){this.strokeLine(t,e,n,r)}},{key:"strokePolygon",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!(this.getGlobalAlpha()<1/255)){var n,r=this.getContext();this.translate(t.pos.x,t.pos.y),r.beginPath(),r.moveTo(t.points[0].x,t.points[0].y);for(var i=1;i<t.points.length;i++)n=t.points[i],r.lineTo(n.x,n.y);r.lineTo(t.points[0].x,t.points[0].y),r[!0===e?"fill":"stroke"](),r.closePath(),this.translate(-t.pos.x,-t.pos.y)}}},{key:"fillPolygon",value:function(t){this.strokePolygon(t,!0)}},{key:"strokeRect",value:function(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!(this.getGlobalAlpha()<1/255)){var o=this.getContext();o[!0===i?"fillRect":"strokeRect"](t,e,n,r)}}},{key:"fillRect",value:function(t,e,n,r){this.strokeRect(t,e,n,r,!0)}},{key:"strokeRoundRect",value:function(t,e,n,r,i){var o=arguments.length>5&&void 0!==arguments[5]&&arguments[5];if(!(this.getGlobalAlpha()<1/255)){var a=this.getContext();a.beginPath(),a.roundRect(t,e,n,r,i),a[!0===o?"fill":"stroke"]()}}},{key:"fillRoundRect",value:function(t,e,n,r,i){this.strokeRoundRect(t,e,n,r,i,!0)}},{key:"getContext",value:function(){return this.backBufferContext2D}},{key:"getFontContext",value:function(){return this.getContext()}},{key:"save",value:function(){this.backBufferContext2D.save()}},{key:"restore",value:function(){this.backBufferContext2D.restore(),this.currentColor.glArray[3]=this.getGlobalAlpha(),this.currentScissor[0]=0,this.currentScissor[1]=0,this.currentScissor[2]=this.backBufferCanvas.width,this.currentScissor[3]=this.backBufferCanvas.height}},{key:"rotate",value:function(t){this.backBufferContext2D.rotate(t)}},{key:"scale",value:function(t,e){this.backBufferContext2D.scale(t,e)}},{key:"setColor",value:function(t){this.backBufferContext2D.strokeStyle=this.backBufferContext2D.fillStyle=t instanceof Color?t.toRGBA():t}},{key:"setGlobalAlpha",value:function(t){this.backBufferContext2D.globalAlpha=this.currentColor.glArray[3]=t}},{key:"getGlobalAlpha",value:function(){return this.backBufferContext2D.globalAlpha}},{key:"setLineWidth",value:function(t){this.backBufferContext2D.lineWidth=t}},{key:"setTransform",value:function(t){this.resetTransform(),this.transform(t)}},{key:"transform",value:function(t){var e=t.toArray(),n=e[0],r=e[1],i=e[3],o=e[4],a=e[6],s=e[7];!1===this.settings.subPixel&&(a|=0,s|=0),this.backBufferContext2D.transform(n,r,i,o,a,s)}},{key:"translate",value:function(t,e){!1===this.settings.subPixel?this.backBufferContext2D.translate(~~t,~~e):this.backBufferContext2D.translate(t,e)}},{key:"clipRect",value:function(t,e,n,r){var i=this.backBufferCanvas;if(0!==t||0!==e||n!==i.width||r!==i.height){var o=this.currentScissor;if(o[0]!==t||o[1]!==e||o[2]!==n||o[3]!==r){var a=this.backBufferContext2D;a.beginPath(),a.rect(t,e,n,r),a.clip(),o[0]=t,o[1]=e,o[2]=n,o[3]=r}}}},{key:"setMask",value:function(t){var e=this.getContext(),n=t.pos.x,r=t.pos.y;if(e.save(),e.beginPath(),t instanceof Ellipse){var i=t.radiusV.x,o=t.radiusV.y,a=n-i,s=n+i,l=r-o,u=r+o,c=.551784*i,h=.551784*o,f=n-c,d=n+c,p=r-h,y=r+h;e.moveTo(n,l),e.bezierCurveTo(d,l,s,p,s,r),e.bezierCurveTo(s,y,d,u,n,u),e.bezierCurveTo(f,u,a,y,a,r),e.bezierCurveTo(a,p,f,l,n,l)}else if(t instanceof RoundRect)e.roundRect(n,r,t.width,t.height,t.radius);else{var v;e.moveTo(n+t.points[0].x,r+t.points[0].y);for(var g=1;g<t.points.length;g++)v=t.points[g],e.lineTo(n+v.x,r+v.y)}e.clip()}},{key:"clearMask",value:function(){this.getContext().restore()}}]),n}(Renderer);function initArray(t){t.layerData=new Array(t.cols);for(var e=0;e<t.cols;e++){t.layerData[e]=new Array(t.rows);for(var n=0;n<t.rows;n++)t.layerData[e][n]=null}}function setLayerData(t,e){var n=0;initArray(t);for(var r=0;r<t.rows;r++)for(var i=0;i<t.cols;i++){var o=e[n++];0!==o&&(t.layerData[i][r]=t.getTileById(o,i,r))}}function preRenderLayer(t,e){for(var n=0;n<t.rows;n++)for(var r=0;r<t.cols;r++){var i=t.layerData[r][n];i instanceof Tile&&t.getRenderer().drawTile(e,r,n,i)}}var TMXLayer=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i,o,a,s,l){var u;_classCallCheck(this,n),(u=e.call(this,0,0,0,0)).tilewidth=r.tilewidth||i,u.tileheight=r.tileheight||o,u.orientation=a,u.tilesets=s,u.tileset=u.tilesets?u.tilesets.getTilesetByIndex(0):null,u.maxTileSize={width:0,height:0};for(var c=0;c<u.tilesets.length;c++){var h=u.tilesets.getTilesetByIndex(c);u.maxTileSize.width=Math.max(u.maxTileSize.width,h.tilewidth),u.maxTileSize.height=Math.max(u.maxTileSize.height,h.tileheight)}u.animatedTilesets=[],u.isAnimated=!1,u.renderorder=r.renderorder||"right-down",u.pos.z=l,u.anchorPoint.set(0,0),u.name=r.name,u.cols=+r.width,u.rows=+r.height;var f=void 0!==r.visible?+r.visible:1;return u.setOpacity(f?+r.opacity:0),"string"==typeof r.tintcolor&&u.tint.parseHex(r.tintcolor,!0),"isometric"===u.orientation?(u.width=(u.cols+u.rows)*(u.tilewidth/2),u.height=(u.cols+u.rows)*(u.tileheight/2)):(u.width=u.cols*u.tilewidth,u.height=u.rows*u.tileheight),applyTMXProperties(_assertThisInitialized(u),r),void 0===u.preRender&&(u.preRender=world.preRender),u.setRenderer(t.getRenderer()),setLayerData(_assertThisInitialized(u),decode(r.data,r.encoding,r.compression)),u}return _createClass(n,[{key:"onActivateEvent",value:function(){if(void 0===this.animatedTilesets&&(this.animatedTilesets=[]),this.tilesets)for(var t=this.tilesets.tilesets,e=0;e<t.length;e++)t[e].isAnimated&&this.animatedTilesets.push(t[e]);this.isAnimated=this.animatedTilesets.length>0,this.isAnimated&&(this.preRender=!1),this.getBounds().addBounds(this.getRenderer().getBounds(),!0),this.getBounds().shift(this.pos),!0!==this.preRender||this.canvasRenderer||(this.canvasRenderer=new CanvasRenderer({canvas:createCanvas(this.width,this.height),widht:this.width,heigth:this.height,transparent:!0}),preRenderLayer(this,this.canvasRenderer))}},{key:"onDeactivateEvent",value:function(){this.animatedTilesets=void 0}},{key:"setRenderer",value:function(t){this.renderer=t}},{key:"getRenderer",value:function(){return this.renderer}},{key:"getTileId",value:function(t,e){var n=this.getTile(t,e);return n?n.tileId:null}},{key:"getTile",value:function(t,e){var n=null;if(this.contains(t,e)){var r=this.getRenderer().pixelToTileCoords(t,e,pool$1.pull("Vector2d"));n=this.cellAt(r.x,r.y),pool$1.push(r)}return n}},{key:"setTile",value:function(t,e,n){return this.layerData[e][n]=t,t}},{key:"getTileById",value:function(t,e,n){return this.tileset.contains(t)||(this.tileset=this.tilesets.getTilesetByGid(t)),new Tile(e,n,t,this.tileset)}},{key:"cellAt",value:function(t,e,n){var r=~~t,i=~~e,o=this.getRenderer();return!1===n||r>=0&&r<o.cols&&i>=0&&i<o.rows?this.layerData[r][i]:null}},{key:"clearTile",value:function(t,e){this.layerData[t][e]=null,this.preRender&&this.canvasRenderer.clearRect(t*this.tilewidth,e*this.tileheight,this.tilewidth,this.tileheight)}},{key:"update",value:function(t){if(this.isAnimated){for(var e=!1,n=0;n<this.animatedTilesets.length;n++)e=this.animatedTilesets[n].update(t)||e;return e}return!1}},{key:"draw",value:function(t,e){if(this.preRender){var n=Math.min(e.width,this.width),r=Math.min(e.height,this.height);t.drawImage(this.canvasRenderer.getCanvas(),e.pos.x,e.pos.y,n,r,e.pos.x,e.pos.y,n,r)}else this.getRenderer().drawTileLayer(t,this,e)}}]),n}(Renderable),Bounds=function(){function t(e){_classCallCheck(this,t),this._center=new Vector2d,this.onResetEvent(e)}return _createClass(t,[{key:"onResetEvent",value:function(t){void 0===this.min?(this.min={x:1/0,y:1/0},this.max={x:-1/0,y:-1/0}):this.clear(),void 0!==t&&this.update(t)}},{key:"clear",value:function(){this.setMinMax(1/0,1/0,-1/0,-1/0)}},{key:"setMinMax",value:function(t,e,n,r){this.min.x=t,this.min.y=e,this.max.x=n,this.max.y=r}},{key:"x",get:function(){return this.min.x},set:function(t){var e=this.max.x-this.min.x;this.min.x=t,this.max.x=t+e}},{key:"y",get:function(){return this.min.y},set:function(t){var e=this.max.y-this.min.y;this.min.y=t,this.max.y=t+e}},{key:"width",get:function(){return this.max.x-this.min.x},set:function(t){this.max.x=this.min.x+t}},{key:"height",get:function(){return this.max.y-this.min.y},set:function(t){this.max.y=this.min.y+t}},{key:"left",get:function(){return this.min.x}},{key:"right",get:function(){return this.max.x}},{key:"top",get:function(){return this.min.y}},{key:"bottom",get:function(){return this.max.y}},{key:"centerX",get:function(){return this.min.x+this.width/2}},{key:"centerY",get:function(){return this.min.y+this.height/2}},{key:"center",get:function(){return this._center.set(this.centerX,this.centerY)}},{key:"update",value:function(t){this.add(t,!0)}},{key:"add",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];!0===e&&this.clear();for(var n=0;n<t.length;n++){var r=t[n];r.x>this.max.x&&(this.max.x=r.x),r.x<this.min.x&&(this.min.x=r.x),r.y>this.max.y&&(this.max.y=r.y),r.y<this.min.y&&(this.min.y=r.y)}}},{key:"addBounds",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];!0===e&&this.clear(),t.max.x>this.max.x&&(this.max.x=t.max.x),t.min.x<this.min.x&&(this.min.x=t.min.x),t.max.y>this.max.y&&(this.max.y=t.max.y),t.min.y<this.min.y&&(this.min.y=t.min.y)}},{key:"addPoint",value:function(t,e){void 0!==e&&(t=e.apply(t)),this.min.x=Math.min(this.min.x,t.x),this.max.x=Math.max(this.max.x,t.x),this.min.y=Math.min(this.min.y,t.y),this.max.y=Math.max(this.max.y,t.y)}},{key:"addFrame",value:function(t,e,n,r,i){var o=me.pool.pull("Vector2d");this.addPoint(o.set(t,e),i),this.addPoint(o.set(n,e),i),this.addPoint(o.set(t,r),i),this.addPoint(o.set(n,r),i),me.pool.push(o)}},{key:"contains",value:function(){var e,n,r,i,o=arguments[0];return 2===arguments.length?(e=n=o,r=i=arguments[1]):o instanceof t?(e=o.min.x,n=o.max.x,r=o.min.y,i=o.max.y):(e=n=o.x,r=i=o.y),e>=this.min.x&&n<=this.max.x&&r>=this.min.y&&i<=this.max.y}},{key:"overlaps",value:function(t){return!(this.right<t.left||this.left>t.right||this.bottom<t.top||this.top>t.bottom)}},{key:"isFinite",value:function(t){function e(){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(){return isFinite(this.min.x)&&isFinite(this.max.x)&&isFinite(this.min.y)&&isFinite(this.max.y)}))},{key:"translate",value:function(){var t,e;2===arguments.length?(t=arguments[0],e=arguments[1]):(t=arguments[0].x,e=arguments[0].y),this.min.x+=t,this.max.x+=t,this.min.y+=e,this.max.y+=e}},{key:"shift",value:function(){var t,e;2===arguments.length?(t=arguments[0],e=arguments[1]):(t=arguments[0].x,e=arguments[0].y);var n=this.max.x-this.min.x,r=this.max.y-this.min.y;this.min.x=t,this.max.x=t+n,this.min.y=e,this.max.y=e+r}},{key:"clone",value:function(){var e=new t;return e.addBounds(this),e}},{key:"toPolygon",value:function(){return pool$1.pull("Polygon",this.x,this.y,[pool$1.pull("Vector2d",0,0),pool$1.pull("Vector2d",this.width,0),pool$1.pull("Vector2d",this.width,this.height),pool$1.pull("Vector2d",0,this.height)])}}]),t}(),TMXRenderer=function(){function t(e,n,r,i){_classCallCheck(this,t),this.cols=e,this.rows=n,this.tilewidth=r,this.tileheight=i,this.bounds=new Bounds}return _createClass(t,[{key:"canRender",value:function(t){return this.tilewidth===t.tilewidth&&this.tileheight===t.tileheight}},{key:"getBounds",value:function(t){var e=t instanceof TMXLayer?pool$1.pull("Bounds"):this.bounds;return e.setMinMax(0,0,this.cols*this.tilewidth,this.rows*this.tileheight),e}},{key:"pixelToTileCoords",value:function(t,e,n){return n}},{key:"tileToPixelCoords",value:function(t,e,n){return n}},{key:"drawTile",value:function(t,e,n,r){}},{key:"drawTileLayer",value:function(t,e,n){}}]),t}(),TMXOrthogonalRenderer=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){return _classCallCheck(this,n),e.call(this,t.cols,t.rows,t.tilewidth,t.tileheight)}return _createClass(n,[{key:"canRender",value:function(t){return"orthogonal"===t.orientation&&_get(_getPrototypeOf(n.prototype),"canRender",this).call(this,t)}},{key:"pixelToTileCoords",value:function(t,e,n){return(n||new Vector2d).set(t/this.tilewidth,e/this.tileheight)}},{key:"tileToPixelCoords",value:function(t,e,n){return(n||new Vector2d).set(t*this.tilewidth,e*this.tileheight)}},{key:"adjustPosition",value:function(t){"number"==typeof t.gid&&(t.y-=t.height)}},{key:"drawTile",value:function(t,e,n,r){var i=r.tileset;i.drawTile(t,i.tileoffset.x+e*this.tilewidth,i.tileoffset.y+(n+1)*this.tileheight-i.tileheight,r)}},{key:"drawTileLayer",value:function(t,e,n){var r=1,i=1,o=this.pixelToTileCoords(Math.max(n.pos.x-(e.maxTileSize.width-e.tilewidth),0),Math.max(n.pos.y-(e.maxTileSize.height-e.tileheight),0),pool$1.pull("Vector2d")).floorSelf(),a=this.pixelToTileCoords(n.pos.x+n.width+this.tilewidth,n.pos.y+n.height+this.tileheight,pool$1.pull("Vector2d")).ceilSelf();switch(a.x=a.x>this.cols?this.cols:a.x,a.y=a.y>this.rows?this.rows:a.y,e.renderorder){case"right-up":a.y=o.y+(o.y=a.y)-a.y,i=-1;break;case"left-down":a.x=o.x+(o.x=a.x)-a.x,r=-1;break;case"left-up":a.x=o.x+(o.x=a.x)-a.x,a.y=o.y+(o.y=a.y)-a.y,r=-1,i=-1}for(var s=o.y;s!==a.y;s+=i)for(var l=o.x;l!==a.x;l+=r){var u=e.cellAt(l,s,!1);u&&this.drawTile(t,l,s,u)}pool$1.push(o),pool$1.push(a)}}]),n}(TMXRenderer),TMXIsometricRenderer=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r;return _classCallCheck(this,n),(r=e.call(this,t.cols,t.rows,t.tilewidth,t.tileheight)).hTilewidth=r.tilewidth/2,r.hTileheight=r.tileheight/2,r.originX=r.rows*r.hTilewidth,r}return _createClass(n,[{key:"canRender",value:function(t){return"isometric"===t.orientation&&_get(_getPrototypeOf(n.prototype),"canRender",this).call(this,t)}},{key:"getBounds",value:function(t){var e=t instanceof TMXLayer?pool$1.pull("Bounds"):this.bounds;return e.setMinMax(0,0,(this.cols+this.rows)*(this.tilewidth/2),(this.cols+this.rows)*(this.tileheight/2)),e}},{key:"pixelToTileCoords",value:function(t,e,n){return(n||new Vector2d).set(e/this.tileheight+(t-this.originX)/this.tilewidth,e/this.tileheight-(t-this.originX)/this.tilewidth)}},{key:"tileToPixelCoords",value:function(t,e,n){return(n||new Vector2d).set((t-e)*this.hTilewidth+this.originX,(t+e)*this.hTileheight)}},{key:"adjustPosition",value:function(t){var e=t.x/this.hTilewidth,n=t.y/this.tileheight,r=pool$1.pull("Vector2d");this.tileToPixelCoords(e,n,r),t.x=r.x,t.y=r.y,pool$1.push(r)}},{key:"drawTile",value:function(t,e,n,r){var i=r.tileset;i.drawTile(t,(this.cols-1)*i.tilewidth+(e-n)*i.tilewidth>>1,-i.tilewidth+(e+n)*i.tileheight>>2,r)}},{key:"drawTileLayer",value:function(t,e,n){var r=e.tileset,i=this.pixelToTileCoords(n.pos.x-r.tilewidth,n.pos.y-r.tileheight,pool$1.pull("Vector2d")).floorSelf(),o=this.pixelToTileCoords(n.pos.x+n.width+r.tilewidth,n.pos.y+n.height+r.tileheight,pool$1.pull("Vector2d")).ceilSelf(),a=this.tileToPixelCoords(o.x,o.y,pool$1.pull("Vector2d")),s=this.tileToPixelCoords(i.x,i.y,pool$1.pull("Vector2d"));s.x-=this.hTilewidth,s.y+=this.tileheight;var l=s.y-n.pos.y>this.hTileheight,u=n.pos.x-s.x<this.hTilewidth;l&&(u?(i.x--,s.x-=this.hTilewidth):(i.y--,s.x+=this.hTilewidth),s.y-=this.hTileheight);for(var c=l^u,h=i.clone(),f=2*s.y;f-2*this.tileheight<2*a.y;f+=this.tileheight){h.setV(i);for(var d=s.x;d<a.x;d+=this.tilewidth){var p=e.cellAt(h.x,h.y);if(p){var y=(r=p.tileset).tileoffset;r.drawTile(t,y.x+d,y.y+f/2-r.tileheight,p)}h.x++,h.y--}c?(i.y++,s.x-=this.hTilewidth,c=!1):(i.x++,s.x+=this.hTilewidth,c=!0)}pool$1.push(h),pool$1.push(i),pool$1.push(o),pool$1.push(a),pool$1.push(s)}}]),n}(TMXRenderer),offsetsStaggerX=[{x:0,y:0},{x:1,y:-1},{x:1,y:0},{x:2,y:0}],offsetsStaggerY=[{x:0,y:0},{x:-1,y:1},{x:0,y:1},{x:0,y:2}],TMXHexagonalRenderer=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r;return _classCallCheck(this,n),(r=e.call(this,t.cols,t.rows,-2&t.tilewidth,-2&t.tileheight)).hexsidelength=t.hexsidelength||0,r.staggerX="x"===t.staggeraxis,r.staggerEven="even"===t.staggerindex,r.sidelengthx=0,r.sidelengthy=0,"hexagonal"===t.orientation&&(r.staggerX?r.sidelengthx=r.hexsidelength:r.sidelengthy=r.hexsidelength),r.sideoffsetx=(r.tilewidth-r.sidelengthx)/2,r.sideoffsety=(r.tileheight-r.sidelengthy)/2,r.columnwidth=r.sideoffsetx+r.sidelengthx,r.rowheight=r.sideoffsety+r.sidelengthy,r.centers=[new Vector2d,new Vector2d,new Vector2d,new Vector2d],r}return _createClass(n,[{key:"canRender",value:function(t){return"hexagonal"===t.orientation&&_get(_getPrototypeOf(n.prototype),"canRender",this).call(this,t)}},{key:"getBounds",value:function(t){var e=t instanceof TMXLayer?pool$1.pull("Bounds"):this.bounds;return this.staggerX?(e.setMinMax(0,0,this.cols*this.columnwidth+this.sideoffsetx,this.rows*(this.tileheight+this.sidelengthy)),e.width>1&&(e.height+=this.rowheight)):(e.setMinMax(0,0,this.cols*(this.tilewidth+this.sidelengthx),this.rows*this.rowheight+this.sideoffsety),e.height>1&&(e.width+=this.columnwidth)),e}},{key:"doStaggerX",value:function(t){return this.staggerX&&1&t^this.staggerEven}},{key:"doStaggerY",value:function(t){return!this.staggerX&&1&t^this.staggerEven}},{key:"topLeft",value:function(t,e,n){var r=n||new Vector2d;return this.staggerX?1&t^this.staggerEven?r.set(t-1,e):r.set(t-1,e-1):1&e^this.staggerEven?r.set(t,e-1):r.set(t-1,e-1),r}},{key:"topRight",value:function(t,e,n){var r=n||new Vector2d;return this.staggerX?1&t^this.staggerEven?r.set(t+1,e):r.set(t+1,e-1):1&e^this.staggerEven?r.set(t+1,e-1):r.set(t,e-1),r}},{key:"bottomLeft",value:function(t,e,n){var r=n||new Vector2d;return this.staggerX?1&t^this.staggerEven?r.set(t-1,e+1):r.set(t-1,e):1&e^this.staggerEven?r.set(t,e+1):r.set(t-1,e+1),r}},{key:"bottomRight",value:function(t,e,n){var r=n||new Vector2d;return this.staggerX?1&t^this.staggerEven?r.set(t+1,e+1):r.set(t+1,e):1&e^this.staggerEven?r.set(t+1,e+1):r.set(t,e+1),r}},{key:"pixelToTileCoords",value:function(t,e,n){var r=n||new Vector2d;this.staggerX?t-=this.staggerEven?this.tilewidth:this.sideoffsetx:e-=this.staggerEven?this.tileheight:this.sideoffsety;var i,o,a,s,l=pool$1.pull("Vector2d",Math.floor(t/(2*this.columnwidth)),Math.floor(e/(2*this.rowheight))),u=pool$1.pull("Vector2d",t-l.x*(2*this.columnwidth),e-l.y*(2*this.rowheight));this.staggerX?(l.x=2*l.x,this.staggerEven&&++l.x):(l.y=2*l.y,this.staggerEven&&++l.y),this.staggerX?(a=(i=this.sidelengthx/2)+this.columnwidth,s=this.tileheight/2,this.centers[0].set(i,s),this.centers[1].set(a,s-this.rowheight),this.centers[2].set(a,s+this.rowheight),this.centers[3].set(a+this.columnwidth,s)):(o=this.sidelengthy/2,a=this.tilewidth/2,s=o+this.rowheight,this.centers[0].set(a,o),this.centers[1].set(a-this.columnwidth,s),this.centers[2].set(a+this.columnwidth,s),this.centers[3].set(a,s+this.rowheight));for(var c=0,h=Number.MAX_VALUE,f=0;f<4;++f){var d=this.centers[f].sub(u).length2();d<h&&(h=d,c=f)}var p=this.staggerX?offsetsStaggerX:offsetsStaggerY;return r.set(l.x+p[c].x,l.y+p[c].y),pool$1.push(l),pool$1.push(u),r}},{key:"tileToPixelCoords",value:function(t,e,n){var r=Math.floor(t),i=Math.floor(e),o=n||new Vector2d;return this.staggerX?(o.y=i*(this.tileheight+this.sidelengthy),this.doStaggerX(r)&&(o.y+=this.rowheight),o.x=r*this.columnwidth):(o.x=r*(this.tilewidth+this.sidelengthx),this.doStaggerY(i)&&(o.x+=this.columnwidth),o.y=i*this.rowheight),o}},{key:"adjustPosition",value:function(t){"number"==typeof t.gid&&(t.y-=t.height)}},{key:"drawTile",value:function(t,e,n,r){var i=r.tileset,o=this.tileToPixelCoords(e,n,pool$1.pull("Vector2d"));i.drawTile(t,i.tileoffset.x+o.x,i.tileoffset.y+o.y+(this.tileheight-i.tileheight),r),pool$1.push(o)}},{key:"drawTileLayer",value:function(t,e,n){var r,i=this.pixelToTileCoords(n.pos.x,n.pos.y,pool$1.pull("Vector2d"));i.sub(e.pos);var o=this.tileToPixelCoords(i.x+e.pos.x,i.y+e.pos.y,pool$1.pull("Vector2d")),a=i.clone(),s=o.clone(),l=n.pos.y-o.y<this.sideoffsety,u=n.pos.x-o.x<this.sideoffsetx;l&&i.y--,u&&i.x--;var c=e.cols,h=e.rows;if(this.staggerX){i.x=Math.max(0,i.x),i.y=Math.max(0,i.y),o=this.tileToPixelCoords(i.x+e.pos.x,i.y+e.pos.y);for(var f=this.doStaggerX(i.x+e.pos.x);o.y<n.bottom&&i.y<h;){for(a.setV(i),s.setV(o);s.x<n.right&&a.x<c;a.x+=2)(r=e.cellAt(a.x,a.y,!1))&&r.tileset.drawTile(t,s.x,s.y,r),s.x+=this.tilewidth+this.sidelengthx;f?(i.x-=1,i.y+=1,o.x-=this.columnwidth,f=!1):(i.x+=1,o.x+=this.columnwidth,f=!0),o.y+=this.rowheight}pool$1.push(a),pool$1.push(s)}else{for(i.x=Math.max(0,i.x),i.y=Math.max(0,i.y),o=this.tileToPixelCoords(i.x+e.pos.x,i.y+e.pos.y),this.doStaggerY(i.y)&&(o.x-=this.columnwidth);o.y<n.bottom&&i.y<h;i.y++){for(a.setV(i),s.setV(o),this.doStaggerY(i.y)&&(s.x+=this.columnwidth);s.x<n.right&&a.x<c;a.x++)(r=e.cellAt(a.x,a.y,!1))&&r.tileset.drawTile(t,s.x,s.y,r),s.x+=this.tilewidth+this.sidelengthx;o.y+=this.rowheight}pool$1.push(a),pool$1.push(s)}pool$1.push(i),pool$1.push(o)}}]),n}(TMXRenderer),TMXStaggeredRenderer=function(t){_inherits(n,t);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"canRender",value:function(t){return"staggered"===t.orientation&&_get(_getPrototypeOf(n.prototype),"canRender",this).call(this,t)}},{key:"pixelToTileCoords",value:function(t,e,n){var r=n||new Vector2d,i=t,o=e;this.staggerX?i-=this.staggerEven?this.sideoffsetx:0:o-=this.staggerEven?this.sideoffsety:0;var a=pool$1.pull("Vector2d",Math.floor(i/this.tilewidth),Math.floor(o/this.tileheight));this.staggerX?(a.x=2*a.x,this.staggerEven&&++a.x):(a.y=2*a.y,this.staggerEven&&++a.y);var s=pool$1.pull("Vector2d",i-a.x*this.tilewidth,o-a.y*this.tileheight),l=s.x*(this.tileheight/this.tilewidth);return this.sideoffsety-l>s.y&&(a=this.topLeft(a.x,a.y,a)),-this.sideoffsety+l>s.y&&(a=this.topRight(a.x,a.y,a)),this.sideoffsety+l<s.y&&(a=this.bottomLeft(a.x,a.y,a)),3*this.sideoffsety-l<s.y&&(a=this.bottomRight(a.x,a.y,a)),(r=this.tileToPixelCoords(a.x,a.y,r)).set(t-r.x,e-r.y),r.set(r.x-this.tilewidth/2,r.y*(this.tilewidth/this.tileheight)),r.div(this.tilewidth/Math.sqrt(2)).rotate(degToRad(-45)).add(a),pool$1.push(a),pool$1.push(s),r}}]),n}(TMXHexagonalRenderer),TMXTileset=function(){function t(e){_classCallCheck(this,t);var n=0;if(this.TileProperties=[],this.imageCollection=[],this.firstgid=this.lastgid=+e.firstgid,void 0!==e.source){var r=e.source,i=getExtension(r);if(("tsx"===i||"json"===i)&&!(e=loader.getTMX(getBasename(r))))throw new Error(r+" external TSX/JSON tileset not found")}this.name=e.name,this.tilewidth=+e.tilewidth,this.tileheight=+e.tileheight,this.spacing=+e.spacing||0,this.margin=+e.margin||0,this.tileoffset=new Vector2d,this.isAnimated=!1,this.isCollection=!1,this.animations=new Map,this._lastUpdate=0;var o=e.tiles;for(n in o)if(o.hasOwnProperty(n)){if("animation"in o[n]&&(this.isAnimated=!0,this.animations.set(o[+n].animation[0].tileid,{dt:0,idx:0,frames:o[+n].animation,cur:o[+n].animation[0]})),"properties"in o[n])if(Array.isArray(o[n].properties)){var a={};for(var s in o[n].properties)a[o[n].properties[s].name]=o[n].properties[s].value;this.setTileProperty(+o[n].id+this.firstgid,a)}else this.setTileProperty(+n+this.firstgid,o[n].properties);if("image"in o[n]){var l=loader.getImage(o[n].image);if(!l)throw new Error("melonJS: '"+o[n].image+"' file for tile '"+(+n+this.firstgid)+"' not found!");this.imageCollection[+n+this.firstgid]=l}}this.isCollection=this.imageCollection.length>0;var u=e.tileoffset;u&&(this.tileoffset.x=+u.x,this.tileoffset.y=+u.y);var c=e.tileproperties;if(c)for(n in c)c.hasOwnProperty(n)&&this.setTileProperty(+n+this.firstgid,c[n]);if(!1===this.isCollection){if(this.image=loader.getImage(e.image),!this.image)throw new Error("melonJS: '"+e.image+"' file for tileset '"+this.name+"' not found!");this.texture=renderer.cache.get(this.image,{framewidth:this.tilewidth,frameheight:this.tileheight,margin:this.margin,spacing:this.spacing}),this.atlas=this.texture.getAtlas();var h=+e.columns||Math.round(this.image.width/(this.tilewidth+this.spacing)),f=Math.round(this.image.height/(this.tileheight+this.spacing));e.tilecount%h>0&&++f,this.lastgid=this.firstgid+(h*f-1||0),e.tilecount&&this.lastgid-this.firstgid+1!=+e.tilecount&&console.warn("Computed tilecount ("+(this.lastgid-this.firstgid+1)+") does not match expected tilecount ("+e.tilecount+")")}}return _createClass(t,[{key:"getTileImage",value:function(t){return this.imageCollection[t]}},{key:"setTileProperty",value:function(t,e){this.TileProperties[t]=e}},{key:"contains",value:function(t){return t>=this.firstgid&&t<=this.lastgid}},{key:"getViewTileId",value:function(t){var e=t-this.firstgid;return this.animations.has(e)?this.animations.get(e).cur.tileid:e}},{key:"getTileProperties",value:function(t){return this.TileProperties[t]}},{key:"update",value:function(t){var e=0,n=timer$1.getTime(),r=!1;return this._lastUpdate!==n&&(this._lastUpdate=n,this.animations.forEach((function(n){for(n.dt+=t,e=n.cur.duration;n.dt>=e;)n.dt-=e,n.idx=(n.idx+1)%n.frames.length,n.cur=n.frames[n.idx],e=n.cur.duration,r=!0}))),r}},{key:"drawTile",value:function(t,e,n,r){if(r.flipped&&(t.save(),t.translate(e,n),t.transform(r.currentTransform),e=n=0),!0===this.isCollection)t.drawImage(this.imageCollection[r.tileId],0,0,r.width,r.height,e,n,r.width,r.height);else{var i=this.atlas[this.getViewTileId(r.tileId)].offset;t.drawImage(this.image,i.x,i.y,this.tilewidth,this.tileheight,e,n,this.tilewidth+t.uvOffset,this.tileheight+t.uvOffset)}r.flipped&&t.restore()}}]),t}(),TMX_CLEAR_BIT_MASK=536870911,TMXTilesetGroup=function(){function t(){_classCallCheck(this,t),this.tilesets=[],this.length=0}return _createClass(t,[{key:"add",value:function(t){this.tilesets.push(t),this.length++}},{key:"getTilesetByIndex",value:function(t){return this.tilesets[t]}},{key:"getTilesetByGid",value:function(t){var e=-1;t&=TMX_CLEAR_BIT_MASK;for(var n=0,r=this.tilesets.length;n<r;n++){if(this.tilesets[n].contains(t))return this.tilesets[n];this.tilesets[n].firstgid===this.tilesets[n].lastgid&&t>=this.tilesets[n].firstgid&&(e=n)}if(-1!==e)return this.tilesets[e];throw new Error("no matching tileset found for gid "+t)}}]),t}(),TMXObject=function(){function t(e,n,r){_classCallCheck(this,t),this.points=void 0,this.name=n.name,this.x=+n.x,this.y=+n.y,this.z=+r,this.width=+n.width||0,this.height=+n.height||0,this.gid=+n.gid||null,this.tintcolor=n.tintcolor,this.type=n.type,this.type=n.type,this.rotation=degToRad(+n.rotation||0),this.id=+n.id||void 0,this.orientation=e.orientation,this.shapes=void 0,this.isEllipse=!1,this.isPolygon=!1,this.isPolyLine=!1,"number"==typeof this.gid?this.setTile(e.tilesets):void 0!==n.ellipse?this.isEllipse=!0:void 0!==n.polygon?(this.points=n.polygon,this.isPolygon=!0):void 0!==n.polyline&&(this.points=n.polyline,this.isPolyLine=!0),void 0!==n.text?(this.text=n.text,this.text.font=n.text.fontfamily||"sans-serif",this.text.size=n.text.pixelsize||16,this.text.fillStyle=n.text.color||"#000000",this.text.textAlign=n.text.halign||"left",this.text.textBaseline=n.text.valign||"top",this.text.width=this.width,this.text.height=this.height,applyTMXProperties(this.text,n)):(applyTMXProperties(this,n),this.shapes||(this.shapes=this.parseTMXShapes())),e.isEditor||e.getRenderer().adjustPosition(this)}return _createClass(t,[{key:"setTile",value:function(t){var e=t.getTilesetByGid(this.gid);!1===e.isCollection&&(this.width=this.framewidth=e.tilewidth,this.height=this.frameheight=e.tileheight),this.tile=new Tile(this.x,this.y,this.gid,e)}},{key:"parseTMXShapes",value:function(){var t=0,e=[];if(!0===this.isEllipse)e.push(pool$1.pull("Ellipse",this.width/2,this.height/2,this.width,this.height).rotate(this.rotation));else if(!0===this.isPolygon){var n=pool$1.pull("Polygon",0,0,this.points);if(!1===n.isConvex())throw new Error("collision polygones in Tiled should be defined as Convex");e.push(n.rotate(this.rotation))}else if(!0===this.isPolyLine){var r,i,o=this.points,a=o.length-1;for(t=0;t<a;t++)r=pool$1.pull("Vector2d",o[t].x,o[t].y),i=pool$1.pull("Vector2d",o[t+1].x,o[t+1].y),0!==this.rotation&&(r=r.rotate(this.rotation),i=i.rotate(this.rotation)),e.push(pool$1.pull("Line",0,0,[r,i]))}else e.push(pool$1.pull("Polygon",0,0,[pool$1.pull("Vector2d"),pool$1.pull("Vector2d",this.width,0),pool$1.pull("Vector2d",this.width,this.height),pool$1.pull("Vector2d",0,this.height)]).rotate(this.rotation));if("isometric"===this.orientation)for(t=0;t<e.length;t++)e[t].toIso();return e}},{key:"getObjectPropertyByName",value:function(t){return this[t]}}]),t}(),TMXGroup=function(){function t(e,n,r){var i=this;_classCallCheck(this,t),this.name=n.name,this.width=n.width||0,this.height=n.height||0,this.tintcolor=n.tintcolor,this.z=r,this.objects=[];var o=void 0===n.visible||n.visible;this.opacity=!0===o?_clamp(+n.opacity||1,0,1):0,applyTMXProperties(this,n),n.objects&&n.objects.forEach((function(t){t.tintcolor=i.tintcolor,i.objects.push(new TMXObject(e,t,r))})),n.layers&&n.layers.forEach((function(t){var n=new TMXLayer(e,t,e.tilewidth,e.tileheight,e.orientation,e.tilesets,r++);n.setRenderer(e.getRenderer()),i.width=Math.max(i.width,n.width),i.height=Math.max(i.height,n.height),i.objects.push(n)}))}return _createClass(t,[{key:"destroy",value:function(){this.objects=null}},{key:"getObjectCount",value:function(){return this.objects.length}},{key:"getObjectByIndex",value:function(t){return this.objects[t]}}]),t}(),COLLISION_GROUP="collision";function getNewDefaultRenderer(t){switch(t.orientation){case"orthogonal":return new TMXOrthogonalRenderer(t);case"isometric":return new TMXIsometricRenderer(t);case"hexagonal":return new TMXHexagonalRenderer(t);case"staggered":return new TMXStaggeredRenderer(t);default:throw new Error(t.orientation+" type TMX Tile Map not supported!")}}function readLayer(t,e,n){return new TMXLayer(t,e,t.tilewidth,t.tileheight,t.orientation,t.tilesets,n)}function readImageLayer(t,e,n){applyTMXProperties(e.properties,e);var r=pool$1.pull("ImageLayer",+e.offsetx||+e.x||0,+e.offsety||+e.y||0,Object.assign({name:e.name,image:e.image,ratio:pool$1.pull("Vector2d",+e.parallaxx||1,+e.parallaxy||1),tint:void 0!==e.tintcolor?pool$1.pull("Color").parseHex(e.tintcolor,!0):void 0,z:n},e.properties)),i=void 0===e.visible||e.visible;return r.setOpacity(i?+e.opacity:0),r}function readTileset(t){return new TMXTileset(t)}function readObjectGroup(t,e,n){return new TMXGroup(t,e,n)}var TMXTileMap=function(){function t(e,n){if(_classCallCheck(this,t),this.data=n,this.name=e,this.cols=+n.width,this.rows=+n.height,this.tilewidth=+n.tilewidth,this.tileheight=+n.tileheight,this.infinite=+n.infinite,this.orientation=n.orientation,this.renderorder=n.renderorder||"right-down",this.version=n.version,this.tiledversion=n.tiledversion,this.tilesets=null,void 0===this.layers&&(this.layers=[]),void 0===this.objectGroups&&(this.objectGroups=[]),this.isEditor="melon-editor"===n.editor,this.nextobjectid=+n.nextobjectid||void 0,this.hexsidelength=+n.hexsidelength,this.staggeraxis=n.staggeraxis,this.staggerindex=n.staggerindex,this.bounds=this.getRenderer().getBounds().clone(),this.width=this.bounds.width,this.height=this.bounds.height,this.backgroundcolor=n.backgroundcolor,applyTMXProperties(this,n),this.initialized=!1,1===this.infinite)throw new Error("Tiled Infinite Map not supported!")}return _createClass(t,[{key:"getRenderer",value:function(){return void 0!==this.renderer&&this.renderer.canRender(this)||(this.renderer=getNewDefaultRenderer(this)),this.renderer}},{key:"getBounds",value:function(){return this.bounds}},{key:"readMapObjects",value:function(t){var e=this;if(!0!==this.initialized){var n=0;this.tilesets||(this.tilesets=new TMXTilesetGroup),void 0!==t.tilesets&&t.tilesets.forEach((function(t){e.tilesets.add(readTileset(t))})),this.background_image&&this.layers.push(pool$1.pull("ImageLayer",0,0,{name:"background_image",image:this.background_image,z:n++})),t.layers.forEach((function(t){switch(t.type){case"imagelayer":e.layers.push(readImageLayer(e,t,n++));break;case"tilelayer":e.layers.push(readLayer(e,t,n++));break;case"objectgroup":case"group":e.objectGroups.push(readObjectGroup(e,t,n++))}})),this.initialized=!0}}},{key:"addTo",value:function(t,e,n){var r=t.autoSort,i=t.autoDepth,o=this.getBounds();function a(e,n){viewport.setBounds(0,0,Math.max(o.width,e),Math.max(o.height,n)),t.pos.set(Math.max(0,~~((e-o.width)/2)),Math.max(0,~~((n-o.height)/2)),t.pos.z)}t.autoSort=!1,t.autoDepth=!1,this.backgroundcolor&&t.backgroundColor.parseCSS(this.backgroundcolor),this.getLayers().forEach((function(e){t.addChild(e)})),this.getObjects(e).forEach((function(e){t.addChild(e)})),t.resize(this.bounds.width,this.bounds.height),t.sort(!0),!0===n&&(off(VIEWPORT_ONRESIZE,a),a(viewport.width,viewport.height),on(VIEWPORT_ONRESIZE,a,this)),t.autoSort=r,t.autoDepth=i}},{key:"getObjects",value:function(t){var e,n=[],r=!1;this.readMapObjects(this.data);for(var i=0;i<this.objectGroups.length;i++){var o=this.objectGroups[i];r=o.name.toLowerCase().includes(COLLISION_GROUP),!1===t&&((e=new Container(0,0,this.width,this.height)).anchorPoint.set(0,0),e.name=o.name,e.pos.z=o.z,e.setOpacity(o.opacity),e.autoSort=!1,e.autoDepth=!1);for(var a=0;a<o.objects.length;a++){var s,l,u=o.objects[a];void 0===u.anchorPoint&&(u.anchorPoint={x:0,y:0}),void 0!==u.tintcolor&&(u.tint=pool$1.pull("Color"),u.tint.parseHex(u.tintcolor,!0)),u instanceof TMXLayer?s=u:"object"===_typeof(u.text)?(void 0===u.text.anchorPoint&&(u.text.anchorPoint=u.anchorPoint),(s=!0===u.text.bitmap?pool$1.pull("BitmapText",u.x,u.y,u.text):pool$1.pull("Text",u.x,u.y,u.text)).pos.z=u.z):"object"===_typeof(u.tile)?(void 0===(l=u.shapes)&&(l=pool$1.pull("Polygon",0,0,[pool$1.pull("Vector2d",0,0),pool$1.pull("Vector2d",this.width,0),pool$1.pull("Vector2d",this.width,this.height)])),(s=u.tile.getRenderable(u)).body=new Body(s,l),s.body.setStatic(!0),s.pos.setMuted(u.x,u.y,u.z)):(void 0!==u.name&&""!==u.name?s=pool$1.pull(u.name,u.x,u.y,u):(s=pool$1.pull("Renderable",u.x,u.y,u.width,u.height),void 0===(l=u.shapes)&&(l=pool$1.pull("Polygon",0,0,[pool$1.pull("Vector2d",0,0),pool$1.pull("Vector2d",this.width,0),pool$1.pull("Vector2d",this.width,this.height)])),s.anchorPoint.set(0,0),s.name=u.name,s.type=u.type,s.id=u.id,s.body=new Body(s,l),s.body.setStatic(!0),s.resize(s.body.getBounds().width,s.body.getBounds().height)),s.pos.z=u.z),r&&!u.name&&s.body&&(s.body.collisionType=collision.types.WORLD_SHAPE,s.body.isStatic=!0),!1!==t?(!0===s.isRenderable&&(s.setOpacity(s.getOpacity()*o.opacity),s.renderable instanceof Renderable&&s.renderable.setOpacity(s.renderable.getOpacity()*o.opacity)),n.push(s)):e.addChild(s)}!1===t&&e.children.length>0&&(e.autoSort=!0,e.autoDepth=!0,n.push(e))}return n}},{key:"getLayers",value:function(){return this.readMapObjects(this.data),this.layers}},{key:"destroy",value:function(){this.tilesets=void 0,this.layers.length=0,this.objectGroups.length=0,this.initialized=!1}}]),t}(),levels={},levelIdx=[],currentLevelIdx=0;function safeLoadLevel(t,e,n){e.container.reset(),_reset(),levels[level.getCurrentLevelId()]&&levels[level.getCurrentLevelId()].destroy(),currentLevelIdx=levelIdx.indexOf(t),loadTMXLevel(t,e.container,e.flatten,e.setViewportBounds),emit(LEVEL_LOADED,t),e.onLoaded(t),n&&state.restart()}function loadTMXLevel(t,e,n,r){var i=levels[t];utils.resetGUID(t,i.nextobjectid),e.anchorPoint.set(0,0),i.addTo(e,n,r)}var level={add:function(t,e,n){if("tmx"===t)return null==levels[e]&&(levels[e]=new TMXTileMap(e,loader.getTMX(e)),levelIdx.push(e),n&&n(),!0);throw new Error("no level loader defined for format "+t)},load:function(t,e){if(e=Object.assign({container:world,onLoaded:onLevelLoaded,flatten:mergeGroup,setViewportBounds:!0},e||{}),void 0===levels[t])throw new Error("level "+t+" not found");if(!(levels[t]instanceof TMXTileMap))throw new Error("no level loader defined");return state.isRunning()?(state.stop(),utils.function.defer(safeLoadLevel,this,t,e,!0)):safeLoadLevel(t,e),!0},getCurrentLevelId:function(){return levelIdx[currentLevelIdx]},getCurrentLevel:function(){return levels[this.getCurrentLevelId()]},reload:function(t){return this.load(this.getCurrentLevelId(),t)},next:function(t){return currentLevelIdx+1<levelIdx.length&&this.load(levelIdx[currentLevelIdx+1],t)},previous:function(t){return currentLevelIdx-1>=0&&this.load(levelIdx[currentLevelIdx-1],t)},levelCount:function(){return levelIdx.length}},imgList={},tmxList={},binList={},jsonList={},baseURL={},resourceCount=0,loadCount=0,timerId$1=0;function checkLoadStatus(t){if(loadCount===resourceCount){if(!t&&!loader.onload)throw new Error("no load callback defined");clearTimeout(timerId$1);var e=t||loader.onload;setTimeout((function(){e(),emit(LOADER_COMPLETE)}),300)}else timerId$1=setTimeout((function(){checkLoadStatus(t)}),100)}function preloadImage(t,e,n){imgList[t.name]=new Image,imgList[t.name].onload=e,imgList[t.name].onerror=n,"string"==typeof loader.crossOrigin&&(imgList[t.name].crossOrigin=loader.crossOrigin),imgList[t.name].src=t.src+loader.nocache}function preloadFontFace(t,e,n){var r=new FontFace(t.name,t.src);r.load().then((function(){document.fonts.add(r),document.body.style.fontFamily=t.name,e()}),(function(){n(t.name)}))}function preloadTMX(t,e,n){function r(e){tmxList[t.name]=e,"tmx"===t.type&&level.add(t.type,t.name)}if(t.data)return r(t.data),void e();var i=new XMLHttpRequest,o=getExtension(t.src);i.overrideMimeType&&("json"===o?i.overrideMimeType("application/json"):i.overrideMimeType("text/xml")),i.open("GET",t.src+loader.nocache,!0),i.withCredentials=loader.withCredentials,i.ontimeout=n,i.onreadystatechange=function(){if(4===i.readyState)if(200===i.status||0===i.status&&i.responseText){var a=null;switch(o){case"xml":case"tmx":case"tsx":if(device$1.ua.match(/msie/i)||!i.responseXML){if(!globalThis.DOMParser)throw new Error("XML file format loading not supported, use the JSON file format instead");a=(new DOMParser).parseFromString(i.responseText,"text/xml")}else a=i.responseXML;var s=parse(a);switch(o){case"tmx":a=s.map;break;case"tsx":a=s.tilesets[0]}break;case"json":a=JSON.parse(i.responseText);break;default:throw new Error("TMX file format "+o+"not supported !")}r(a),e()}else n(t.name)},i.send()}function preloadJSON(t,e,n){var r=new XMLHttpRequest;r.overrideMimeType&&r.overrideMimeType("application/json"),r.open("GET",t.src+loader.nocache,!0),r.withCredentials=loader.withCredentials,r.ontimeout=n,r.onreadystatechange=function(){4===r.readyState&&(200===r.status||0===r.status&&r.responseText?(jsonList[t.name]=JSON.parse(r.responseText),e()):n(t.name))},r.send()}function preloadBinary(t,e,n){var r=new XMLHttpRequest;r.open("GET",t.src+loader.nocache,!0),r.withCredentials=loader.withCredentials,r.responseType="arraybuffer",r.onerror=n,r.onload=function(){var n=r.response;if(n){for(var i=new Uint8Array(n),o=[],a=0;a<i.byteLength;a++)o[a]=String.fromCharCode(i[a]);binList[t.name]=o.join(""),e()}},r.send()}function preloadJavascript(t,e,n){var r=document.createElement("script");r.src=t.src,r.type="text/javascript","string"==typeof loader.crossOrigin&&(r.crossOrigin=loader.crossOrigin),r.defer=!0,r.onload=function(){e()},r.onerror=function(){n(t.name)},document.getElementsByTagName("body")[0].appendChild(r)}var loader={nocache:"",onload:void 0,onProgress:void 0,crossOrigin:void 0,withCredentials:!1,onResourceLoaded:function(t){var e=++loadCount/resourceCount;this.onProgress&&this.onProgress(e,t),emit(LOADER_PROGRESS,e,t)},onLoadingError:function(t){throw new Error("Failed loading resource "+t.src)},setNocache:function(t){this.nocache=t?"?"+~~(1e7*Math.random()):""},setBaseURL:function(t,e){"*"!==t?baseURL[t]=e:(baseURL.audio=e,baseURL.binary=e,baseURL.image=e,baseURL.json=e,baseURL.js=e,baseURL.tmx=e,baseURL.tsx=e)},preload:function(t,e){for(var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=0;r<t.length;r++)resourceCount+=this.load(t[r],this.onResourceLoaded.bind(this,t[r]),this.onLoadingError.bind(this,t[r]));void 0!==e&&(this.onload=e),!0===n&&state.change(state.LOADING),checkLoadStatus(e)},load:function(t,e,n){switch(void 0!==baseURL[t.type]&&(t.src=baseURL[t.type]+t.src),t.type){case"binary":return preloadBinary.call(this,t,e,n),1;case"image":return preloadImage.call(this,t,e,n),1;case"json":return preloadJSON.call(this,t,e,n),1;case"js":return preloadJavascript.call(this,t,e,n),1;case"tmx":case"tsx":return preloadTMX.call(this,t,e,n),1;case"audio":return _load(t,!!t.stream,e,n),1;case"fontface":return preloadFontFace.call(this,t,e,n),1;default:throw new Error("load : unknown or invalid resource type : "+t.type)}},unload:function(t){switch(t.type){case"binary":return t.name in binList&&(delete binList[t.name],!0);case"image":return t.name in imgList&&(delete imgList[t.name],!0);case"json":return t.name in jsonList&&(delete jsonList[t.name],!0);case"js":case"fontface":return!0;case"tmx":case"tsx":return t.name in tmxList&&(delete tmxList[t.name],!0);case"audio":return _unload(t.name);default:throw new Error("unload : unknown or invalid resource type : "+t.type)}},unloadAll:function(){var t;for(t in binList)binList.hasOwnProperty(t)&&this.unload({name:t,type:"binary"});for(t in imgList)imgList.hasOwnProperty(t)&&this.unload({name:t,type:"image"});for(t in tmxList)tmxList.hasOwnProperty(t)&&this.unload({name:t,type:"tmx"});for(t in jsonList)jsonList.hasOwnProperty(t)&&this.unload({name:t,type:"json"});_unloadAll()},getTMX:function(t){return(t=""+t)in tmxList?tmxList[t]:null},getBinary:function(t){return(t=""+t)in binList?binList[t]:null},getImage:function(t){return(t=getBasename(""+t))in imgList?imgList[t]:null},getJSON:function(t){return(t=""+t)in jsonList?jsonList[t]:null}},audioTracks={},current_track_id=null,retry_counter=0,audioExts=[],soundLoadError=function(t,e){if(retry_counter++>3)throw new Error("melonJS: failed loading "+t);audioTracks[t].load()},stopOnAudioError=!0;function init$1(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"mp3";return audioExts=t.split(","),!howler.Howler.noAudio}function hasFormat(t){return hasAudio()&&howler.Howler.codecs(t)}function hasAudio(){return!howler.Howler.noAudio}function enable(){unmuteAll()}function disable(){muteAll()}function _load(t,e,n,r){var i=[];if(0===audioExts.length)throw new Error("target audio extension(s) should be set through me.audio.init() before calling the preloader.");for(var o=0;o<audioExts.length;o++)i.push(t.src+t.name+"."+audioExts[o]+loader.nocache);return audioTracks[t.name]=new howler.Howl({src:i,volume:howler.Howler.volume(),html5:!0===e,xhrWithCredentials:loader.withCredentials,onloaderror:function(){soundLoadError.call(this,t.name,r)},onload:function(){retry_counter=0,n&&n()}}),1}function play(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,i=audioTracks[t];if(i&&void 0!==i){var o=i.play();return"boolean"==typeof e&&i.loop(e,o),i.volume("number"==typeof r?_clamp(r,0,1):howler.Howler.volume(),o),"function"==typeof n&&(!0===e?i.on("end",n,o):i.once("end",n,o)),o}throw new Error("audio clip "+t+" does not exist")}function fade(t,e,n,r,i){var o=audioTracks[t];if(!o||void 0===o)throw new Error("audio clip "+t+" does not exist");o.fade(e,n,r,i)}function seek(t){var e=audioTracks[t];if(e&&void 0!==e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return e.seek.apply(e,r)}throw new Error("audio clip "+t+" does not exist")}function rate(t){var e=audioTracks[t];if(e&&void 0!==e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return e.rate.apply(e,r)}throw new Error("audio clip "+t+" does not exist")}function stop(t,e){if(void 0!==t){var n=audioTracks[t];if(!n||void 0===n)throw new Error("audio clip "+t+" does not exist");n.stop(e),n.off("end",void 0,e)}else howler.Howler.stop()}function pause(t,e){var n=audioTracks[t];if(!n||void 0===n)throw new Error("audio clip "+t+" does not exist");n.pause(e)}function resume(t,e){var n=audioTracks[t];if(!n||void 0===n)throw new Error("audio clip "+t+" does not exist");n.play(e)}function playTrack(t,e){return play(current_track_id=t,!0,null,e)}function stopTrack(){null!==current_track_id&&(audioTracks[current_track_id].stop(),current_track_id=null)}function pauseTrack(){null!==current_track_id&&audioTracks[current_track_id].pause()}function resumeTrack(){null!==current_track_id&&audioTracks[current_track_id].play()}function getCurrentTrack(){return current_track_id}function setVolume(t){howler.Howler.volume(t)}function getVolume(){return howler.Howler.volume()}function mute(t,e,n){n=void 0===n||!!n;var r=audioTracks[t];if(!r||void 0===r)throw new Error("audio clip "+t+" does not exist");r.mute(n,e)}function unmute(t,e){mute(t,e,!1)}function muteAll(){howler.Howler.mute(!0)}function unmuteAll(){howler.Howler.mute(!1)}function muted(){return howler.Howler._muted}function _unload(t){return t in audioTracks&&(audioTracks[t].unload(),delete audioTracks[t],!0)}function _unloadAll(){for(var t in audioTracks)audioTracks.hasOwnProperty(t)&&_unload(t)}var audio=Object.freeze({__proto__:null,stopOnAudioError,init:init$1,hasFormat,hasAudio,enable,disable,load:_load,play,fade,seek,rate,stop,pause,resume,playTrack,stopTrack,pauseTrack,resumeTrack,getCurrentTrack,setVolume,getVolume,mute,unmute,muteAll,unmuteAll,muted,unload:_unload,unloadAll:_unloadAll}),data={};function isReserved(t){return"add"===t||"remove"===t}on(BOOT,(function(){if(!0===device$1.localStorage){var t=localStorage.getItem("me.save");"string"==typeof t&&t.length>0&&(JSON.parse(t)||[]).forEach((function(t){data[t]=JSON.parse(localStorage.getItem("me.save."+t))}))}}));var save={add:function(t){var e=save;Object.keys(t).forEach((function(n){var r;isReserved(n)||(r=n,Object.defineProperty(e,r,{configurable:!0,enumerable:!0,get:function(){return data[r]},set:function(t){data[r]=t,!0===device$1.localStorage&&localStorage.setItem("me.save."+r,JSON.stringify(t))}}),n in data||(e[n]=t[n]))})),!0===device$1.localStorage&&localStorage.setItem("me.save",JSON.stringify(Object.keys(data)))},remove:function(t){isReserved(t)||void 0!==data[t]&&(delete data[t],!0===device$1.localStorage&&(localStorage.removeItem("me.save."+t),localStorage.setItem("me.save",JSON.stringify(Object.keys(data)))))}},accelInitialized=!1,deviceOrientationInitialized=!1,swipeEnabled=!0;function _disableSwipeFn(t){return t.preventDefault(),"function"==typeof globalThis.scroll&&globalThis.scroll(0,0),!1}var readyBound=!1,isReady=!1,readyList=[];function _domReady(){if(!isReady){if(!device.nodeJS&&!document.body)return setTimeout(_domReady,13);for(void 0!==globalThis.document&&"function"==typeof globalThis.document.removeEventListener&&globalThis.document.removeEventListener("DOMContentLoaded",this._domReady,!1),"function"==typeof globalThis.removeEventListener&&globalThis.removeEventListener("load",_domReady,!1);readyList.length;)readyList.shift().call(globalThis,[]);isReady=!0}}var _domRect={left:0,top:0,x:0,y:0,width:0,height:0,right:0,bottom:0};function _detectDevice(){device.iOS=/iPhone|iPad|iPod/i.test(device.ua),device.android=/Android/i.test(device.ua),device.android2=/Android 2/i.test(device.ua),device.linux=/Linux/i.test(device.ua),device.chromeOS=/CrOS/.test(device.ua),device.wp=/Windows Phone/i.test(device.ua),device.BlackBerry=/BlackBerry/i.test(device.ua),device.Kindle=/Kindle|Silk.*Mobile Safari/i.test(device.ua),device.isMobile=/Mobi/i.test(device.ua)||device.iOS||device.android||device.wp||device.BlackBerry||device.Kindle||!1,device.ejecta=void 0!==globalThis.ejecta,device.isWeixin=/MicroMessenger/i.test(device.ua)}function _checkCapabilities(){_detectDevice(),device.TouchEvent=!!("ontouchstart"in globalThis),device.PointerEvent=!!globalThis.PointerEvent,globalThis.gesture=prefixed("gesture"),device.touch=device.TouchEvent||device.PointerEvent,device.maxTouchPoints=device.touch?device.PointerEvent?globalThis.navigator.maxTouchPoints||1:10:1,device.wheel=void 0!==globalThis.document&&"onwheel"in globalThis.document.createElement("div"),device.hasPointerLockSupport=void 0!==globalThis.document&&void 0!==globalThis.document.pointerLockElement,device.hasDeviceOrientation=!!globalThis.DeviceOrientationEvent,device.hasAccelerometer=!!globalThis.DeviceMotionEvent,device.ScreenOrientation="undefined"!=typeof screen&&void 0!==screen.orientation,device.hasFullscreenSupport=void 0!==globalThis.document&&(prefixed("fullscreenEnabled",globalThis.document)||globalThis.document.mozFullScreenEnabled),!0===device.hasFullscreenSupport&&(globalThis.document.exitFullscreen=void 0!==globalThis.document&&(prefixed("cancelFullScreen",globalThis.document)||prefixed("exitFullscreen",globalThis.document))),device.hasWebAudio=!(!globalThis.AudioContext&&!globalThis.webkitAudioContext);try{device.localStorage=!!globalThis.localStorage}catch(t){device.localStorage=!1}try{device.OffscreenCanvas=void 0!==globalThis.OffscreenCanvas&&null!==new OffscreenCanvas(0,0).getContext("2d")}catch(t){device.OffscreenCanvas=!1}var t,e;"function"==typeof globalThis.addEventListener&&(globalThis.addEventListener("blur",(function(){device.stopOnBlur&&state.stop(!0),device.pauseOnBlur&&state.pause(!0)}),!1),globalThis.addEventListener("focus",(function(){device.stopOnBlur&&state.restart(!0),device.resumeOnFocus&&state.resume(!0),device.autoFocus&&device.focus()}),!1)),void 0!==globalThis.document&&(void 0!==globalThis.document.hidden?(t="hidden",e="visibilitychange"):void 0!==globalThis.document.mozHidden?(t="mozHidden",e="mozvisibilitychange"):void 0!==globalThis.document.msHidden?(t="msHidden",e="msvisibilitychange"):void 0!==globalThis.document.webkitHidden&&(t="webkitHidden",e="webkitvisibilitychange"),"string"==typeof e&&globalThis.document.addEventListener(e,(function(){globalThis.document[t]?(device.stopOnBlur&&state.stop(!0),device.pauseOnBlur&&state.pause(!0)):(device.stopOnBlur&&state.restart(!0),device.resumeOnFocus&&state.resume(!0))}),!1)),device.isMobile&&device.enableSwipe(!1)}on(BOOT,(function(){_checkCapabilities()}));var device={ua:void 0!==globalThis.navigator?globalThis.navigator.userAgent:"",localStorage:!1,hasAccelerometer:!1,hasDeviceOrientation:!1,ScreenOrientation:!1,hasFullscreenSupport:!1,hasPointerLockSupport:!1,hasWebAudio:!1,nativeBase64:"function"==typeof globalThis.atob,maxTouchPoints:1,touch:!1,wheel:!1,isMobile:!1,iOS:!1,android:!1,android2:!1,linux:!1,ejecta:!1,isWeixin:!1,nodeJS:"undefined"!=typeof process&&"node"===process.release.name,chromeOS:!1,wp:!1,BlackBerry:!1,Kindle:!1,accelerationX:0,accelerationY:0,accelerationZ:0,gamma:0,beta:0,alpha:0,language:void 0!==globalThis.navigator&&(globalThis.navigator.language||globalThis.navigator.browserLanguage||globalThis.navigator.userLanguage)||"en",pauseOnBlur:!0,resumeOnFocus:!0,autoFocus:!0,stopOnBlur:!1,OffscreenCanvas:!1,onReady:function(t){isReady?t.call(globalThis,[]):(readyList.push(t),readyBound||(!0===device.nodeJS||void 0!==globalThis.document&&"complete"===globalThis.document.readyState?globalThis.setTimeout(_domReady,0):(void 0!==globalThis.document&&"function"==typeof globalThis.document.addEventListener&&globalThis.document.addEventListener("DOMContentLoaded",_domReady,!1),globalThis.addEventListener("load",_domReady,!1)),readyBound=!0))},enableSwipe:function(t){var e=device.PointerEvent?"pointermove":device.TouchEvent?"touchmove":"mousemove";!1!==t?!1===swipeEnabled&&(globalThis.document.removeEventListener(e,_disableSwipeFn),swipeEnabled=!0):!0===swipeEnabled&&(globalThis.document.addEventListener(e,_disableSwipeFn,{passive:!1}),swipeEnabled=!1)},requestFullscreen:function(t){this.hasFullscreenSupport&&((t=t||getParent()).requestFullscreen=prefixed("requestFullscreen",t)||t.mozRequestFullScreen,t.requestFullscreen())},exitFullscreen:function(){this.hasFullscreenSupport&&document.exitFullscreen()},getScreenOrientation:function(){var t="portrait",e="landscape",n=globalThis.screen;if(!0===this.ScreenOrientation){var r=prefixed("orientation",n);if(void 0!==r&&"string"==typeof r.type)return r.type;if("string"==typeof r)return r}return"number"==typeof globalThis.orientation?90===Math.abs(globalThis.orientation)?e:t:globalThis.outerWidth>globalThis.outerHeight?e:t},lockOrientation:function(t){var e=globalThis.screen;if(void 0!==e){var n=prefixed("lockOrientation",e);if(void 0!==n)return n(t)}return!1},unlockOrientation:function(){var t=globalThis.screen;if(void 0!==t){var e=prefixed("unlockOrientation",t);if(void 0!==e)return e()}return!1},isPortrait:function(){return this.getScreenOrientation().includes("portrait")},isLandscape:function(){return this.getScreenOrientation().includes("landscape")},getStorage:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"local";if("local"===t)return save;throw new Error("storage type "+t+" not supported")},getParentElement:function(t){var e=this.getElement(t);return null!==e.parentNode&&(e=e.parentNode),e},getElement:function(t){var e=null;return"undefined"!==t&&("string"==typeof t?e=document.getElementById(t):"object"===_typeof(t)&&t.nodeType===Node.ELEMENT_NODE&&(e=t)),e||(e=document.body),e},getElementBounds:function(t){return"object"===_typeof(t)&&t!==document.body&&void 0!==t.getBoundingClientRect?t.getBoundingClientRect():(_domRect.width=_domRect.right=globalThis.innerWidth,_domRect.height=_domRect.bottom=globalThis.innerHeight,_domRect)},getParentBounds:function(t){return this.getElementBounds(this.getParentElement(t))},isWebGLSupported:function(t){var e=!1;try{var n=document.createElement("canvas"),r={stencil:!0,failIfMajorPerformanceCaveat:t.failIfMajorPerformanceCaveat};e=!(!globalThis.WebGLRenderingContext||!n.getContext("webgl",r)&&!n.getContext("experimental-webgl",r))}catch(t){e=!1}return e},getMaxShaderPrecision:function(t){return t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.HIGH_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT).precision>0?"highp":t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.MEDIUM_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.MEDIUM_FLOAT).precision>0?"mediump":"lowp"},focus:function(){"function"==typeof globalThis.focus&&globalThis.focus()},onDeviceMotion:function(t){this.accelerationX=t.accelerationIncludingGravity.x,this.accelerationY=t.accelerationIncludingGravity.y,this.accelerationZ=t.accelerationIncludingGravity.z},onDeviceRotate:function(t){this.gamma=t.gamma,this.beta=t.beta,this.alpha=t.alpha},watchAccelerometer:function(){var t=this;return this.hasAccelerometer&&!accelInitialized&&(DeviceOrientationEvent&&"function"==typeof DeviceOrientationEvent.requestPermission?DeviceOrientationEvent.requestPermission().then((function(e){"granted"===e&&(globalThis.addEventListener("devicemotion",t.onDeviceMotion,!1),accelInitialized=!0)})).catch(console.error):(globalThis.addEventListener("devicemotion",this.onDeviceMotion,!1),accelInitialized=!0)),accelInitialized},unwatchAccelerometer:function(){accelInitialized&&(globalThis.removeEventListener("devicemotion",this.onDeviceMotion,!1),accelInitialized=!1)},watchDeviceOrientation:function(){var t=this;return this.hasDeviceOrientation&&!deviceOrientationInitialized&&("function"==typeof DeviceOrientationEvent.requestPermission?DeviceOrientationEvent.requestPermission().then((function(e){"granted"===e&&(globalThis.addEventListener("deviceorientation",t.onDeviceRotate,!1),deviceOrientationInitialized=!0)})).catch(console.error):(globalThis.addEventListener("deviceorientation",this.onDeviceRotate,!1),deviceOrientationInitialized=!0)),deviceOrientationInitialized},unwatchDeviceOrientation:function(){deviceOrientationInitialized&&(globalThis.removeEventListener("deviceorientation",this.onDeviceRotate,!1),deviceOrientationInitialized=!1)},vibrate:function(t){void 0!==globalThis.navigator&&"function"==typeof globalThis.navigator.vibrate&&globalThis.navigator.vibrate(t)}};Object.defineProperty(device,"devicePixelRatio",{get:function(){return globalThis.devicePixelRatio||1}}),Object.defineProperty(device,"isFullscreen",{get:function(){return!(!this.hasFullscreenSupport||!prefixed("fullscreenElement",document)&&!document.mozFullScreenElement)}}),Object.defineProperty(device,"sound",{get:function(){return hasAudio()}});var device$1=device,fnHash={bool:"1i",int:"1i",float:"1f",vec2:"2fv",vec3:"3fv",vec4:"4fv",bvec2:"2iv",bvec3:"3iv",bvec4:"4iv",ivec2:"2iv",ivec3:"3iv",ivec4:"4iv",mat2:"Matrix2fv",mat3:"Matrix3fv",mat4:"Matrix4fv",sampler2D:"1i"};function extractUniforms(t,e){var n,r={},i=/uniform\s+(\w+)\s+(\w+)/g,o={},a={},s={};return[e.vertex,e.fragment].forEach((function(t){for(;n=i.exec(t);)o[n[2]]=n[1]})),Object.keys(o).forEach((function(n){var r=o[n];s[n]=t.getUniformLocation(e.program,n),a[n]={get:function(t){return function(){return s[t]}}(n),set:function(e,n,r){return 0===n.indexOf("mat")?function(n){t[r](s[e],!1,n)}:function(n){var i=r;n.length&&"v"!==r.slice(-1)&&(i+="v"),t[i](s[e],n)}}(n,r,"uniform"+fnHash[r])}})),Object.defineProperties(r,a),r}function extractAttributes(t,e){for(var n,r={},i=/attribute\s+\w+\s+(\w+)/g,o=0;n=i.exec(e.vertex);)r[n[1]]=o++;return r}function compileShader(t,e,n){var r=t.createShader(e);if(t.shaderSource(r,n),t.compileShader(r),!t.getShaderParameter(r,t.COMPILE_STATUS))throw new Error(t.getShaderInfoLog(r));return r}function compileProgram(t,e,n,r){var i=compileShader(t,t.VERTEX_SHADER,e),o=compileShader(t,t.FRAGMENT_SHADER,n),a=t.createProgram();for(var s in t.attachShader(a,i),t.attachShader(a,o),r)t.bindAttribLocation(a,r[s],s);if(t.linkProgram(a),!t.getProgramParameter(a,t.LINK_STATUS)){var l="Error initializing Shader "+this+"\ngl.VALIDATE_STATUS: "+t.getProgramParameter(a,t.VALIDATE_STATUS)+"\ngl.getError()"+t.getError()+"\ngl.getProgramInfoLog()"+t.getProgramInfoLog(a);throw t.deleteProgram(a),a=null,new Error(l)}return t.useProgram(a),t.deleteShader(i),t.deleteShader(o),a}function setPrecision(t,e){return"precision"!==t.substring(0,9)?"precision "+e+" float;"+t:t}function minify(t){return(t=(t=(t=t.replace(/\/\*[\s\S]*?\*\/|([^\\:]|^)\/\/.*$/gm,"$1")).replace(/(\\n\s+)|(\s+\\n)/g,"")).replace(/(\\r|\\n)+/g,"")).replace(/\s*([;,[\](){}\\\/\-+*|^&!=<>?~%])\s*/g,"$1")}var GLShader=function(){function t(e,n,r,i){_classCallCheck(this,t),this.gl=e,this.vertex=setPrecision(minify(n),i||device$1.getMaxShaderPrecision(this.gl)),this.fragment=setPrecision(minify(r),i||device$1.getMaxShaderPrecision(this.gl)),this.attributes=extractAttributes(this.gl,this),this.program=compileProgram(this.gl,this.vertex,this.fragment,this.attributes),this.uniforms=extractUniforms(this.gl,this),on(ONCONTEXT_LOST,this.destroy,this)}return _createClass(t,[{key:"bind",value:function(){this.gl.useProgram(this.program)}},{key:"getAttribLocation",value:function(t){var e=this.attributes[t];return void 0!==e?e:-1}},{key:"setUniform",value:function(t,e){var n=this.uniforms;if(void 0===n[t])throw new Error("undefined ("+t+") uniform for shader "+this);"object"===_typeof(e)&&"function"==typeof e.toArray?n[t]=e.toArray():n[t]=e}},{key:"setVertexAttributes",value:function(t,e,n){for(var r=0;r<e.length;++r){var i=e[r],o=this.getAttribLocation(i.name);-1!==o?(t.enableVertexAttribArray(o),t.vertexAttribPointer(o,i.size,i.type,i.normalized,n,i.offset)):t.disableVertexAttribArray(r)}}},{key:"destroy",value:function(){this.uniforms=null,this.attributes=null,this.gl.deleteProgram(this.program),this.vertex=null,this.fragment=null}}]),t}(),VertexArrayBuffer=function(){function t(e,n){_classCallCheck(this,t),this.vertexSize=e,this.quadSize=n,this.maxVertex=256,this.vertexCount=0,this.buffer=new ArrayBuffer(this.maxVertex*this.vertexSize*this.quadSize),this.bufferF32=new Float32Array(this.buffer),this.bufferU32=new Uint32Array(this.buffer)}return _createClass(t,[{key:"clear",value:function(){this.vertexCount=0}},{key:"isFull",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.quadSize;return this.vertexCount+t>=this.maxVertex}},{key:"resize",value:function(){this.maxVertex<<=1;var t=this.bufferF32;return this.buffer=new ArrayBuffer(this.maxVertex*this.vertexSize*this.quadSize),this.bufferF32=new Float32Array(this.buffer),this.bufferU32=new Uint32Array(this.buffer),this.bufferF32.set(t),this}},{key:"push",value:function(t,e,n,r,i){var o=this.vertexCount*this.vertexSize;return this.vertexCount>=this.maxVertex&&this.resize(),this.bufferF32[o+0]=t,this.bufferF32[o+1]=e,void 0!==n&&(this.bufferF32[o+2]=n,this.bufferF32[o+3]=r),void 0!==i&&(this.bufferU32[o+4]=i),this.vertexCount++,this}},{key:"toFloat32",value:function(t,e){return void 0!==e?this.bufferF32.subarray(t,e):this.bufferF32}},{key:"toUint32",value:function(t,e){return void 0!==e?this.bufferU32.subarray(t,e):this.bufferU32}},{key:"length",value:function(){return this.vertexCount}},{key:"isEmpty",value:function(){return 0===this.vertexCount}}]),t}(),primitiveVertex="// Current vertex point\nattribute vec2 aVertex;\n\n// Projection matrix\nuniform mat4 uProjectionMatrix;\n\n// Vertex color\nuniform vec4 uColor;\n\n// Fragment color\nvarying vec4 vColor;\n\nvoid main(void) {\n    // Transform the vertex position by the projection matrix\n    gl_Position = uProjectionMatrix * vec4(aVertex, 0.0, 1.0);\n    // Pass the remaining attributes to the fragment shader\n    vColor = vec4(uColor.rgb * uColor.a, uColor.a);\n}\n",primitiveFragment="varying vec4 vColor;\n\nvoid main(void) {\n    gl_FragColor = vColor;\n}\n",quadVertex="attribute vec2 aVertex;\nattribute vec2 aRegion;\nattribute vec4 aColor;\n\nuniform mat4 uProjectionMatrix;\n\nvarying vec2 vRegion;\nvarying vec4 vColor;\n\nvoid main(void) {\n    // Transform the vertex position by the projection matrix\n     gl_Position = uProjectionMatrix * vec4(aVertex, 0.0, 1.0);\n    // Pass the remaining attributes to the fragment shader\n    vColor = vec4(aColor.bgr * aColor.a, aColor.a);\n    vRegion = aRegion;\n}\n",quadFragment="uniform sampler2D uSampler;\nvarying vec4 vColor;\nvarying vec2 vRegion;\n\nvoid main(void) {\n    gl_FragColor = texture2D(uSampler, vRegion) * vColor;\n}\n",V_ARRAY=[new Vector2d,new Vector2d,new Vector2d,new Vector2d],WebGLCompositor=function(){function t(e){_classCallCheck(this,t),this.init(e)}return _createClass(t,[{key:"init",value:function(t){var e=this,n=t.gl;this.currentTextureUnit=-1,this.boundTextures=[],this.renderer=t,this.gl=t.gl,this.color=t.currentColor,this.viewMatrix=t.currentTransform,this.activeShader=null,this.mode=n.TRIANGLES,this.attributes=[],this.vertexByteSize=0,this.vertexSize=0,this.primitiveShader=new GLShader(this.gl,primitiveVertex,primitiveFragment),this.quadShader=new GLShader(this.gl,quadVertex,quadFragment),this.addAttribute("aVertex",2,n.FLOAT,!1,0*Float32Array.BYTES_PER_ELEMENT),this.addAttribute("aRegion",2,n.FLOAT,!1,2*Float32Array.BYTES_PER_ELEMENT),this.addAttribute("aColor",4,n.UNSIGNED_BYTE,!0,4*Float32Array.BYTES_PER_ELEMENT),this.vertexBuffer=new VertexArrayBuffer(this.vertexSize,6),n.bindBuffer(n.ARRAY_BUFFER,n.createBuffer()),n.bufferData(n.ARRAY_BUFFER,this.vertexBuffer.buffer,n.STREAM_DRAW),on(CANVAS_ONRESIZE,(function(t,n){e.flush(),e.setViewport(0,0,t,n)}))}},{key:"reset",value:function(){this.gl=this.renderer.gl,this.flush(),this.setViewport(0,0,this.renderer.getScreenCanvas().width,this.renderer.getScreenCanvas().height),this.clearColor(0,0,0,0);for(var t=0;t<this.renderer.maxTextures;t++){var e=this.getTexture2D(t);void 0!==e&&this.deleteTexture2D(e)}this.currentTextureUnit=-1,this.useShader(this.quadShader)}},{key:"addAttribute",value:function(t,e,n,r,i){switch(this.attributes.push({name:t,size:e,type:n,normalized:r,offset:i}),n){case this.gl.BYTE:this.vertexByteSize+=e*Int8Array.BYTES_PER_ELEMENT;break;case this.gl.UNSIGNED_BYTE:this.vertexByteSize+=e*Uint8Array.BYTES_PER_ELEMENT;break;case this.gl.SHORT:this.vertexByteSize+=e*Int16Array.BYTES_PER_ELEMENT;break;case this.gl.UNSIGNED_SHORT:this.vertexByteSize+=e*Uint16Array.BYTES_PER_ELEMENT;break;case this.gl.INT:this.vertexByteSize+=e*Int32Array.BYTES_PER_ELEMENT;break;case this.gl.UNSIGNED_INT:this.vertexByteSize+=e*Uint32Array.BYTES_PER_ELEMENT;break;case this.gl.FLOAT:this.vertexByteSize+=e*Float32Array.BYTES_PER_ELEMENT;break;default:throw new Error("Invalid GL Attribute type")}this.vertexSize=this.vertexByteSize/Float32Array.BYTES_PER_ELEMENT}},{key:"setViewport",value:function(t,e,n,r){this.gl.viewport(t,e,n,r)}},{key:"createTexture2D",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"no-repeat",i=arguments.length>4?arguments[4]:void 0,o=arguments.length>5?arguments[5]:void 0,a=arguments.length>6?arguments[6]:void 0,s=!(arguments.length>7&&void 0!==arguments[7])||arguments[7],l=!(arguments.length>8&&void 0!==arguments[8])||arguments[8],u=this.gl,c=isPowerOfTwo(i||e.width)&&isPowerOfTwo(o||e.height),h=u.createTexture(),f=0===r.search(/^repeat(-x)?$/)&&(c||this.renderer.WebGLVersion>1)?u.REPEAT:u.CLAMP_TO_EDGE,d=0===r.search(/^repeat(-y)?$/)&&(c||this.renderer.WebGLVersion>1)?u.REPEAT:u.CLAMP_TO_EDGE;return this.bindTexture2D(h,t),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,f),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,d),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,n),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,n),u.pixelStorei(u.UNPACK_PREMULTIPLY_ALPHA_WEBGL,s),i||o||a?u.texImage2D(u.TEXTURE_2D,0,u.RGBA,i,o,a,u.RGBA,u.UNSIGNED_BYTE,e):u.texImage2D(u.TEXTURE_2D,0,u.RGBA,u.RGBA,u.UNSIGNED_BYTE,e),c&&!1!==l&&u.generateMipmap(u.TEXTURE_2D),h}},{key:"deleteTexture2D",value:function(t){this.gl.deleteTexture(t),this.unbindTexture2D(t)}},{key:"getTexture2D",value:function(t){return this.boundTextures[t]}},{key:"bindTexture2D",value:function(t,e){var n=this.gl;t!==this.boundTextures[e]?(this.flush(),this.currentTextureUnit!==e&&(this.currentTextureUnit=e,n.activeTexture(n.TEXTURE0+e)),n.bindTexture(n.TEXTURE_2D,t),this.boundTextures[e]=t):this.currentTextureUnit!==e&&(this.flush(),this.currentTextureUnit=e,n.activeTexture(n.TEXTURE0+e))}},{key:"unbindTexture2D",value:function(t,e){return void 0===e&&(e=this.boundTextures.indexOf(t)),-1!==e&&(delete this.boundTextures[e],e===this.currentTextureUnit&&(this.currentTextureUnit=-1)),e}},{key:"uploadTexture",value:function(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=this.renderer.cache.getUnit(t),a=this.boundTextures[o];return void 0===a||i?this.createTexture2D(o,t.getTexture(),this.renderer.settings.antiAlias?this.gl.LINEAR:this.gl.NEAREST,t.repeat,e,n,r,t.premultipliedAlpha):this.bindTexture2D(a,o),this.currentTextureUnit}},{key:"setProjection",value:function(t){this.activeShader.setUniform("uProjectionMatrix",t)}},{key:"useShader",value:function(t){this.activeShader!==t&&(this.flush(),this.activeShader=t,this.activeShader.bind(),this.activeShader.setUniform("uProjectionMatrix",this.renderer.projectionMatrix),this.activeShader.setVertexAttributes(this.gl,this.attributes,this.vertexByteSize))}},{key:"addQuad",value:function(t,e,n,r,i,o,a,s,l,u){if(!(this.color.alpha<1/255)){this.useShader(this.quadShader),this.vertexBuffer.isFull(6)&&this.flush();var c=this.uploadTexture(t);this.quadShader.setUniform("uSampler",c);var h=this.viewMatrix,f=V_ARRAY[0].set(e,n),d=V_ARRAY[1].set(e+r,n),p=V_ARRAY[2].set(e,n+i),y=V_ARRAY[3].set(e+r,n+i);h.isIdentity()||(h.apply(f),h.apply(d),h.apply(p),h.apply(y)),this.vertexBuffer.push(f.x,f.y,o,a,u),this.vertexBuffer.push(d.x,d.y,s,a,u),this.vertexBuffer.push(p.x,p.y,o,l,u),this.vertexBuffer.push(p.x,p.y,o,l,u),this.vertexBuffer.push(d.x,d.y,s,a,u),this.vertexBuffer.push(y.x,y.y,s,l,u)}}},{key:"flush",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.mode,e=this.vertexBuffer,n=e.vertexCount;if(n>0){var r=this.gl,i=e.vertexSize;this.renderer.WebGLVersion>1?r.bufferData(r.ARRAY_BUFFER,e.toFloat32(),r.STREAM_DRAW,0,n*i):r.bufferData(r.ARRAY_BUFFER,e.toFloat32(0,n*i),r.STREAM_DRAW),r.drawArrays(t,0,n),e.clear()}}},{key:"drawVertices",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.length;this.useShader(this.primitiveShader),this.primitiveShader.setUniform("uColor",this.color);for(var r=this.viewMatrix,i=this.vertexBuffer,o=r.isIdentity(),a=0;a<n;a++)o||r.apply(e[a]),i.push(e[a].x,e[a].y);this.flush(t)}},{key:"clearColor",value:function(t,e,n,r){this.gl.clearColor(t,e,n,r)}},{key:"clear",value:function(){this.gl.clear(this.gl.COLOR_BUFFER_BIT)}}]),t}(),WebGLRenderer=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r;_classCallCheck(this,n),(r=e.call(this,t)).WebGLVersion=1,r.GPUVendor=null,r.GPURenderer=null,r.context=r.gl=r.getContextGL(r.getScreenCanvas(),t.transparent),r.maxTextures=r.gl.getParameter(r.gl.MAX_TEXTURE_IMAGE_UNITS),r._colorStack=[],r._matrixStack=[],r._scissorStack=[],r._blendStack=[],r.currentTransform=new Matrix2d,r.currentCompositor=null,r.compositors=new Map;var i=new(r.settings.compositor||WebGLCompositor)(_assertThisInitialized(r));r.compositors.set("default",i),r.setCompositor(i),r.gl.disable(r.gl.DEPTH_TEST),r.gl.disable(r.gl.SCISSOR_TEST),r.gl.enable(r.gl.BLEND),r.setBlendMode(r.settings.blendMode);var o=r.gl.getExtension("WEBGL_debug_renderer_info");return null!==o&&(r.GPUVendor=r.gl.getParameter(o.UNMASKED_VENDOR_WEBGL),r.GPURenderer=r.gl.getParameter(o.UNMASKED_RENDERER_WEBGL)),r.cache=new TextureCache(r.maxTextures),r.getScreenCanvas().addEventListener("webglcontextlost",(function(t){t.preventDefault(),r.isContextValid=!1,emit(ONCONTEXT_LOST,_assertThisInitialized(r))}),!1),r.getScreenCanvas().addEventListener("webglcontextrestored",(function(){r.reset(),r.isContextValid=!0,emit(ONCONTEXT_RESTORED,_assertThisInitialized(r))}),!1),r}return _createClass(n,[{key:"reset",value:function(){var t=this;_get(_getPrototypeOf(n.prototype),"reset",this).call(this),this.compositors.forEach((function(e){!1===t.isContextValid?e.init(t):e.reset()})),this.gl.disable(this.gl.SCISSOR_TEST),void 0!==this.fontContext2D&&this.createFontTexture(this.cache)}},{key:"setCompositor",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default";if("string"==typeof t&&(t=this.compositors.get(t)),void 0===t)throw new Error("Invalid WebGL Compositor");this.currentCompositor!==t&&(null!==this.currentCompositor&&this.currentCompositor.flush(),this.currentCompositor=t)}},{key:"resetTransform",value:function(){this.currentTransform.identity()}},{key:"createFontTexture",value:function(t){if(void 0===this.fontTexture){var e=this.backBufferCanvas,n=e.width,r=e.height;1===this.WebGLVersion&&(isPowerOfTwo(n)||(n=nextPowerOfTwo(e.width)),isPowerOfTwo(r)||(r=nextPowerOfTwo(e.height)));var i=createCanvas(n,r,!0);this.fontContext2D=this.getContext2d(i),this.fontTexture=new TextureAtlas(createAtlas(e.width,e.height,"fontTexture"),i,t),this.currentCompositor.uploadTexture(this.fontTexture,0,0,0)}else t.set(this.fontContext2D.canvas,this.fontTexture)}},{key:"createPattern",value:function(t,e){if(!(1!==renderer.WebGLVersion||isPowerOfTwo(t.width)&&isPowerOfTwo(t.height))){var n=void 0!==t.src?t.src:t;throw new Error("[WebGL Renderer] "+n+" is not a POT texture ("+t.width+"x"+t.height+")")}var r=new TextureAtlas(createAtlas(t.width,t.height,"pattern",e),t);return this.currentCompositor.uploadTexture(r),r}},{key:"flush",value:function(){this.currentCompositor.flush()}},{key:"setProjection",value:function(t){_get(_getPrototypeOf(n.prototype),"setProjection",this).call(this,t),this.currentCompositor.setProjection(t)}},{key:"clearColor",value:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"#000000",n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e instanceof Color)t=e.toArray();else{var r=pool$1.pull("me.Color");t=r.parseCSS(e).toArray(),pool$1.push(r)}this.currentCompositor.clearColor(t[0],t[1],t[2],!0===n?1:t[3]),this.currentCompositor.clear(),this.currentCompositor.clearColor(0,0,0,0)}},{key:"clearRect",value:function(t,e,n,r){this.save(),this.clipRect(t,e,n,r),this.clearColor(),this.restore()}},{key:"drawFont",value:function(t){var e=this.getFontContext();this.currentCompositor.uploadTexture(this.fontTexture,0,0,0,!0);var n=this.fontTexture.getUVs(t.left+","+t.top+","+t.width+","+t.height);this.currentCompositor.addQuad(this.fontTexture,t.left,t.top,t.width,t.height,n[0],n[1],n[2],n[3],this.currentTint.toUint32()),e.clearRect(t.left,t.top,t.width,t.height)}},{key:"drawImage",value:function(t,e,n,r,i,o,a,s,l){void 0===r?(r=s=t.width,i=l=t.height,o=e,a=n,e=0,n=0):void 0===o&&(o=e,a=n,s=r,l=i,r=t.width,i=t.height,e=0,n=0),!1===this.settings.subPixel&&(o|=0,a|=0);var u=this.cache.get(t),c=u.getUVs(e+","+n+","+r+","+i);this.currentCompositor.addQuad(u,o,a,s,l,c[0],c[1],c[2],c[3],this.currentTint.toUint32())}},{key:"drawPattern",value:function(t,e,n,r,i){var o=t.getUVs("0,0,"+r+","+i);this.currentCompositor.addQuad(t,e,n,r,i,o[0],o[1],o[2],o[3],this.currentTint.toUint32())}},{key:"getScreenContext",value:function(){return this.gl}},{key:"getContextGL",value:function(t,e){if(null==t)throw new Error("You must pass a canvas element in order to create a GL context");"boolean"!=typeof e&&(e=!0);var n,r={alpha:e,antialias:this.settings.antiAlias,depth:!1,stencil:!0,preserveDrawingBuffer:!1,premultipliedAlpha:e,powerPreference:this.settings.powerPreference,failIfMajorPerformanceCaveat:this.settings.failIfMajorPerformanceCaveat};if(!1===this.settings.preferWebGL1&&(n=t.getContext("webgl2",r))&&(this.WebGLVersion=2),n||(this.WebGLVersion=1,n=t.getContext("webgl",r)||t.getContext("experimental-webgl",r)),!n)throw new Error("A WebGL context could not be created.");return n}},{key:"getContext",value:function(){return this.gl}},{key:"setBlendMode",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"normal",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.gl;if(this.currentBlendMode!==t)switch(this.flush(),e.enable(e.BLEND),this.currentBlendMode=t,t){case"screen":e.blendFunc(e.ONE,e.ONE_MINUS_SRC_COLOR);break;case"lighter":case"additive":e.blendFunc(e.ONE,e.ONE);break;case"multiply":e.blendFunc(e.DST_COLOR,e.ONE_MINUS_SRC_ALPHA);break;default:e.blendFunc(e.ONE,e.ONE_MINUS_SRC_ALPHA),this.currentBlendMode="normal"}}},{key:"getFontContext",value:function(){return void 0===this.fontContext2D&&(console.warn("[WebGL Renderer] WARNING : Using Standard me.Text with WebGL will severly impact performances !"),this.createFontTexture(this.cache)),this.fontContext2D}},{key:"restore",value:function(){if(0!==this._matrixStack.length){var t=this._colorStack.pop(),e=this._matrixStack.pop();this.currentColor.copy(t),this.currentTransform.copy(e),this.setBlendMode(this._blendStack.pop()),pool$1.push(t),pool$1.push(e)}0!==this._scissorStack.length?this.currentScissor.set(this._scissorStack.pop()):(this.gl.disable(this.gl.SCISSOR_TEST),this.currentScissor[0]=0,this.currentScissor[1]=0,this.currentScissor[2]=this.backBufferCanvas.width,this.currentScissor[3]=this.backBufferCanvas.height)}},{key:"save",value:function(){this._colorStack.push(this.currentColor.clone()),this._matrixStack.push(this.currentTransform.clone()),this.gl.isEnabled(this.gl.SCISSOR_TEST)&&this._scissorStack.push(this.currentScissor.slice()),this._blendStack.push(this.getBlendMode())}},{key:"rotate",value:function(t){this.currentTransform.rotate(t)}},{key:"scale",value:function(t,e){this.currentTransform.scale(t,e)}},{key:"setAntiAlias",value:function(t,e){_get(_getPrototypeOf(n.prototype),"setAntiAlias",this).call(this,t,e)}},{key:"setGlobalAlpha",value:function(t){this.currentColor.alpha=t}},{key:"getGlobalAlpha",value:function(){return this.currentColor.alpha}},{key:"setColor",value:function(t){var e=this.currentColor.alpha;this.currentColor.copy(t),this.currentColor.alpha*=e}},{key:"setLineWidth",value:function(t){this.getScreenContext().lineWidth(t)}},{key:"strokeArc",value:function(t,e,n,r,i){var o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],a=arguments.length>6&&void 0!==arguments[6]&&arguments[6];this.getGlobalAlpha()<1/255||(this.path2D.beginPath(),this.path2D.arc(t,e,n,r,i,o),!1===a?this.currentCompositor.drawVertices(this.gl.LINE_STRIP,this.path2D.points):(this.path2D.closePath(),this.currentCompositor.drawVertices(this.gl.TRIANGLES,this.path2D.triangulatePath())))}},{key:"fillArc",value:function(t,e,n,r,i){var o=arguments.length>5&&void 0!==arguments[5]&&arguments[5];this.strokeArc(t,e,n,r,i,o,!0)}},{key:"strokeEllipse",value:function(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.getGlobalAlpha()<1/255||(this.path2D.beginPath(),this.path2D.ellipse(t,e,n,r,0,0,360),this.path2D.closePath(),!1===i?this.currentCompositor.drawVertices(this.gl.LINE_LOOP,this.path2D.points):this.currentCompositor.drawVertices(this.gl.TRIANGLES,this.path2D.triangulatePath()))}},{key:"fillEllipse",value:function(t,e,n,r){this.strokeEllipse(t,e,n,r,!1)}},{key:"strokeLine",value:function(t,e,n,r){this.getGlobalAlpha()<1/255||(this.path2D.beginPath(),this.path2D.moveTo(t,e),this.path2D.lineTo(n,r),this.currentCompositor.drawVertices(this.gl.LINE_STRIP,this.path2D.points))}},{key:"fillLine",value:function(t,e,n,r){this.strokeLine(t,e,n,r)}},{key:"strokePolygon",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!(this.getGlobalAlpha()<1/255)){var n;this.translate(t.pos.x,t.pos.y),this.path2D.beginPath(),this.path2D.moveTo(t.points[0].x,t.points[0].y);for(var r=1;r<t.points.length;r++)n=t.points[r],this.path2D.lineTo(n.x,n.y);this.path2D.lineTo(t.points[0].x,t.points[0].y),this.path2D.closePath(),!1===e?this.currentCompositor.drawVertices(this.gl.LINE_LOOP,this.path2D.points):this.currentCompositor.drawVertices(this.gl.TRIANGLES,this.path2D.triangulatePath()),this.translate(-t.pos.x,-t.pos.y)}}},{key:"fillPolygon",value:function(t){this.strokePolygon(t,!0)}},{key:"strokeRect",value:function(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.getGlobalAlpha()<1/255||(this.path2D.beginPath(),this.path2D.rect(t,e,n,r),!1===i?this.currentCompositor.drawVertices(this.gl.LINE_LOOP,this.path2D.points):this.currentCompositor.drawVertices(this.gl.TRIANGLES,this.path2D.triangulatePath()))}},{key:"fillRect",value:function(t,e,n,r){this.strokeRect(t,e,n,r,!0)}},{key:"strokeRoundRect",value:function(t,e,n,r,i){var o=arguments.length>5&&void 0!==arguments[5]&&arguments[5];this.getGlobalAlpha()<1/255||(this.path2D.beginPath(),this.path2D.roundRect(t,e,n,r,i),!1===o?this.currentCompositor.drawVertices(this.gl.LINE_LOOP,this.path2D.points):(this.path2D.closePath(),this.currentCompositor.drawVertices(this.gl.TRIANGLES,this.path2D.triangulatePath())))}},{key:"fillRoundRect",value:function(t,e,n,r,i){this.strokeRoundRect(t,e,n,r,i,!0)}},{key:"setTransform",value:function(t){this.resetTransform(),this.transform(t)}},{key:"transform",value:function(t){var e=this.currentTransform;if(e.multiply(t),!1===this.settings.subPixel){var n=e.toArray();n[6]|=0,n[7]|=0}}},{key:"translate",value:function(t,e){var n=this.currentTransform;if(n.translate(t,e),!1===this.settings.subPixel){var r=n.toArray();r[6]|=0,r[7]|=0}}},{key:"clipRect",value:function(t,e,n,r){var i=this.backBufferCanvas,o=this.gl;if(0!==t||0!==e||n!==i.width||r!==i.height){var a=this.currentScissor;if(o.isEnabled(o.SCISSOR_TEST)&&a[0]===t&&a[1]===e&&a[2]===n&&a[3]===r)return;this.flush(),o.enable(this.gl.SCISSOR_TEST),o.scissor(t+this.currentTransform.tx,i.height-r-e-this.currentTransform.ty,n,r),a[0]=t,a[1]=e,a[2]=n,a[3]=r}else o.disable(o.SCISSOR_TEST)}},{key:"setMask",value:function(t){var e=this.gl;this.flush(),e.enable(e.STENCIL_TEST),e.clear(e.STENCIL_BUFFER_BIT),e.colorMask(!1,!1,!1,!1),e.stencilFunc(e.NOTEQUAL,1,1),e.stencilOp(e.REPLACE,e.REPLACE,e.REPLACE),this.fill(t),this.flush(),e.colorMask(!0,!0,!0,!0),e.stencilFunc(e.EQUAL,1,1),e.stencilOp(e.KEEP,e.KEEP,e.KEEP)}},{key:"clearMask",value:function(){this.flush(),this.gl.disable(this.gl.STENCIL_TEST)}}]),n}(Renderer),designRatio=1,designWidth=0,designHeight=0,settings={parent:void 0,renderer:2,doubleBuffering:!1,autoScale:!1,scale:1,scaleMethod:"fit",transparent:!1,blendMode:"normal",antiAlias:!1,failIfMajorPerformanceCaveat:!0,subPixel:!1,preferWebGL1:!1,powerPreference:"default",verbose:!1,consoleHeader:!0};function autoDetectRenderer(t){try{if(device$1.isWebGLSupported(t))return new WebGLRenderer(t)}catch(t){console.log("Error creating WebGL renderer :"+t.message)}return new CanvasRenderer(t)}function onresize(){var t=renderer.settings,e=1,n=1;if(t.autoScale){var r=1/0,i=1/0;if(globalThis.getComputedStyle){var o=globalThis.getComputedStyle(renderer.getScreenCanvas(),null);r=parseInt(o.maxWidth,10)||1/0,i=parseInt(o.maxHeight,10)||1/0}var a=device$1.getParentBounds(getParent()),s=Math.min(r,a.width),l=Math.min(i,a.height),u=s/l;if("fill-min"===t.scaleMethod&&u>designRatio||"fill-max"===t.scaleMethod&&u<designRatio||"flex-width"===t.scaleMethod){var c=Math.min(r,designHeight*u);e=n=s/c,renderer.resize(Math.floor(c),designHeight)}else if("fill-min"===t.scaleMethod&&u<designRatio||"fill-max"===t.scaleMethod&&u>designRatio||"flex-height"===t.scaleMethod){var h=Math.min(i,designWidth*(l/s));e=n=l/h,renderer.resize(designWidth,Math.floor(h))}else"flex"===t.scaleMethod?renderer.resize(Math.floor(s),Math.floor(l)):"stretch"===t.scaleMethod?(e=s/designWidth,n=l/designHeight):e=n=u<designRatio?s/designWidth:l/designHeight;scale(e,n)}}var CANVAS=0,WEBGL=1,AUTO=2,parent=null,scaleRatio=new Vector2d(1,1),renderer=null;function init(t,e,n){if(!initialized)throw new Error("me.video.init() called before engine initialization.");(settings=Object.assign(settings,n||{})).width=t,settings.height=e,settings.doubleBuffering=!!settings.doubleBuffering,settings.transparent=!!settings.transparent,settings.antiAlias=!!settings.antiAlias,settings.failIfMajorPerformanceCaveat=!!settings.failIfMajorPerformanceCaveat,settings.subPixel=!!settings.subPixel,settings.verbose=!!settings.verbose,-1!==settings.scaleMethod.search(/^(fill-(min|max)|fit|flex(-(width|height))?|stretch)$/)?settings.autoScale="auto"===settings.scale||!0:(settings.scaleMethod="fit",settings.autoScale="auto"===settings.scale||!1),!1!==settings.consoleHeader&&console.log("melonJS 2 (v"+version+") | http://melonjs.org");var r=utils.getUriFragment();!0!==r.webgl&&!0!==r.webgl1&&!0!==r.webgl2||(settings.renderer=WEBGL,!0===r.webgl1&&(settings.preferWebGL1=!0)),settings.scale=settings.autoScale?1:+settings.scale||1,scaleRatio.set(settings.scale,settings.scale),(settings.autoScale||1!==settings.scale)&&(settings.doubleBuffering=!0),designRatio=t/e,designWidth=t,designHeight=e,settings.zoomX=t*scaleRatio.x,settings.zoomY=e*scaleRatio.y,globalThis.addEventListener("resize",utils.function.throttle((function(t){emit(WINDOW_ONRESIZE,t)}),100),!1),globalThis.addEventListener("orientationchange",(function(t){emit(WINDOW_ONORIENTATION_CHANGE,t)}),!1),globalThis.addEventListener("onmozorientationchange",(function(t){emit(WINDOW_ONORIENTATION_CHANGE,t)}),!1),!0===device$1.ScreenOrientation&&(globalThis.screen.orientation.onchange=function(t){emit(WINDOW_ONORIENTATION_CHANGE,t)}),globalThis.addEventListener("scroll",utils.function.throttle((function(t){emit(WINDOW_ONSCROLL,t)}),100),!1),on(WINDOW_ONRESIZE,onresize,this),on(WINDOW_ONORIENTATION_CHANGE,onresize,this);try{switch(settings.renderer){case AUTO:case WEBGL:renderer=autoDetectRenderer(settings);break;default:renderer=new CanvasRenderer(settings)}}catch(t){return console(t.message),!1}if((parent=device$1.getElement(void 0!==settings.parent?settings.parent:document.body)).appendChild(renderer.getScreenCanvas()),onresize(),"MutationObserver"in globalThis&&new MutationObserver(onresize.bind(this)).observe(parent,{attributes:!1,childList:!0,subtree:!0}),!1!==settings.consoleHeader){var i=renderer instanceof CanvasRenderer?"CANVAS":"WebGL"+renderer.WebGLVersion,o=device$1.hasWebAudio?"Web Audio":"HTML5 Audio",a="string"==typeof renderer.GPURenderer?" ("+renderer.GPURenderer+")":"";console.log(i+" renderer"+a+" | "+o+" | pixel ratio "+device$1.devicePixelRatio+" | "+(device$1.nodeJS?"node.js":device$1.isMobile?"mobile":"desktop")+" | "+device$1.getScreenOrientation()+" | "+device$1.language),console.log("resolution: requested "+t+"x"+e+", got "+renderer.getWidth()+"x"+renderer.getHeight())}return emit(VIDEO_INIT),!0}function createCanvas(t,e){var n,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(0===t||0===e)throw new Error("width or height was zero, Canvas could not be initialized !");return!0===device$1.OffscreenCanvas&&!0===r?void 0===(n=new OffscreenCanvas(0,0)).style&&(n.style={}):n=document.createElement("canvas"),n.width=t,n.height=e,n}function getParent(){return parent}function scale(t,e){var n=renderer.getScreenCanvas(),r=renderer.getScreenContext(),i=renderer.settings,o=device$1.devicePixelRatio,a=i.zoomX=n.width*t*o,s=i.zoomY=n.height*e*o;scaleRatio.set(t*o,e*o),n.style.width=a/o+"px",n.style.height=s/o+"px",renderer.setAntiAlias(r,i.antiAlias),renderer.setBlendMode(i.blendMode,r),repaint()}var video=Object.freeze({__proto__:null,CANVAS,WEBGL,AUTO,get parent(){return parent},scaleRatio,get renderer(){return renderer},init,createCanvas,getParent,scale}),GUID_base="",GUID_index=0,utils={agent:agentUtils,array:arrayUtils,file:fileUtils,string:stringUtils,function:fnUtils,getPixels:function(t){if(t instanceof HTMLImageElement){var e=CanvasRenderer.getContext2d(createCanvas(t.width,t.height));return e.drawImage(t,0,0),e.getImageData(0,0,t.width,t.height)}return t.getContext("2d").getImageData(0,0,t.width,t.height)},checkVersion:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:version,n=t.split("."),r=e.split("."),i=Math.min(n.length,r.length),o=0,a=0;a<i&&!(o=+n[a]-+r[a]);a++);return o||n.length-r.length},getUriFragment:function(t){var e={};if(void 0===t){if(void 0===globalThis.document)return e;var n=globalThis.document.location;if(!n||!n.hash)return e;t=n.hash}else{var r=t.indexOf("#");if(-1===r)return e;t=t.slice(r,t.length)}return t.slice(1).split("&").filter((function(t){return""!==t})).forEach((function(t){var n=t.split("="),r=n.shift(),i=n.join("=");e[r]=i||!0})),e},resetGUID:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;GUID_base=toHex$1(t.toString().toUpperCase()),GUID_index=e},createGUID:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return GUID_index+=t,GUID_base+"-"+(t||GUID_index)}},framecount=0,framedelta=0,last=0,now=0,delta=0,step=0,minstep=0,timers=[],timerId=0;function update(t){last=now,(delta=(now=t)-last)<0&&(delta=0),timer.tick=delta>minstep&&timer.interpolation?delta/step:1,updateTimers()}function clearTimer(t){for(var e=0,n=timers.length;e<n;e++)if(timers[e].timerId===t){timers.splice(e,1);break}}function updateTimers(){for(var t=0,e=timers.length;t<e;t++){var n=timers[t];n.pauseable&&state.isPaused()||(n.elapsed+=delta),n.elapsed>=n.delay&&(n.fn.apply(null,n.args),!0===n.repeat?n.elapsed-=n.delay:timer.clearTimeout(n.timerId))}}on(BOOT,(function(){timer.reset(),now=last=0,on(GAME_BEFORE_UPDATE,update)}));var timer={tick:1,fps:0,maxfps:60,interpolation:!1,reset:function(){last=now=globalThis.performance.now(),delta=0,framedelta=0,framecount=0,step=Math.ceil(1e3/this.maxfps),minstep=1e3/this.maxfps*1.25},setTimeout:function(t,e,n){for(var r=arguments.length,i=new Array(r>3?r-3:0),o=3;o<r;o++)i[o-3]=arguments[o];return timers.push({fn:t,delay:e,elapsed:0,repeat:!1,timerId:++timerId,pauseable:!0===n||!0,args:i}),timerId},setInterval:function(t,e,n){for(var r=arguments.length,i=new Array(r>3?r-3:0),o=3;o<r;o++)i[o-3]=arguments[o];return timers.push({fn:t,delay:e,elapsed:0,repeat:!0,timerId:++timerId,pauseable:!0===n||!0,args:i}),timerId},clearTimeout:function(t){utils.function.defer(clearTimer,this,t)},clearInterval:function(t){utils.function.defer(clearTimer,this,t)},getTime:function(){return now},getDelta:function(){return delta},countFPS:function(){framecount++,framedelta+=delta,framecount%10==0&&(this.fps=_clamp(Math.round(1e3*framecount/framedelta),0,this.maxfps),framedelta=0,framecount=0)}},timer$1=timer,lastTime=0,vendors=["ms","moz","webkit","o"],x,requestAnimationFrame=globalThis.requestAnimationFrame,cancelAnimationFrame=globalThis.cancelAnimationFrame;for(x=0;x<vendors.length&&!requestAnimationFrame;++x)requestAnimationFrame=globalThis[vendors[x]+"RequestAnimationFrame"];for(x=0;x<vendors.length&&!cancelAnimationFrame;++x)cancelAnimationFrame=globalThis[vendors[x]+"CancelAnimationFrame"]||globalThis[vendors[x]+"CancelRequestAnimationFrame"];requestAnimationFrame&&cancelAnimationFrame||(requestAnimationFrame=function(t){var e=globalThis.performance.now(),n=Math.max(0,1e3/timer$1.maxfps-(e-lastTime)),r=globalThis.setTimeout((function(){t(e+n)}),n);return lastTime=e+n,r},cancelAnimationFrame=function(t){globalThis.clearTimeout(t)},globalThis.requestAnimationFrame=requestAnimationFrame,globalThis.cancelAnimationFrame=cancelAnimationFrame),function(){function t(t,e,n,r,i){if([t,e,n,r].every((function(t){return Number.isFinite(t)}))){var o,a,s,l;if(4===(h=i,f=_typeof(h),i="undefined"===f||null===h?[0]:"function"===f?[NaN]:"object"===f?"function"==typeof h[Symbol.iterator]?_toConsumableArray(h).map((function(t){var e=_typeof(t);return"undefined"===e||null===t?0:"function"===e?NaN:"object"===e?d(t):p(t)})):[d(h)]:[p(h)]).length)o=y(i[0]),a=y(i[1]),s=y(i[2]),l=y(i[3]);else if(3===i.length)o=y(i[0]),a=y(i[1]),l=y(i[1]),s=y(i[2]);else if(2===i.length)o=y(i[0]),s=y(i[0]),a=y(i[1]),l=y(i[1]);else{if(1!==i.length)throw new Error(i.length+" is not a valid size for radii sequence.");o=y(i[0]),a=y(i[0]),s=y(i[0]),l=y(i[0])}var u=[o,a,s,l],c=u.find((function(t){var e=t.x,n=t.y;return e<0||n<0}));if(!u.some((function(t){var e=t.x,n=t.y;return!Number.isFinite(e)||!Number.isFinite(n)}))){if(c)throw new Error("Radius value "+c+" is negative.");!function(t){var e=_slicedToArray(t,4),i=e[0],o=e[1],a=e[2],s=e[3],l=[Math.abs(n)/(i.x+o.x),Math.abs(r)/(o.y+a.y),Math.abs(n)/(a.x+s.x),Math.abs(r)/(i.y+s.y)],u=Math.min.apply(Math,l);u<=1&&t.forEach((function(t){t.x*=u,t.y*=u}))}(u),n<0&&r<0?(this.moveTo(t-o.x,e),this.ellipse(t+n+a.x,e-a.y,a.x,a.y,0,1.5*-Math.PI,-Math.PI),this.ellipse(t+n+s.x,e+r+s.y,s.x,s.y,0,-Math.PI,-Math.PI/2),this.ellipse(t-l.x,e+r+l.y,l.x,l.y,0,-Math.PI/2,0),this.ellipse(t-o.x,e-o.y,o.x,o.y,0,0,-Math.PI/2)):n<0?(this.moveTo(t-o.x,e),this.ellipse(t+n+a.x,e+a.y,a.x,a.y,0,-Math.PI/2,-Math.PI,1),this.ellipse(t+n+s.x,e+r-s.y,s.x,s.y,0,-Math.PI,1.5*-Math.PI,1),this.ellipse(t-l.x,e+r-l.y,l.x,l.y,0,Math.PI/2,0,1),this.ellipse(t-o.x,e+o.y,o.x,o.y,0,0,-Math.PI/2,1)):r<0?(this.moveTo(t+o.x,e),this.ellipse(t+n-a.x,e-a.y,a.x,a.y,0,Math.PI/2,0,1),this.ellipse(t+n-s.x,e+r+s.y,s.x,s.y,0,0,-Math.PI/2,1),this.ellipse(t+l.x,e+r+l.y,l.x,l.y,0,-Math.PI/2,-Math.PI,1),this.ellipse(t+o.x,e-o.y,o.x,o.y,0,-Math.PI,1.5*-Math.PI,1)):(this.moveTo(t+o.x,e),this.ellipse(t+n-a.x,e+a.y,a.x,a.y,0,-Math.PI/2,0),this.ellipse(t+n-s.x,e+r-s.y,s.x,s.y,0,0,Math.PI/2),this.ellipse(t+l.x,e+r-l.y,l.x,l.y,0,Math.PI/2,Math.PI),this.ellipse(t+o.x,e+o.y,o.x,o.y,0,Math.PI,1.5*Math.PI)),this.closePath(),this.moveTo(t,e)}}var h,f;function d(t){return{x:t.x,y:t.y,z:t.z,w:t.w}}function p(t){return+t}function y(t){var e=p(t);return Number.isFinite(e)?{x:e,y:e}:Object(t)===t?{x:p(t.x||0),y:p(t.y||0)}:{x:NaN,y:NaN}}}void 0===Path2D.prototype.roundRect&&(Path2D.prototype.roundRect=t),globalThis.CanvasRenderingContext2D&&void 0===globalThis.CanvasRenderingContext2D.prototype.roundRect&&(globalThis.CanvasRenderingContext2D.prototype.roundRect=t),globalThis.OffscreenCanvasRenderingContext2D&&void 0===globalThis.OffscreenCanvasRenderingContext2D.prototype.roundRect&&(globalThis.OffscreenCanvasRenderingContext2D.prototype.roundRect=t)}();var plugins={},BasePlugin=_createClass((function t(){_classCallCheck(this,t),this.version="10.9.0"})),plugin={Base:BasePlugin,patch:function(t,e,n){if(void 0!==t.prototype&&(t=t.prototype),"function"!=typeof t[e])throw new Error(e+" is not an existing function");var r=t[e];Object.defineProperty(t,e,{configurable:!0,value:function(t,e){return function(){this._patched=r;var t=e.apply(this,arguments);return this._patched=null,t}}(0,n)})},register:function(t,e){if(plugins[e])throw new Error("plugin "+e+" already registered");var n=[];arguments.length>2&&(n=Array.prototype.slice.call(arguments,1)),n[0]=t;var r=new(t.bind.apply(t,n));if(void 0===r||!(r instanceof plugin.Base))throw new Error("Plugin should extend the me.plugin.Base Class !");if(utils.checkVersion(r.version)>0)throw new Error("Plugin version mismatch, expected: "+r.version+", got: "+version);plugins[e]=r}},Easing={Linear:{None:function(t){return t}},Quadratic:{In:function(t){return t*t},Out:function(t){return t*(2-t)},InOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)}},Cubic:{In:function(t){return t*t*t},Out:function(t){return--t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)}},Quartic:{In:function(t){return t*t*t*t},Out:function(t){return 1- --t*t*t*t},InOut:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)}},Quintic:{In:function(t){return t*t*t*t*t},Out:function(t){return--t*t*t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)}},Sinusoidal:{In:function(t){return 1-Math.cos(t*Math.PI/2)},Out:function(t){return Math.sin(t*Math.PI/2)},InOut:function(t){return.5*(1-Math.cos(Math.PI*t))}},Exponential:{In:function(t){return 0===t?0:Math.pow(1024,t-1)},Out:function(t){return 1===t?1:1-Math.pow(2,-10*t)},InOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(2-Math.pow(2,-10*(t-1)))}},Circular:{In:function(t){return 1-Math.sqrt(1-t*t)},Out:function(t){return Math.sqrt(1- --t*t)},InOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)}},Elastic:{In:function(t){return 0===t?0:1===t?1:-Math.pow(2,10*(t-1))*Math.sin(5*(t-1.1)*Math.PI)},Out:function(t){return 0===t?0:1===t?1:Math.pow(2,-10*t)*Math.sin(5*(t-.1)*Math.PI)+1},InOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?-.5*Math.pow(2,10*(t-1))*Math.sin(5*(t-1.1)*Math.PI):.5*Math.pow(2,-10*(t-1))*Math.sin(5*(t-1.1)*Math.PI)+1}},Back:{In:function(t){var e=1.70158;return t*t*((e+1)*t-e)},Out:function(t){var e=1.70158;return--t*t*((e+1)*t+e)+1},InOut:function(t){var e=2.5949095;return(t*=2)<1?t*t*((e+1)*t-e)*.5:.5*((t-=2)*t*((e+1)*t+e)+2)}},Bounce:{In:function(t){return 1-Easing.Bounce.Out(1-t)},Out:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},InOut:function(t){return t<.5?.5*Easing.Bounce.In(2*t):.5*Easing.Bounce.Out(2*t-1)+.5}}},Interpolation={Linear:function(t,e){var n=t.length-1,r=n*e,i=Math.floor(r),o=Interpolation.Utils.Linear;return e<0?o(t[0],t[1],r):e>1?o(t[n],t[n-1],n-r):o(t[i],t[i+1>n?n:i+1],r-i)},Bezier:function(t,e){var n,r=0,i=t.length-1,o=Math.pow,a=Interpolation.Utils.Bernstein;for(n=0;n<=i;n++)r+=o(1-e,i-n)*o(e,n)*t[n]*a(i,n);return r},CatmullRom:function(t,e){var n=t.length-1,r=n*e,i=Math.floor(r),o=Interpolation.Utils.CatmullRom;return t[0]===t[n]?(e<0&&(i=Math.floor(r=n*(1+e))),o(t[(i-1+n)%n],t[i],t[(i+1)%n],t[(i+2)%n],r-i)):e<0?t[0]-(o(t[0],t[0],t[1],t[1],-r)-t[0]):e>1?t[n]-(o(t[n],t[n],t[n-1],t[n-1],r-n)-t[n]):o(t[i?i-1:0],t[i],t[n<i+1?n:i+1],t[n<i+2?n:i+2],r-i)},Utils:{Linear:function(t,e,n){return(e-t)*n+t},Bernstein:function(t,e){var n=Interpolation.Utils.Factorial;return n(t)/n(e)/n(t-e)},Factorial:function(){var t=[1];return function(e){var n,r=1;if(t[e])return t[e];for(n=e;n>1;n--)r*=n;return t[e]=r,r}}(),CatmullRom:function(t,e,n,r,i){var o=.5*(n-t),a=.5*(r-e),s=i*i;return(2*e-2*n+o+a)*(i*s)+(-3*e+3*n-2*o-a)*s+o*i+e}}},Tween=function(){function t(e){_classCallCheck(this,t),this.setProperties(e)}return _createClass(t,[{key:"onResetEvent",value:function(t){this.setProperties(t)}},{key:"setProperties",value:function(t){for(var e in this._object=t,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._repeat=0,this._yoyo=!1,this._reversed=!1,this._delayTime=0,this._startTime=null,this._easingFunction=Easing.Linear.None,this._interpolationFunction=Interpolation.Linear,this._chainedTweens=[],this._onStartCallback=null,this._onStartCallbackFired=!1,this._onUpdateCallback=null,this._onCompleteCallback=null,this._tweenTimeTracker=lastUpdate,this.isPersistent=!1,this.updateWhenPaused=!1,this.isRenderable=!1,t)"object"!==_typeof(t)&&(this._valuesStart[e]=parseFloat(t[e]))}},{key:"_resumeCallback",value:function(t){this._startTime&&(this._startTime+=t)}},{key:"onActivateEvent",value:function(){on(STATE_RESUME,this._resumeCallback,this)}},{key:"onDeactivateEvent",value:function(){off(STATE_RESUME,this._resumeCallback)}},{key:"to",value:function(t,e){return this._valuesEnd=t,void 0!==e&&("number"==typeof e?this._duration=e:"object"===_typeof(e)&&(e.duration&&(this._duration=e.duration),e.yoyo&&this.yoyo(e.yoyo),e.easing&&this.easing(e.easing),e.repeat&&this.repeat(e.repeat),e.delay&&this.delay(e.delay),e.interpolation&&this.interpolation(e.interpolation),e.autoStart&&this.start())),this}},{key:"start",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:timer$1.getTime();for(var e in this._onStartCallbackFired=!1,world.addChild(this),this._startTime=t+this._delayTime,this._valuesEnd){if(this._valuesEnd[e]instanceof Array){if(0===this._valuesEnd[e].length)continue;this._valuesEnd[e]=[this._object[e]].concat(this._valuesEnd[e])}this._valuesStart[e]=this._object[e],this._valuesStart[e]instanceof Array==0&&(this._valuesStart[e]*=1),this._valuesStartRepeat[e]=this._valuesStart[e]||0}return this}},{key:"stop",value:function(){return world.removeChildNow(this),this}},{key:"delay",value:function(t){return this._delayTime=t,this}},{key:"repeat",value:function(t){return this._repeat=t,this}},{key:"yoyo",value:function(t){return this._yoyo=t,this}},{key:"easing",value:function(t){if("function"!=typeof t)throw new Error("invalid easing function for me.Tween.easing()");return this._easingFunction=t,this}},{key:"interpolation",value:function(t){return this._interpolationFunction=t,this}},{key:"chain",value:function(){return this._chainedTweens=arguments,this}},{key:"onStart",value:function(t){return this._onStartCallback=t,this}},{key:"onUpdate",value:function(t){return this._onUpdateCallback=t,this}},{key:"onComplete",value:function(t){return this._onCompleteCallback=t,this}},{key:"update",value:function(t){this._tweenTimeTracker=lastUpdate>this._tweenTimeTracker?lastUpdate:this._tweenTimeTracker+t;var e,n=this._tweenTimeTracker;if(n<this._startTime)return!0;!1===this._onStartCallbackFired&&(null!==this._onStartCallback&&this._onStartCallback.call(this._object),this._onStartCallbackFired=!0);var r=(n-this._startTime)/this._duration;r=r>1?1:r;var i=this._easingFunction(r);for(e in this._valuesEnd){var o=this._valuesStart[e]||0,a=this._valuesEnd[e];a instanceof Array?this._object[e]=this._interpolationFunction(a,i):("string"==typeof a&&(a=o+parseFloat(a)),"number"==typeof a&&(this._object[e]=o+(a-o)*i))}if(null!==this._onUpdateCallback&&this._onUpdateCallback.call(this._object,i),1===r){if(this._repeat>0){for(e in isFinite(this._repeat)&&this._repeat--,this._valuesStartRepeat){if("string"==typeof this._valuesEnd[e]&&(this._valuesStartRepeat[e]=this._valuesStartRepeat[e]+parseFloat(this._valuesEnd[e])),this._yoyo){var s=this._valuesStartRepeat[e];this._valuesStartRepeat[e]=this._valuesEnd[e],this._valuesEnd[e]=s}this._valuesStart[e]=this._valuesStartRepeat[e]}return this._yoyo&&(this._reversed=!this._reversed),this._startTime=n+this._delayTime,!0}world.removeChildNow(this),null!==this._onCompleteCallback&&this._onCompleteCallback.call(this._object);for(var l=0,u=this._chainedTweens.length;l<u;l++)this._chainedTweens[l].start(n);return!1}return!0}}],[{key:"Easing",get:function(){return Easing}},{key:"Interpolation",get:function(){return Interpolation}}]),t}();function setContextStyle(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];t.font=e.font,t.fillStyle=e.fillStyle.toRGBA(),!0===n&&(t.strokeStyle=e.strokeStyle.toRGBA(),t.lineWidth=e.lineWidth),t.textAlign=e.textAlign,t.textBaseline=e.textBaseline}var TextMetrics=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r;return _classCallCheck(this,n),(r=e.call(this)).ancestor=t,r.setMinMax(0,0,0,0),r}return _createClass(n,[{key:"lineHeight",value:function(){return this.ancestor instanceof Text?this.ancestor.fontSize*this.ancestor.lineHeight:this.ancestor.fontData.capHeight*this.ancestor.lineHeight*this.ancestor.fontScale.y}},{key:"lineWidth",value:function(t,e){if(this.ancestor instanceof Text)return e.measureText(t).width;for(var n=t.split(""),r=0,i=null,o=0;o<n.length;o++){var a=n[o].charCodeAt(0),s=this.ancestor.fontData.glyphs[a],l=i&&i.kerning?i.getKerning(a):0;r+=(s.xadvance+l)*this.ancestor.fontScale.x,i=s}return r}},{key:"measureText",value:function(t,e){var n;n=Array.isArray(t)?t:(""+t).split("\n"),void 0!==e&&(e.save(),setContextStyle(e,this.ancestor)),this.width=this.height=0;for(var r=0;r<n.length;r++)this.width=Math.max(this.lineWidth(trimRight(n[r]),e),this.width),this.height+=this.lineHeight();return this.width=Math.ceil(this.width),this.height=Math.ceil(this.height),this.x=Math.floor("right"===this.ancestor.textAlign?this.ancestor.pos.x-this.width:"center"===this.ancestor.textAlign?this.ancestor.pos.x-this.width/2:this.ancestor.pos.x),this.y=Math.floor(0===this.ancestor.textBaseline.search(/^(top|hanging)$/)?this.ancestor.pos.y:"middle"===this.ancestor.textBaseline?this.ancestor.pos.y-this.lineHeight()/2:this.ancestor.pos.y-this.lineHeight()),void 0!==e&&e.restore(),this}},{key:"wordWrap",value:function(t,e,n){var r,i="",o=[];Array.isArray(t)&&(t=t.join(" ")),r=t.replace(/[\r\n]+/g," ").split(" "),void 0!==n&&(n.save(),setContextStyle(n,this.ancestor));for(var a=0;a<r.length;a++){var s=r[a];this.lineWidth(i+s+" ",n)<e?i+=s+" ":(o.push(i+"\n"),i=s+" ")}return o.push(i),void 0!==n&&n.restore(),o}}]),n}(Bounds$1),runits=["ex","em","pt","px"],toPX=[12,24,.75,1],getContext2d=function(t,e){return!0===e.offScreenCanvas?e.context:t.getFontContext()},Text=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i){var o;return _classCallCheck(this,n),(o=e.call(this,t,r,i.width||0,i.height||0)).onResetEvent(t,r,i),o}return _createClass(n,[{key:"onResetEvent",value:function(t,e,n){void 0!==n.fillStyle?n.fillStyle instanceof Color?this.fillStyle=n.fillStyle:this.fillStyle=pool$1.pull("Color").parseCSS(n.fillStyle):this.fillStyle=pool$1.pull("Color",0,0,0),void 0!==n.strokeStyle?n.strokeStyle instanceof Color?this.strokeStyle=n.strokeStyle:this.strokeStyle=pool$1.pull("Color").parseCSS(n.strokeStyle):this.strokeStyle=pool$1.pull("Color",0,0,0),this.lineWidth=n.lineWidth||1,this.textAlign=n.textAlign||"left",this.textBaseline=n.textBaseline||"top",this.lineHeight=n.lineHeight||1,this.offScreenCanvas=!1,this.wordWrapWidth=n.wordWrapWidth||-1,this._text=[],this.fontSize=10,void 0!==n.anchorPoint?this.anchorPoint.setV(n.anchorPoint):this.anchorPoint.set(0,0),void 0!==n.floating&&(this.floating=!!n.floating),this.setFont(n.font,n.size),!0===n.bold&&this.bold(),!0===n.italic&&this.italic(),!0===n.offScreenCanvas&&(this.offScreenCanvas=!0,this.canvas=createCanvas(2,2,!0),this.context=this.canvas.getContext("2d")),this.metrics=new TextMetrics(this),this.setText(n.text)}},{key:"onDeactivateEvent",value:function(){!0===this.offScreenCanvas&&(renderer.currentCompositor.deleteTexture2D(renderer.currentCompositor.getTexture2D(this.glTextureUnit)),renderer.cache.delete(this.canvas),this.canvas.width=this.canvas.height=0,this.context=void 0,this.canvas=void 0,this.glTextureUnit=void 0)}},{key:"bold",value:function(){return this.font="bold "+this.font,this.isDirty=!0,this}},{key:"italic",value:function(){return this.font="italic "+this.font,this.isDirty=!0,this}},{key:"setFont",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n=t.split(",").map((function(t){return t=t.trim(),/(^".*"$)|(^'.*'$)/.test(t)?t:'"'+t+'"'}));if("number"==typeof e)this.fontSize=e,e+="px";else{var r=e.match(/([-+]?[\d.]*)(.*)/);this.fontSize=parseFloat(r[1]),r[2]?this.fontSize*=toPX[runits.indexOf(r[2])]:e+="px"}return this.height=this.fontSize,this.font=e+" "+n.join(","),this.isDirty=!0,this}},{key:"setText",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=this.getBounds();if(this._text.toString()!==t.toString()&&(Array.isArray(t)?this._text=t:this._text=(""+t).split("\n")),this._text.length>0&&this.wordWrapWidth>0&&(this._text=this.metrics.wordWrap(this._text,this.wordWrapWidth,getContext2d(renderer,this))),e.addBounds(this.metrics.measureText(this._text,getContext2d(renderer,this)),!0),!0===this.offScreenCanvas){var n=Math.ceil(this.metrics.width),r=Math.ceil(this.metrics.height);renderer instanceof WebGLRenderer&&(this.glTextureUnit=renderer.cache.getUnit(renderer.cache.get(this.canvas)),renderer.currentCompositor.unbindTexture2D(null,this.glTextureUnit),1===renderer.WebGLVersion&&(n=nextPowerOfTwo(this.metrics.width),r=nextPowerOfTwo(this.metrics.height))),this.canvas.width<n||this.canvas.height<r?(this.canvas.width=n,this.canvas.height=r):this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this._drawFont(this.context,this._text,this.pos.x-this.metrics.x,this.pos.y-this.metrics.y,!1)}return this.isDirty=!0,this}},{key:"measureText",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:renderer,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._text;return this.metrics.measureText(e,getContext2d(t,this))}},{key:"draw",value:function(t,e,n,r,i){void 0===this.ancestor?(this.pos.x===n&&this.pos.y===r||(this.pos.x=n,this.pos.y=r,this.isDirty=!0),this.setText(e),n=this.metrics.x,r=this.metrics.y,t.save(),t.setGlobalAlpha(t.globalAlpha()*this.getOpacity())):(n=this.pos.x,r=this.pos.y),!1===t.settings.subPixel&&(n=~~n,r=~~r),!0===this.offScreenCanvas?t.drawImage(this.canvas,n,r):t.drawFont(this._drawFont(t.getFontContext(),this._text,n,r,i)),void 0===this.ancestor&&t.restore()}},{key:"drawStroke",value:function(t,e,n,r){this.draw(t,e,n,r,!0)}},{key:"_drawFont",value:function(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];setContextStyle(t,this,i);for(var o=0;o<e.length;o++){var a=trimRight(e[o]);t[i?"strokeText":"fillText"](a,n,r),r+=this.metrics.lineHeight()}return this.metrics}},{key:"destroy",value:function(){pool$1.push(this.fillStyle),pool$1.push(this.strokeStyle),this.fillStyle=this.strokeStyle=void 0,this.metrics=void 0,this._text.length=0,_get(_getPrototypeOf(n.prototype),"destroy",this).call(this)}}]),n}(Renderable),BitmapText=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i){var o;return _classCallCheck(this,n),(o=e.call(this,t,r,i.width||0,i.height||0)).textAlign=i.textAlign||"left",o.textBaseline=i.textBaseline||"top",o.lineHeight=i.lineHeight||1,o.wordWrapWidth=i.wordWrapWidth||-1,o._text=[],o.fontScale=pool$1.pull("Vector2d",1,1),o.fontImage="object"===_typeof(i.font)?i.font:loader.getImage(i.font),"string"!=typeof i.fontData?o.fontData=pool$1.pull("BitmapTextData",loader.getBinary(i.font)):o.fontData=pool$1.pull("BitmapTextData",i.fontData.includes("info face")?i.fontData:loader.getBinary(i.fontData)),void 0!==i.floating&&(o.floating=!!i.floating),void 0!==i.fillStyle&&(i.fillStyle instanceof Color?o.fillStyle.setColor(i.fillStyle):o.fillStyle.parseCSS(i.fillStyle)),void 0!==i.anchorPoint?o.anchorPoint.set(i.anchorPoint.x,i.anchorPoint.y):o.anchorPoint.set(0,0),o.metrics=new TextMetrics(_assertThisInitialized(o)),"number"==typeof i.size&&1!==i.size&&o.resize(i.size),o.setText(i.text),o}return _createClass(n,[{key:"set",value:function(t,e){return this.textAlign=t,e&&this.resize(e),this.isDirty=!0,this}},{key:"setText",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this._text.toString()!==t.toString()&&(Array.isArray(t)?this._text=t:this._text=(""+t).split("\n"),this.isDirty=!0),this._text.length>0&&this.wordWrapWidth>0&&(this._text=this.metrics.wordWrap(this._text,this.wordWrapWidth)),this.getBounds().addBounds(this.metrics.measureText(this._text),!0),this}},{key:"fillStyle",get:function(){return this.tint},set:function(t){this.tint=t}},{key:"resize",value:function(t){return this.fontScale.set(t,t),this.getBounds().addBounds(this.metrics.measureText(this._text),!0),this.isDirty=!0,this}},{key:"measureText",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._text;return this.metrics.measureText(t)}},{key:"draw",value:function(t,e,n,r){var i=t.globalAlpha();void 0===this.ancestor?(this.setText(e),t.setGlobalAlpha(i*this.getOpacity())):(n=this.pos.x,r=this.pos.y);for(var o=n,a=this.metrics.lineHeight(),s=0,l=0;l<this._text.length;l++){n=o;var u=trimRight(this._text[l]),c=this.metrics.lineWidth(u);switch(this.textAlign){case"right":n-=c;break;case"center":n-=.5*c}switch(this.textBaseline){case"middle":r-=.5*a;break;case"ideographic":case"alphabetic":case"bottom":r-=a}!0===this.isDirty&&void 0===this.ancestor&&(0===l&&(this.pos.y=r),s<c&&(s=c,this.pos.x=n));for(var h=null,f=0,d=u.length;f<d;f++){var p=u.charCodeAt(f),y=this.fontData.glyphs[p],v=y.width,g=y.height,m=h&&h.kerning?h.getKerning(p):0;0!==v&&0!==g&&t.drawImage(this.fontImage,y.x,y.y,v,g,n+y.xoffset,r+y.yoffset*this.fontScale.y,v*this.fontScale.x,g*this.fontScale.y),n+=(y.xadvance+m)*this.fontScale.x,h=y}r+=a}void 0===this.ancestor&&t.setGlobalAlpha(i),this.isDirty=!1}},{key:"destroy",value:function(){pool$1.push(this.fontScale),this.fontScale=void 0,pool$1.push(this.fontData),this.fontData=void 0,this._text.length=0,this.metrics=void 0,_get(_getPrototypeOf(n.prototype),"destroy",this).call(this)}}]),n}(Renderable),LOG2_PAGE_SIZE=9,PAGE_SIZE=1<<LOG2_PAGE_SIZE,Glyph=function(){function t(){_classCallCheck(this,t),this.id=0,this.x=0,this.y=0,this.width=0,this.height=0,this.u=0,this.v=0,this.u2=0,this.v2=0,this.xoffset=0,this.yoffset=0,this.xadvance=0,this.fixedWidth=!1}return _createClass(t,[{key:"getKerning",value:function(t){if(this.kerning){var e=this.kerning[t>>>LOG2_PAGE_SIZE];if(e)return e[t&PAGE_SIZE-1]||0}return 0}},{key:"setKerning",value:function(t,e){this.kerning||(this.kerning={});var n=this.kerning[t>>>LOG2_PAGE_SIZE];void 0===n&&(this.kerning[t>>>LOG2_PAGE_SIZE]={},n=this.kerning[t>>>LOG2_PAGE_SIZE]),n[t&PAGE_SIZE-1]=e}}]),t}(),capChars=["M","N","B","D","C","E","F","K","A","G","H","I","J","L","O","P","Q","R","S","T","U","V","W","X","Y","Z"];function getValueFromPair(t,e){var n=t.match(e);if(!n)throw new Error("Could not find pattern "+e+" in string: "+t);return n[0].split("=")[1]}function getFirstGlyph(t){for(var e=Object.keys(t),n=0;n<e.length;n++)if(e[n]>32)return t[e[n]];return null}function createSpaceGlyph(t){var e=" ".charCodeAt(0),n=t[e];n||((n=new Glyph).id=e,n.xadvance=getFirstGlyph(t).xadvance,t[e]=n)}var BitmapTextData=function(){function t(e){_classCallCheck(this,t),this.onResetEvent(e)}return _createClass(t,[{key:"onResetEvent",value:function(t){this.padTop=0,this.padRight=0,this.padBottom=0,this.padLeft=0,this.lineHeight=0,this.capHeight=1,this.descent=0,this.glyphs={},this.parse(t)}},{key:"parse",value:function(t){if(!t)throw new Error("File containing font data was empty, cannot load the bitmap font.");var e=t.split(/\r\n|\n/),n=t.match(/padding\=\d+,\d+,\d+,\d+/g);if(!n)throw new Error("Padding not found in first line");var r=n[0].split("=")[1].split(",");this.padTop=parseFloat(r[0]),this.padLeft=parseFloat(r[1]),this.padBottom=parseFloat(r[2]),this.padRight=parseFloat(r[3]),this.lineHeight=parseFloat(getValueFromPair(e[1],/lineHeight\=\d+/g));var i,o=parseFloat(getValueFromPair(e[1],/base\=\d+/g)),a=this.padTop+this.padBottom,s=null;for(i=4;i<e.length;i++){var l=e[i],u=l.split(/=|\s+/);if(l&&!/^kernings/.test(l))if(/^kerning\s/.test(l)){var c=parseFloat(u[2]),h=parseFloat(u[4]),f=parseFloat(u[6]);null!=(s=this.glyphs[c])&&s.setKerning(h,f)}else{s=new Glyph;var d=parseFloat(u[2]);s.id=d,s.x=parseFloat(u[4]),s.y=parseFloat(u[6]),s.width=parseFloat(u[8]),s.height=parseFloat(u[10]),s.xoffset=parseFloat(u[12]),s.yoffset=parseFloat(u[14]),s.xadvance=parseFloat(u[16]),s.width>0&&s.height>0&&(this.descent=Math.min(o+s.yoffset,this.descent)),this.glyphs[d]=s}}this.descent+=this.padBottom,createSpaceGlyph(this.glyphs);var p=null;for(i=0;i<capChars.length;i++){var y=capChars[i];if(p=this.glyphs[y.charCodeAt(0)])break}if(p)this.capHeight=p.height;else for(var v in this.glyphs)if(this.glyphs.hasOwnProperty(v)){if(0===(s=this.glyphs[v]).height||0===s.width)continue;this.capHeight=Math.max(this.capHeight,s.height)}this.capHeight-=a}}]),t}(),ColorLayer=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i){var o;return _classCallCheck(this,n),(o=e.call(this,0,0,1/0,1/0)).color=pool$1.pull("Color").parseCSS(r),o.onResetEvent(t,r,i),o}return _createClass(n,[{key:"onResetEvent",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.name=t,this.pos.z=n,this.floating=!0,this.color.parseCSS(e)}},{key:"draw",value:function(t,e){var n=viewport.pos;t.save(),t.clipRect(e.left-n.x,e.top-n.y,e.width,e.height),t.clearColor(this.color),t.restore()}},{key:"destroy",value:function(){pool$1.push(this.color),this.color=void 0,_get(_getPrototypeOf(n.prototype),"destroy",this).call(this)}}]),n}(Renderable),ImageLayer=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i){var o;return _classCallCheck(this,n),(o=e.call(this,t,r,i)).floating=!0,o.offset.set(t,r),o.ratio=pool$1.pull("Vector2d",1,1),void 0!==i.ratio&&(isNumeric(i.ratio)?o.ratio.set(i.ratio,+i.ratio):o.ratio.setV(i.ratio)),void 0===i.anchorPoint?o.anchorPoint.set(0,0):"number"==typeof i.anchorPoint?o.anchorPoint.set(i.anchorPoint,i.anchorPoint):o.anchorPoint.setV(i.anchorPoint),o.repeat=i.repeat||"repeat",on(ONCONTEXT_RESTORED,o.createPattern,_assertThisInitialized(o)),o}return _createClass(n,[{key:"repeat",get:function(){return this._repeat},set:function(t){switch(this._repeat=t,this._repeat){case"no-repeat":this.repeatX=!1,this.repeatY=!1;break;case"repeat-x":this.repeatX=!0,this.repeatY=!1;break;case"repeat-y":this.repeatX=!1,this.repeatY=!0;break;default:this.repeatX=!0,this.repeatY=!0}this.resize(viewport.width,viewport.height),this.createPattern()}},{key:"onActivateEvent",value:function(){var t=this;on(VIEWPORT_ONCHANGE,this.updateLayer,this),on(VIEWPORT_ONRESIZE,this.resize,this),once(LEVEL_LOADED,(function(){t.updateLayer(viewport.pos)})),!0!==this.ancestor.root&&this.updateLayer(viewport.pos)}},{key:"resize",value:function(t,e){_get(_getPrototypeOf(n.prototype),"resize",this).call(this,this.repeatX?1/0:t,this.repeatY?1/0:e)}},{key:"createPattern",value:function(){this._pattern=renderer.createPattern(this.image,this._repeat)}},{key:"updateLayer",value:function(t){var e=this.ratio.x,n=this.ratio.y;if(0!==e||0!==n){var r=this.width,i=this.height,o=viewport.bounds.width,a=viewport.bounds.height,s=this.anchorPoint.x,l=this.anchorPoint.y,u=s*(e-1)*(o-viewport.width)+this.offset.x-e*t.x,c=l*(n-1)*(a-viewport.height)+this.offset.y-n*t.y;this.repeatX?this.pos.x=u%r:this.pos.x=u,this.repeatY?this.pos.y=c%i:this.pos.y=c,this.isDirty=!0}}},{key:"preDraw",value:function(t){t.save(),t.setGlobalAlpha(t.globalAlpha()*this.getOpacity()),t.setTint(this.tint)}},{key:"draw",value:function(t){var e=this.width,n=this.height,r=viewport.bounds.width,i=viewport.bounds.height,o=this.anchorPoint.x,a=this.anchorPoint.y,s=this.pos.x,l=this.pos.y;0===this.ratio.x&&0===this.ratio.y&&(s+=o*(r-e),l+=a*(i-n)),t.translate(s,l),t.drawPattern(this._pattern,0,0,2*viewport.width,2*viewport.height)}},{key:"onDeactivateEvent",value:function(){off(VIEWPORT_ONCHANGE,this.updateLayer),off(VIEWPORT_ONRESIZE,this.resize)}},{key:"destroy",value:function(){pool$1.push(this.ratio),this.ratio=void 0,off(ONCONTEXT_RESTORED,this.createPattern),_get(_getPrototypeOf(n.prototype),"destroy",this).call(this)}}]),n}(Sprite),NineSliceSprite=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i){var o;if(_classCallCheck(this,n),o=e.call(this,t,r,i),"number"!=typeof i.width||"number"!=typeof i.height)throw new Error("height and width properties are mandatory");return o.width=Math.floor(i.width),o.height=Math.floor(i.height),o.nss_width=o.width,o.nss_height=o.height,o.insetx=i.insetx,o.insety=i.insety,o}return _createClass(n,[{key:"draw",value:function(t){var e=this.current,n=this.pos.x,r=this.pos.y,i=e.width,o=e.height,a=e.offset,s=this.offset;0!==e.angle&&(t.translate(-n,-r),t.rotate(e.angle),n-=o,i=e.height,o=e.width);var l=s.x+a.x,u=s.y+a.y,c=this.insetx||i/4,h=this.insety||o/4;t.drawImage(this.image,l,u,c,h,n,r,c,h),t.drawImage(this.image,l+i-c,u,c,h,n+this.nss_width-c,r,c,h),t.drawImage(this.image,l,u+o-h,c,h,n,r+this.nss_height-h,c,h),t.drawImage(this.image,l+i-c,u+o-h,c,h,n+this.nss_width-c,r+this.nss_height-h,c,h);var f=i-(c<<1),d=o-(h<<1),p=this.nss_width-(c<<1),y=this.nss_height-(h<<1);t.drawImage(this.image,l+c,u,f,h,n+c,r,p,h),t.drawImage(this.image,l+c,u+o-h,f,h,n+c,r+this.nss_height-h,p,h),t.drawImage(this.image,l,u+h,c,d,n,r+h,c,y),t.drawImage(this.image,l+i-c,u+h,c,d,n+this.nss_width-c,r+h,c,y),t.drawImage(this.image,l+c,u+h,f,d,n+c,r+h,p,y)}}]),n}(Sprite),GUI_Object=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i){var o;return _classCallCheck(this,n),(o=e.call(this,t,r,i)).isClickable=!0,o.holdThreshold=250,o.isHoldable=!1,o.hover=!1,o.holdTimeout=null,o.released=!0,o.floating=!0,o.isKinematic=!1,o}return _createClass(n,[{key:"clicked",value:function(t){if(0===t.button&&this.isClickable)return this.dirty=!0,this.released=!1,this.isHoldable&&(null!==this.holdTimeout&&timer$1.clearTimeout(this.holdTimeout),this.holdTimeout=timer$1.setTimeout(this.hold.bind(this),this.holdThreshold,!1),this.released=!1),this.onClick(t)}},{key:"onClick",value:function(){return!1}},{key:"enter",value:function(t){return this.hover=!0,this.dirty=!0,this.onOver(t)}},{key:"onOver",value:function(){}},{key:"leave",value:function(t){return this.hover=!1,this.dirty=!0,this.release(t),this.onOut(t)}},{key:"onOut",value:function(){}},{key:"release",value:function(t){if(!1===this.released)return this.released=!0,this.dirty=!0,timer$1.clearTimeout(this.holdTimeout),this.onRelease(t)}},{key:"onRelease",value:function(){return!1}},{key:"hold",value:function(){timer$1.clearTimeout(this.holdTimeout),this.dirty=!0,this.released||this.onHold()}},{key:"onHold",value:function(){}},{key:"onActivateEvent",value:function(){registerPointerEvent("pointerdown",this,this.clicked.bind(this)),registerPointerEvent("pointerup",this,this.release.bind(this)),registerPointerEvent("pointercancel",this,this.release.bind(this)),registerPointerEvent("pointerenter",this,this.enter.bind(this)),registerPointerEvent("pointerleave",this,this.leave.bind(this))}},{key:"onDeactivateEvent",value:function(){releasePointerEvent("pointerdown",this),releasePointerEvent("pointerup",this),releasePointerEvent("pointercancel",this),releasePointerEvent("pointerenter",this),releasePointerEvent("pointerleave",this),timer$1.clearTimeout(this.holdTimeout)}}]),n}(Sprite),Collectable=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i){var o;_classCallCheck(this,n),(o=e.call(this,t,r,i)).name=i.name,o.type=i.type,o.id=i.id;var a=i.shapes;return void 0===a&&(a=pool.pull("Polygon",0,0,[pool.pull("Vector2d",0,0),pool.pull("Vector2d",o.width,0),pool.pull("Vector2d",o.width,o.height)])),o.body=new Body(_assertThisInitialized(o),a),o.body.collisionType=collision.types.COLLECTABLE_OBJECT,o.body.setCollisionMask(collision.types.PLAYER_OBJECT),o.body.setStatic(!0),i.anchorPoint?o.anchorPoint.set(i.anchorPoint.x,i.anchorPoint.y):o.anchorPoint.set(0,0),o}return _createClass(n)}(Sprite),Trigger=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i){var o;_classCallCheck(this,n),(o=e.call(this,t,r,i.width||0,i.height||0)).anchorPoint.set(0,0),o.fade=i.fade,o.duration=i.duration,o.fading=!1,o.name="Trigger",o.type=i.type,o.id=i.id,o.gotolevel=i.to,o.triggerSettings={event:"level"},["type","container","onLoaded","flatten","setViewportBounds","to"].forEach(function(t){void 0!==i[t]&&(this.triggerSettings[t]=i[t])}.bind(_assertThisInitialized(o)));var a=i.shapes;return void 0===a&&(a=pool.pull("Polygon",0,0,[pool.pull("Vector2d",0,0),pool.pull("Vector2d",o.width,0),pool.pull("Vector2d",o.width,o.height)])),o.body=new Body(_assertThisInitialized(o),a),o.body.collisionType=collision.types.ACTION_OBJECT,o.body.setCollisionMask(collision.types.PLAYER_OBJECT),o.body.setStatic(!0),o.resize(o.body.getBounds().width,o.body.getBounds().height),o}return _createClass(n,[{key:"getTriggerSettings",value:function(){return"string"==typeof this.triggerSettings.container&&(this.triggerSettings.container=world.getChildByName(this.triggerSettings.container)[0]),this.triggerSettings}},{key:"onFadeComplete",value:function(){level.load(this.gotolevel,this.getTriggerSettings()),viewport.fadeOut(this.fade,this.duration)}},{key:"triggerEvent",value:function(){var t=this.getTriggerSettings();if("level"!==t.event)throw new Error("Trigger invalid type");this.gotolevel=t.to,this.fade&&this.duration?this.fading||(this.fading=!0,viewport.fadeIn(this.fade,this.duration,this.onFadeComplete.bind(this))):level.load(this.gotolevel,t)}},{key:"onCollision",value:function(){return"Trigger"===this.name&&this.triggerEvent.apply(this),!1}}]),n}(Renderable),Draggable=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i,o){var a;return _classCallCheck(this,n),(a=e.call(this,t,r,i,o)).isKinematic=!1,a.dragging=!1,a.dragId=null,a.grabOffset=new Vector2d(0,0),a.initEvents(),a}return _createClass(n,[{key:"initEvents",value:function(){var t=this;registerPointerEvent("pointerdown",this,(function(e){emit(DRAGSTART,e,t)})),registerPointerEvent("pointerup",this,(function(e){emit(DRAGEND,e,t)})),registerPointerEvent("pointercancel",this,(function(e){emit(DRAGEND,e,t)})),on(POINTERMOVE,this.dragMove.bind(this)),on(DRAGSTART,(function(e,n){n===t&&t.dragStart(e)})),on(DRAGEND,(function(e,n){n===t&&t.dragEnd(e)}))}},{key:"dragStart",value:function(t){if(!1===this.dragging)return this.dragging=!0,this.grabOffset.set(t.gameX,t.gameY),this.grabOffset.sub(this.pos),!1}},{key:"dragMove",value:function(t){!0===this.dragging&&(this.pos.set(t.gameX,t.gameY,this.pos.z),this.pos.sub(this.grabOffset))}},{key:"dragEnd",value:function(){if(!0===this.dragging)return this.dragging=!1,!1}},{key:"destroy",value:function(){off(POINTERMOVE,this.dragMove),off(DRAGSTART,this.dragStart),off(DRAGEND,this.dragEnd),releasePointerEvent("pointerdown",this),releasePointerEvent("pointerup",this),releasePointerEvent("pointercancel",this),_get(_getPrototypeOf(n.prototype),"destroy",this).call(this)}}]),n}(Renderable),DropTarget=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i,o){var a;return _classCallCheck(this,n),(a=e.call(this,t,r,i,o)).isKinematic=!1,a.CHECKMETHOD_OVERLAP="overlaps",a.CHECKMETHOD_CONTAINS="contains",a.checkMethod=a.CHECKMETHOD_OVERLAP,on(DRAGEND,a.checkOnMe,_assertThisInitialized(a)),a}return _createClass(n,[{key:"setCheckMethod",value:function(t){"function"==typeof this.getBounds()[this.checkMethod]&&(this.checkMethod=t)}},{key:"checkOnMe",value:function(t,e){e&&this.getBounds()[this.checkMethod](e.getBounds())&&this.drop(e)}},{key:"drop",value:function(){}},{key:"destroy",value:function(){off(DRAGEND,this.checkOnMe),_get(_getPrototypeOf(n.prototype),"destroy",this).call(this)}}]),n}(Renderable),ParticleEmitterSettings={width:1,height:1,image:void 0,textureSize:8,tint:"#fff",totalParticles:50,angle:Math.PI/2,angleVariation:0,minLife:1e3,maxLife:3e3,speed:2,speedVariation:1,minRotation:0,maxRotation:0,minStartScale:1,maxStartScale:1,minEndScale:0,maxEndScale:0,gravity:0,wind:0,followTrajectory:!1,textureAdditive:!1,blendMode:"normal",onlyInViewport:!0,floating:!1,maxParticles:10,frequency:100,duration:1/0,framesToSkip:0},defaultParticleTexture;function createDefaultParticleTexture(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8;if(void 0===defaultParticleTexture){var n=(defaultParticleTexture=createCanvas(t,e,!0)).getContext("2d");n.fillStyle="#fff",n.fillRect(0,0,t,e)}return defaultParticleTexture}var ParticleEmitter=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r){var i,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return _classCallCheck(this,n),(i=e.call(this,t,r,1|o.width,1|o.height)).settings={},i.centerOn(t,r),i._stream=!1,i._frequencyTimer=0,i._durationTimer=0,i._enabled=!1,i.alwaysUpdate=!0,i.autoSort=!1,i._updateCount=0,i._dt=0,i.reset(o),i}return _createClass(n,[{key:"reset",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object.assign(this.settings,ParticleEmitterSettings,t),void 0===this.settings.image&&(this.settings.image=createDefaultParticleTexture(t.textureSize,t.textureSize)),this.floating=this.settings.floating,this.isDirty=!0}},{key:"getRandomPointX",value:function(){return randomFloat(0,this.getBounds().width)}},{key:"getRandomPointY",value:function(){return randomFloat(0,this.getBounds().height)}},{key:"addParticles",value:function(t){for(var e=0;e<t;e++)this.addChild(pool$1.pull("Particle",this),this.pos.z);this.isDirty=!0}},{key:"isRunning",value:function(){return this._enabled&&this._stream}},{key:"streamParticles",value:function(t){this._enabled=!0,this._stream=!0,this.settings.frequency=Math.max(1,this.settings.frequency),this._durationTimer="number"==typeof t?t:this.settings.duration}},{key:"stopStream",value:function(){this._enabled=!1}},{key:"burstParticles",value:function(t){this._enabled=!0,this._stream=!1,this.addParticles("number"==typeof t?t:this.settings.totalParticles),this._enabled=!1}},{key:"update",value:function(t){if(++this._updateCount>this.settings.framesToSkip&&(this._updateCount=0),this._updateCount>0)return this._dt+=t,this.isDirty;if(t+=this._dt,this._dt=0,this.isDirty|=_get(_getPrototypeOf(n.prototype),"update",this).call(this,t),this._enabled&&this._stream){if(this._durationTimer!==1/0&&(this._durationTimer-=t,this._durationTimer<=0))return this.stopStream(),this.isDirty;this._frequencyTimer+=t;var e=this.children.length;e<this.settings.totalParticles&&this._frequencyTimer>=this.settings.frequency&&(e+this.settings.maxParticles<=this.settings.totalParticles?this.addParticles(this.settings.maxParticles):this.addParticles(this.settings.totalParticles-e),this._frequencyTimer=0,this.isDirty=!0)}return this.isDirty}},{key:"destroy",value:function(){_get(_getPrototypeOf(n.prototype),"destroy",this).call(this,arguments),this.settings.image=void 0,this.settings=void 0}}]),n}(Container),Particle=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r;return _classCallCheck(this,n),(r=e.call(this,t.getRandomPointX(),t.getRandomPointY(),t.settings.image.width,t.settings.image.height)).onResetEvent(t,!0),r}return _createClass(n,[{key:"onResetEvent",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];!1===e?(this.pos.set(t.getRandomPointX(),t.getRandomPointY()),this.resize(t.settings.image.width,t.settings.image.height),this.currentTransform.identity()):this.vel=pool$1.pull("Vector2d"),this.image=t.settings.image,this.alwaysUpdate=!0,"string"==typeof t.settings.tint&&this.tint.parseCSS(t.settings.tint),!0===t.settings.textureAdditive&&(this.blendMode="additive"),"normal"!==t.settings.blendMode&&(this.blendMode=t.settings.blendMode);var n=t.settings.angle+(t.settings.angleVariation>0?(randomFloat(0,2)-1)*t.settings.angleVariation:0),r=t.settings.speed+(t.settings.speedVariation>0?(randomFloat(0,2)-1)*t.settings.speedVariation:0);this.vel.set(r*Math.cos(n),-r*Math.sin(n)),this.life=randomFloat(t.settings.minLife,t.settings.maxLife),this.startLife=this.life,this.startScale=_clamp(randomFloat(t.settings.minStartScale,t.settings.maxStartScale),t.settings.minStartScale,t.settings.maxStartScale),this.endScale=_clamp(randomFloat(t.settings.minEndScale,t.settings.maxEndScale),t.settings.minEndScale,t.settings.maxEndScale),this.gravity=t.settings.gravity,this.wind=t.settings.wind,this.followTrajectory=t.settings.followTrajectory,this.onlyInViewport=t.settings.onlyInViewport,this._deltaInv=timer$1.maxfps/1e3,t.settings.followTrajectory||(this.angle=randomFloat(t.settings.minRotation,t.settings.maxRotation))}},{key:"update",value:function(t){var e=t*this._deltaInv;if(this.life=this.life>t?this.life-t:0,this.life<=0)return this.ancestor.removeChild(this),!1;var r=this.life/this.startLife,i=this.startScale;this.startScale>this.endScale?i=(i*=r)<this.endScale?this.endScale:i:this.startScale<this.endScale&&(i=(i/=r)>this.endScale?this.endScale:i),this.alpha=r,this.vel.x+=this.wind*e,this.vel.y+=this.gravity*e;var o=this.followTrajectory?Math.atan2(this.vel.y,this.vel.x):this.angle;return this.pos.x+=this.vel.x*e,this.pos.y+=this.vel.y*e,this.currentTransform.setTransform(i,0,0,0,i,0,this.pos.x,this.pos.y,1).rotate(o),this.isDirty=this.inViewport||!this.onlyInViewport,_get(_getPrototypeOf(n.prototype),"update",this).call(this,t)}},{key:"draw",value:function(t){var e=this.width,n=this.height;t.drawImage(this.image,0,0,e,n,-e/2,-n/2,e,n)}}]),n}(Renderable),Entity=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i){var o;if(_classCallCheck(this,n),"number"!=typeof i.width||"number"!=typeof i.height)throw new Error("height and width properties are mandatory when passing settings parameters to an object entity");return(o=e.call(this,t,r,i.width,i.height)).children=[],i.image&&(i.framewidth=i.framewidth||i.width,i.frameheight=i.frameheight||i.height,o.renderable=new Sprite(0,0,i)),i.anchorPoint?o.anchorPoint.set(i.anchorPoint.x,i.anchorPoint.y):o.anchorPoint.set(0,0),"string"==typeof i.name&&(o.name=i.name),o.type=i.type||"",o.id=i.id||"",o.alive=!0,void 0===i.shapes&&(i.shapes=pool$1.pull("Polygon",0,0,[pool$1.pull("Vector2d",0,0),pool$1.pull("Vector2d",o.width,0),pool$1.pull("Vector2d",o.width,o.height),pool$1.pull("Vector2d",0,o.height)])),o.body=new Body(_assertThisInitialized(o),i.shapes,o.onBodyUpdate.bind(_assertThisInitialized(o))),0===o.width&&0===o.height&&o.resize(o.body.getBounds().width,o.body.getBounds().height),o.body.setCollisionMask(i.collisionMask),o.body.setCollisionType(i.collisionType),o.autoTransform=!1,o}return _createClass(n,[{key:"renderable",get:function(){return this.children[0]},set:function(t){if(!(t instanceof Renderable))throw new Error(t+"should extend me.Renderable");this.children[0]=t,this.children[0].ancestor=this}},{key:"update",value:function(t){return this.renderable&&(this.isDirty|=this.renderable.update(t)),_get(_getPrototypeOf(n.prototype),"update",this).call(this,t)}},{key:"onBodyUpdate",value:function(t){this.getBounds().addBounds(t.getBounds(),!0),this.updateBoundsPos(this.pos.x,this.pos.y)}},{key:"preDraw",value:function(t){t.save(),t.translate(this.pos.x+this.body.getBounds().x,this.pos.y+this.body.getBounds().y),this.renderable instanceof Renderable&&t.translate(this.anchorPoint.x*this.body.getBounds().width,this.anchorPoint.y*this.body.getBounds().height)}},{key:"draw",value:function(t,e){var n=this.renderable;n instanceof Renderable&&(n.preDraw(t),n.draw(t,e),n.postDraw(t))}},{key:"destroy",value:function(){this.renderable&&(this.renderable.destroy.apply(this.renderable,arguments),this.children.splice(0,1)),_get(_getPrototypeOf(n.prototype),"destroy",this).call(this,arguments)}},{key:"onDeactivateEvent",value:function(){this.renderable&&this.renderable.onDeactivateEvent&&this.renderable.onDeactivateEvent()}}]),n}(Renderable);function warning(t,e,n){var r="melonJS: %s is deprecated since version %s, please use %s",i=(new Error).stack;console.groupCollapsed?console.groupCollapsed("%c"+r,"font-weight:normal;color:yellow;",t,n,e):console.warn(r,t,n,e),void 0!==i&&console.warn(i),console.groupCollapsed&&console.groupEnd()}device$1.turnOnPointerLock=function(){return warning("device.turnOnPointerLock()","input.requestPointerLock()","10.3.0"),requestPointerLock()},device$1.turnOffPointerLock=function(){return warning("device.turnOffPointerLock()","input.exitPointerLock()","10.3.0"),exitPointerLock()},Object.defineProperty(Renderer.prototype,"Texture",{get:function(){return warning("me.video.renderer.Texture","me.TextureAtlas","10.4.0"),TextureAtlas}});var DraggableEntity=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i){return _classCallCheck(this,n),warning("DraggableEntity","Draggable","10.5.0"),e.call(this,t,r,i.width,i.height)}return _createClass(n)}(Draggable),DroptargetEntity=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i){return _classCallCheck(this,n),warning("DroptargetEntity","DropTarget","10.5.0"),e.call(this,t,r,i.width,i.height)}return _createClass(n)}(DropTarget),version="10.9.0",initialized=!1,skipAutoInit=!1;function boot(){!0!==initialized&&(pool$1.register("me.Entity",Entity),pool$1.register("me.Collectable",Collectable),pool$1.register("me.Trigger",Trigger),pool$1.register("me.Tween",Tween,!0),pool$1.register("me.Color",Color,!0),pool$1.register("me.Particle",Particle,!0),pool$1.register("me.Sprite",Sprite),pool$1.register("me.NineSliceSprite",NineSliceSprite),pool$1.register("me.Renderable",Renderable),pool$1.register("me.Text",Text,!0),pool$1.register("me.BitmapText",BitmapText),pool$1.register("me.BitmapTextData",BitmapTextData,!0),pool$1.register("me.ImageLayer",ImageLayer),pool$1.register("me.ColorLayer",ColorLayer,!0),pool$1.register("me.Vector2d",Vector2d,!0),pool$1.register("me.Vector3d",Vector3d,!0),pool$1.register("me.ObservableVector2d",ObservableVector2d,!0),pool$1.register("me.ObservableVector3d",ObservableVector3d,!0),pool$1.register("me.Matrix2d",Matrix2d,!0),pool$1.register("me.Matrix3d",Matrix3d,!0),pool$1.register("me.Rect",Rect,!0),pool$1.register("me.RoundRect",RoundRect,!0),pool$1.register("me.Polygon",Polygon,!0),pool$1.register("me.Line",Line,!0),pool$1.register("me.Ellipse",Ellipse,!0),pool$1.register("me.Bounds",Bounds$1,!0),pool$1.register("Entity",Entity),pool$1.register("Collectable",Collectable),pool$1.register("Trigger",Trigger),pool$1.register("Tween",Tween,!0),pool$1.register("Color",Color,!0),pool$1.register("Particle",Particle,!0),pool$1.register("Sprite",Sprite),pool$1.register("NineSliceSprite",NineSliceSprite),pool$1.register("Renderable",Renderable),pool$1.register("Text",Text,!0),pool$1.register("BitmapText",BitmapText),pool$1.register("BitmapTextData",BitmapTextData,!0),pool$1.register("ImageLayer",ImageLayer),pool$1.register("ColorLayer",ColorLayer,!0),pool$1.register("Vector2d",Vector2d,!0),pool$1.register("Vector3d",Vector3d,!0),pool$1.register("ObservableVector2d",ObservableVector2d,!0),pool$1.register("ObservableVector3d",ObservableVector3d,!0),pool$1.register("Matrix2d",Matrix2d,!0),pool$1.register("Matrix3d",Matrix3d,!0),pool$1.register("Rect",Rect,!0),pool$1.register("RoundRect",RoundRect,!0),pool$1.register("Polygon",Polygon,!0),pool$1.register("Line",Line,!0),pool$1.register("Ellipse",Ellipse,!0),pool$1.register("Bounds",Bounds$1,!0),emit(BOOT),loader.setNocache(utils.getUriFragment().nocache||!1),initKeyboardEvent(),initialized=!0)}device$1.onReady((function(){boot()}))}},__webpack_module_cache__={};function __webpack_require__(t){var e=__webpack_module_cache__[t];if(void 0!==e)return e.exports;var n=__webpack_module_cache__[t]={id:t,loaded:!1,exports:{}};return __webpack_modules__[t](n,n.exports,__webpack_require__),n.loaded=!0,n.exports}__webpack_require__.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return __webpack_require__.d(e,{a:e}),e},__webpack_require__.d=(t,e)=>{for(var n in e)__webpack_require__.o(e,n)&&!__webpack_require__.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},__webpack_require__.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),__webpack_require__.nmd=t=>(t.paths=[],t.children||(t.children=[]),t),__webpack_require__.nc=void 0;var __webpack_exports__={};(()=>{"use strict";__webpack_require__(2354);var t,e=(t=__webpack_require__(4019))&&t.__esModule?t:{default:t};e.default._babelPolyfill&&"undefined"!=typeof console&&console.warn&&console.warn("@babel/polyfill is loaded more than once on this page. This is probably not desirable/intended and may have consequences if different versions of the polyfills are applied sequentially. If you do need to load the polyfill more than once, use @babel/polyfill/noConflict instead to bypass the warning."),e.default._babelPolyfill=!0})(),(()=>{"use strict";var t=__webpack_require__(5909),e=__webpack_require__(3379),n=__webpack_require__.n(e),r=__webpack_require__(7795),i=__webpack_require__.n(r),o=__webpack_require__(569),a=__webpack_require__.n(o),s=__webpack_require__(3565),l=__webpack_require__.n(s),u=__webpack_require__(9216),c=__webpack_require__.n(u),h=__webpack_require__(4589),f=__webpack_require__.n(h),d=__webpack_require__(1424),p={};p.styleTagTransform=f(),p.setAttributes=l(),p.insert=a().bind(null,"head"),p.domAPI=i(),p.insertStyleElement=c(),n()(d.Z,p),d.Z&&d.Z.locals&&d.Z.locals;const y={};function v(t){return v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},v(t)}function g(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function m(t,e,n){return e&&g(t.prototype,e),n&&g(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function _(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function b(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&x(t,e)}function x(t,e){return x=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},x(t,e)}function w(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=E(t);if(e){var i=E(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return T(this,n)}}function T(t,e){if(e&&("object"===v(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function E(t){return E=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},E(t)}var S={},k=function(t){b(n,t);var e=w(n);function n(){var t;return _(this,n),(t=e.call(this)).isPersistent=!0,t.floating=!0,t.name="HUD",t.addChild(new S.ScoreItem(5,5)),t}return m(n)}(t.W2);S.Container=k;var O=function(e){b(r,e);var n=w(r);function r(e,i){var o;return _(this,r),(o=n.call(this,e,i,10,10)).font=new t.Xz(0,0,{font:"doodleFont",textAlign:"left",textBaseline:"top"}),o.score=-1,o}return m(r,[{key:"update",value:function(){return this.score!==y.score&&(this.score=y.score,!0)}},{key:"draw",value:function(t){this.font.draw(t,y.score,10,10)}}]),r}(t.MJ);S.ScoreItem=O;const A=S;function P(t){return P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},P(t)}function C(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function R(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function I(t,e){return I=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},I(t,e)}function M(t,e){if(e&&("object"===P(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function L(t){return L=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},L(t)}const $=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&I(t,e)}(s,e);var n,r,i,o,a=(i=s,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=L(i);if(o){var n=L(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return M(this,t)});function s(){return C(this,s),a.apply(this,arguments)}return n=s,(r=[{key:"onResetEvent",value:function(){var e=new t.jy(t.H6.viewport.width/2,t.H6.viewport.height/2,{image:t._m.getImage("background")});e.scale(t.H6.viewport.width/e.width,t.H6.viewport.height/e.height),t.H6.world.addChild(e,0),y.score=0,this.HUD=new A.Container,t.H6.world.addChild(this.HUD,11),t.H6.world.addChild(t.d_.pull("player"),10),t.H6.world.addChild(t.d_.pull("platform_d",t.H6.viewport.width/2-16,t.H6.viewport.height),2);for(var n=0;n<20;n++)t.H6.world.addChild(t.d_.pull("platform_d",t.ZX.random(0,t.H6.viewport.width),t.ZX.random(0,t.H6.viewport.height)));t.qH.bindKey(t.qH.KEY.LEFT,"left"),t.qH.bindKey(t.qH.KEY.RIGHT,"right"),t.qH.bindKey(t.qH.KEY.A,"left"),t.qH.bindKey(t.qH.KEY.D,"right"),t.qH.bindKey(t.qH.KEY.SPACE,"jump")}},{key:"onDestroyEvent",value:function(){t.qH.unbindKey(t.qH.KEY.LEFT),t.qH.unbindKey(t.qH.KEY.RIGHT),t.qH.unbindKey(t.qH.KEY.A),t.qH.unbindKey(t.qH.KEY.D),t.qH.unbindKey(t.qH.KEY.SPACE),t.H6.world.removeChild(this.HUD)}}])&&R(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),s}(t.Hf);function D(t){return D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},D(t)}function j(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function B(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function N(t,e,n){return e&&B(t.prototype,e),n&&B(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function F(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&V(t,e)}function V(t,e){return V=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},V(t,e)}function G(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H(t);if(e){var i=H(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z(this,n)}}function z(t,e){if(e&&("object"===D(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return U(t)}function U(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function H(t){return H=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},H(t)}var X={},W=function(e){F(r,e);var n=G(r);function r(t,e){var i;j(this,r);return(i=n.call(this,t,e,{image:"button_restart",framewidth:224,frameheight:82})).pos.z=4,i}return N(r,[{key:"onClick",value:function(e){return t.SB.change(t.SB.PLAY),!1}}]),r}(t.nC),Y=function(e){F(r,e);var n=G(r);function r(t,e){var i;j(this,r);return(i=n.call(this,t,e,{image:"button_menu",framewidth:112,frameheight:41})).pos.z=4,i}return N(r,[{key:"onClick",value:function(e){return t.SB.change(t.SB.MENU),!1}}]),r}(t.nC),q=function(e){F(r,e);var n=G(r);function r(e,i){var o;return j(this,r),(o=n.call(this,e,i,{image:"player",width:32,height:32,framewidth:62,frameheight:60})).rotate(t.ZX.degToRad(t.ZX.random(0,225))),o.velocity=.05,o.gravity=.15,o.deltaY=0,o.body=new t.uT(U(o)),o.body.ignoreGravity=!1,o.body.addShape(new t.UL(15,13,31,46)),o.body.setMaxVelocity(3,15),o.body.setFriction(.4,0),o.body.force.set(4,0),o.addAnimation("idle",[5,6,7],25),o.setCurrentAnimation("idle"),o}return N(r)}(t.jy),K=function(e){F(r,e);var n=G(r);function r(e,i){var o;return j(this,r),(o=n.call(this,e,i,10,10)).font=new t.Xz(0,0,{font:"doodleFont",textAlign:"left",textBaseline:"top"}),o.score=-1,o}return N(r,[{key:"update",value:function(){return this.score!==y.score&&(this.score=y.score,!0)}},{key:"draw",value:function(e){this.font.draw(e,"Your score: "+y.score,t.H6.viewport.width/3,t.H6.viewport.height/2.5)}}]),r}(t.MJ);X.restart=W,X.dummy=q,X.score=K,X.menu=Y;const Z=X;function J(t){return J="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},J(t)}function Q(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function tt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function et(t,e){return et=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},et(t,e)}function nt(t,e){if(e&&("object"===J(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function rt(t){return rt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},rt(t)}const it=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&et(t,e)}(s,e);var n,r,i,o,a=(i=s,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=rt(i);if(o){var n=rt(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return nt(this,t)});function s(){return Q(this,s),a.apply(this,arguments)}return n=s,(r=[{key:"onResetEvent",value:function(){var e=new t.jy(t.H6.viewport.width/2,t.H6.viewport.height/2,{image:t._m.getImage("background")}),n=new t.jy(t.H6.viewport.width/2,100,{image:t._m.getImage("title_gameover"),framewidth:441,frameheight:107});e.scale(t.H6.viewport.width/e.width,t.H6.viewport.height/e.height),t.H6.world.addChild(new Z.dummy(t.ZX.random(t.H6.viewport.width/3,2*t.H6.viewport.width/3),-10),1),t.H6.world.addChild(e,0),t.H6.world.addChild(n,10),t.H6.world.addChild(new Z.score(0,0)),t.H6.world.addChild(new Z.restart(t.H6.viewport.width/2,t.H6.viewport.height/2+100),10),t.H6.world.addChild(new Z.menu(t.H6.viewport.width/1.2,t.H6.viewport.height/1.2),10)}},{key:"onDestroyEvent",value:function(){}}])&&tt(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),s}(t.Hf);function ot(t){return ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ot(t)}function at(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function st(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function lt(t,e,n){return e&&st(t.prototype,e),n&&st(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function ut(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ct(t,e)}function ct(t,e){return ct=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},ct(t,e)}function ht(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=pt(t);if(e){var i=pt(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return ft(this,n)}}function ft(t,e){if(e&&("object"===ot(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return dt(t)}function dt(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function pt(t){return pt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},pt(t)}var yt={},vt=function(e){ut(r,e);var n=ht(r);function r(t,e){var i;at(this,r);return(i=n.call(this,t,e,{image:"button_play",framewidth:222,frameheight:80})).pos.z=4,i}return lt(r,[{key:"onClick",value:function(e){return t.SB.change(t.SB.PLAY),!1}}]),r}(t.nC),gt=function(e){ut(r,e);var n=ht(r);function r(e,i){var o;return at(this,r),(o=n.call(this,e,i,{image:"player",width:32,height:32,framewidth:62,frameheight:60})).jump=0,o.velocity=.1,o.gravity=.1,o.body=new t.uT(dt(o)),o.body.ignoreGravity=!0,o.body.addShape(new t.UL(15,13,31,46)),o.addAnimation("idle",[0],1),o.setCurrentAnimation("idle"),o}return lt(r,[{key:"update",value:function(e){var n=t.H6.world.fps;this.jump>0&&(this.pos.y-=this.jump*n/1e3,this.jump-=this.jump>0?10:0),this.velocity+=this.gravity,this.velocity>20&&(this.velocity=20),this.pos.y+=this.velocity}},{key:"onCollision",value:function(e,n){return n.body.collisionType==t.v7.types.WORLD_SHAPE&&(this.jump=200,this.velocity=0,t.n0.play("jump")),!1}}]),r}(t.jy);yt.play=vt,yt.dummy=gt;const mt=yt;function _t(t){return _t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_t(t)}function bt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function xt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function wt(t,e){return wt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},wt(t,e)}function Tt(t,e){if(e&&("object"===_t(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Et(t){return Et=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Et(t)}const St=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&wt(t,e)}(s,e);var n,r,i,o,a=(i=s,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Et(i);if(o){var n=Et(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return Tt(this,t)});function s(){return bt(this,s),a.apply(this,arguments)}return n=s,(r=[{key:"onResetEvent",value:function(){var e=new t.jy(t.H6.viewport.width/2,t.H6.viewport.height/2,{image:t._m.getImage("background")}),n=new t.jy(t.H6.viewport.width/2,100,{image:t._m.getImage("title_menu"),framewidth:404,frameheight:92}),r=new t.jy(t.H6.viewport.width-314,t.H6.viewport.height/2,{image:t._m.getImage("tutorial"),framewidth:314,frameheight:148}),i=new t.jy(t.H6.viewport.width/4,t.H6.viewport.height/2+150,{image:t._m.getImage("tutorial2"),framewidth:300,frameheight:28});r.scale(1.5,1.5),e.scale(t.H6.viewport.width/e.width,t.H6.viewport.height/e.height),t.H6.world.addChild(e,0),t.H6.world.addChild(r,10),t.H6.world.addChild(i,10),t.H6.world.addChild(n,10),t.H6.world.addChild(new mt.play(t.H6.viewport.width/2,t.H6.viewport.height/2+100),10),t.H6.world.addChild(new mt.dummy(t.H6.viewport.width/4,t.H6.viewport.height/3),1),t.H6.world.addChild(t.d_.pull("platform_d",t.H6.viewport.width/4,t.H6.viewport.height/2+100),2)}},{key:"onDestroyEvent",value:function(){}}])&&xt(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),s}(t.Hf);function kt(t){return kt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kt(t)}function Ot(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function At(t,e){return At=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},At(t,e)}function Pt(t,e){if(e&&("object"===kt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Ct(t)}function Ct(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Rt(t){return Rt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Rt(t)}const It=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&At(t,e)}(s,e);var n,r,i,o,a=(i=s,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Rt(i);if(o){var n=Rt(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return Pt(this,t)});function s(e,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),(r=a.call(this,e,n,{image:"jetpack",width:27,height:72,framewidth:27,frameheight:72})).scale(.4,.4),r.rotate(t.ZX.degToRad(t.ZX.random(-25,25))),r.body=new t.uT(Ct(r)),r.body.ignoreGravity=!1,r.body.addShape(new t.UL(0,0,27,72)),r.body.setMaxVelocity(3,15),r.body.setFriction(.4,0),r.body.force.set(t.ZX.randomFloat(1,3),-.7),r}return n=s,(r=[{key:"onCollision",value:function(t,e){return!1}}])&&Ot(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),s}(t.jy);function Mt(t){return Mt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mt(t)}function Lt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function $t(){return $t="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=Dt(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}},$t.apply(this,arguments)}function Dt(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Ft(t)););return t}function jt(t,e){return jt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},jt(t,e)}function Bt(t,e){if(e&&("object"===Mt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Nt(t)}function Nt(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ft(t){return Ft=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Ft(t)}var Vt=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&jt(t,e)}(s,e);var n,r,i,o,a=(i=s,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Ft(i);if(o){var n=Ft(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return Bt(this,t)});function s(){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),(e=a.call(this,t.H6.viewport.width/2-16,t.H6.viewport.height-32-100,{image:"player",width:32,height:32,framewidth:62,frameheight:60})).maxX=t.H6.viewport.width-e.width,e.maxY=t.H6.viewport.height,e.vecto=0,e.velocity=.05,e.gravity=.15,e.deltaY=0,e.jetpacking=!1,e.stun=!1,e.movementSpeed=110,e.jumpPower=300,e.body=new t.uT(Nt(e)),e.body.ignoreGravity=!0,e.body.addShape(new t.UL(15,13,31,46)),e.body.setMaxVelocity(0,0),e.body.setFriction(0,0),e.body.force.set(0,0),e.addAnimation("idle",[0],1),e.addAnimation("jump",[1],1),e.addAnimation("jetpack",[2,3,4],10),e.addAnimation("stun",[5,6,7],30),e.setCurrentAnimation("idle"),t.H6.viewport.follow(Nt(e),t.H6.viewport.AXIS.VERTICAL),y.score=0,e}return n=s,r=[{key:"update",value:function(e){var n=this;$t(Ft(s.prototype),"update",this).call(this,e);var r=t.H6.world.fps;if(t.qH.isKeyPressed("left")&&(this.pos.x-=this.movementSpeed*r/1e3,this.flipX(!1)),t.qH.isKeyPressed("right")&&(this.pos.x+=this.movementSpeed*r/1e3,this.flipX(!0)),this.jetpacking&&this.jump<=0){t.n0.fade("jetpack",1,0,1e3);var i=new It(this.pos.x,this.pos.y);t.H6.world.addChild(i),setTimeout((function(){t.H6.world.removeChild(i)}),5e3)}if(this.jump>0?this.jetpacking?this.setCurrentAnimation("jetpack"):this.setCurrentAnimation("jump"):this.stun?this.setCurrentAnimation("stun"):(this.setCurrentAnimation("idle"),this.jetpacking=!1),this.jump>0){if(this.pos.y-this.jump*r/1e3<t.H6.viewport.height/2.5){var o=t.H6.world.getChildren();o.forEach((function(e){var i,o,a;(null===(i=e.body)||void 0===i?void 0:i.collisionType)!==t.v7.types.WORLD_SHAPE&&(null===(o=e.body)||void 0===o?void 0:o.collisionType)!==t.v7.types.COLLECTABLE_OBJECT&&(null===(a=e.body)||void 0===a?void 0:a.collisionType)!==t.v7.types.NPC_OBJECT||(e.pos.y+=n.jump*r/1e3)}));for(var a=0;a<o.length;a++){var l,u;(null===(l=o[a].body)||void 0===l?void 0:l.collisionType)===t.v7.types.WORLD_SHAPE&&o[a].pos.y>t.H6.viewport.height?(t.H6.world.removeChild(o[a]),this.spawnPlatform()):(null===(u=o[a].body)||void 0===u?void 0:u.collisionType)===t.v7.types.COLLECTABLE_OBJECT&&o[a].pos.y>t.H6.viewport.height&&t.H6.world.removeChild(o[a])}y.score+=~~(this.jump*r/1e3*.1)}else this.pos.y-=this.jump*r/1e3;this.jump-=this.jump>0?10:0}var c=this.pos.y;return this.velocity+=this.gravity,this.velocity>20&&(this.velocity=20),this.pos.y+=this.velocity,this.deltaY=c-this.pos.y,this.pos.x<0&&(this.pos.x=t.H6.viewport.width),this.pos.x>t.H6.viewport.width&&(this.pos.x=0),this.pos.y=t.ZX.clamp(this.pos.y,0,this.maxY),this.pos.y>=this.maxY&&(t.SB.change(t.SB.GAMEOVER),t.n0.play("lose")),!0}},{key:"onCollision",value:function(e,n){return!this.stun&&(n.body.collisionType!=t.v7.types.NPC_OBJECT||this.jetpacking?(n.body.collisionType==t.v7.types.COLLECTABLE_OBJECT?this.deltaY<-4&&("spring"==n.name&&(n.name="spring_used",this.doJump(1.5*this.jumpPower)),"jetpack"==n.name&&(this.doJump(4*this.jumpPower),t.n0.play("jetpack"),this.jetpacking=!0,n.pos.y=t.H6.viewport.height+20)):n.body.collisionType==t.v7.types.WORLD_SHAPE&&this.deltaY<-5&&("brown"==n.name||"brown_break"==n.name?(n.name="brown_break",setTimeout((function(){null!=n&&null!=n.pos&&(n.pos.y=t.H6.viewport.height+20)}),270)):("white"==n.name&&(n.pos.y=t.H6.viewport.height+20),this.doJump())),!1):(this.stun=!0,t.n0.play("stun",!1,void 0,.5),this.setCurrentAnimation("stun"),!1))}},{key:"doJump",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.jumpPower;this.jump=e,this.velocity=0,t.n0.play("jump")}},{key:"spawnPlatform",value:function(){var e=t.ZX.random(0,6);if(30==t.ZX.random(0,50)&&y.score>150){var n=t.ZX.random(1,4);t.H6.world.addChild(t.d_.pull("monster_"+n,t.ZX.random(0,t.H6.viewport.width),-20),1),this.jetpacking||3==n||(t.n0.fade("monster",.5,0,2e3),t.n0.play("monster",!1,void 0,.5))}switch(e){case 0:case 1:var r=t.ZX.random(0,t.H6.viewport.width),i=t.ZX.random(-10,10);t.H6.world.addChild(t.d_.pull("platform_d",r,i),1),6==t.ZX.random(0,7)?t.H6.world.addChild(t.d_.pull("item_spring",t.ZX.random(r,r+20),i-17),2):14==t.ZX.random(0,15)&&t.H6.world.addChild(t.d_.pull("item_jetpack",t.ZX.random(r,r+20),i-17),2);break;case 2:t.H6.world.addChild(t.d_.pull("platform_m",t.ZX.random(0,t.H6.viewport.width),t.ZX.random(-10,10)),1);break;case 3:case 4:t.H6.world.addChild(t.d_.pull("platform_w",t.ZX.random(0,t.H6.viewport.width),t.ZX.random(-10,10)),1);break;case 5:var o=0;t.H6.world.getChildren().forEach((function(t){"brown"==t.name&&o++})),t.H6.world.addChild(t.d_.pull(o<=5?"platform_b":"platform_d",t.ZX.random(0,t.H6.viewport.width),t.ZX.random(-10,10)),1)}}}],r&&Lt(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),s}(t.jy);function Gt(t){return Gt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gt(t)}function zt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ut(){return Ut="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=Ht(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Ut.apply(this,arguments)}function Ht(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=qt(t)););return t}function Xt(t,e){return Xt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Xt(t,e)}function Wt(t,e){if(e&&("object"===Gt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Yt(t)}function Yt(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function qt(t){return qt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},qt(t)}var Kt=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Xt(t,e)}(s,e);var n,r,i,o,a=(i=s,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=qt(i);if(o){var n=qt(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return Wt(this,t)});function s(e,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),(r=a.call(this,e,n,{image:"platform_d",width:57,height:15})).body=new t.uT(Yt(r)),r.body.addShape(new t.UL(0,0,57,15)),r.body.vel.set(0,0),r.body.collisionType=t.v7.types.WORLD_SHAPE,r.body.ignoreGravity=!0,r.name="green",r}return n=s,(r=[{key:"update",value:function(t){return Ut(qt(s.prototype),"update",this).call(this,t),!0}},{key:"onCollision",value:function(t,e){return!1}}])&&zt(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),s}(t.jy);function Zt(t){return Zt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zt(t)}function Jt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Qt(){return Qt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=te(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Qt.apply(this,arguments)}function te(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ie(t)););return t}function ee(t,e){return ee=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},ee(t,e)}function ne(t,e){if(e&&("object"===Zt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return re(t)}function re(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ie(t){return ie=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},ie(t)}var oe=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ee(t,e)}(s,e);var n,r,i,o,a=(i=s,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=ie(i);if(o){var n=ie(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return ne(this,t)});function s(e,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),(r=a.call(this,e,n,{image:"platform_m",width:57,height:15})).body=new t.uT(re(r)),r.body.addShape(new t.UL(0,0,57,15)),r.body.vel.set(0,0),r.body.collisionType=t.v7.types.WORLD_SHAPE,r.direction=Math.round(Math.random())?1:-1,r.movementSpeed=25,r.body.ignoreGravity=!0,r.name="blue",r}return n=s,(r=[{key:"update",value:function(e){Qt(ie(s.prototype),"update",this).call(this,e);var n=t.H6.world.fps;return this.pos.x+=this.movementSpeed*this.direction*n/1e3,(this.pos.x>t.H6.viewport.width||this.pos.x<0)&&(this.direction=-this.direction),!0}},{key:"onCollision",value:function(t,e){return!1}}])&&Jt(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),s}(t.jy);function ae(t){return ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ae(t)}function se(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function le(){return le="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=ue(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}},le.apply(this,arguments)}function ue(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=de(t)););return t}function ce(t,e){return ce=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},ce(t,e)}function he(t,e){if(e&&("object"===ae(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return fe(t)}function fe(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function de(t){return de=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},de(t)}var pe=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ce(t,e)}(s,e);var n,r,i,o,a=(i=s,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=de(i);if(o){var n=de(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return he(this,t)});function s(e,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),(r=a.call(this,e,n,{image:"platform_w",width:57,height:15})).body=new t.uT(fe(r)),r.body.addShape(new t.UL(0,0,57,15)),r.body.vel.set(0,0),r.body.collisionType=t.v7.types.WORLD_SHAPE,r.name="white",r.body.ignoreGravity=!0,r}return n=s,(r=[{key:"update",value:function(t){return le(de(s.prototype),"update",this).call(this,t),!0}},{key:"onCollision",value:function(t,e){return!1}},{key:"onDestroyEvent",value:function(){}}])&&se(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),s}(t.jy);function ye(t){return ye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ye(t)}function ve(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ge(){return ge="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=me(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ge.apply(this,arguments)}function me(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=we(t)););return t}function _e(t,e){return _e=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},_e(t,e)}function be(t,e){if(e&&("object"===ye(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return xe(t)}function xe(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function we(t){return we=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},we(t)}var Te=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_e(t,e)}(s,e);var n,r,i,o,a=(i=s,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=we(i);if(o){var n=we(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return be(this,t)});function s(e,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),(r=a.call(this,e,n,{image:"platform_b",width:58,height:15,framewidth:58,frameheight:32})).body=new t.uT(xe(r)),r.body.addShape(new t.UL(0,0,58,15)),r.body.vel.set(0,0),r.body.collisionType=t.v7.types.WORLD_SHAPE,r.body.ignoreGravity=!0,r.name="brown",r.addAnimation("break",[1,2,3],100),r.addAnimation("idle",[0],1),r.setCurrentAnimation("idle"),r}return n=s,(r=[{key:"update",value:function(e){return ge(we(s.prototype),"update",this).call(this,e),"brown_break"==this.name&&this.isCurrentAnimation("idle")&&(this.setCurrentAnimation("break"),t.n0.play("break",!1,void 0,.5)),!0}},{key:"onCollision",value:function(t,e){return!1}}])&&ve(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),s}(t.jy);function Ee(t){return Ee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ee(t)}function Se(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ke(){return ke="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=Oe(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ke.apply(this,arguments)}function Oe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Re(t)););return t}function Ae(t,e){return Ae=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Ae(t,e)}function Pe(t,e){if(e&&("object"===Ee(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Ce(t)}function Ce(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Re(t){return Re=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Re(t)}var Ie=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ae(t,e)}(s,e);var n,r,i,o,a=(i=s,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Re(i);if(o){var n=Re(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return Pe(this,t)});function s(e,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),(r=a.call(this,e,n,{image:"monster_1",framewidth:46,frameheight:37})).body=new t.uT(Ce(r)),r.body.addShape(new t.UL(11,11,20,16)),r.body.vel.set(0,0),r.body.collisionType=t.v7.types.NPC_OBJECT,r.body.ignoreGravity=!0,r.name="monster_2",r}return n=s,(r=[{key:"update",value:function(t){return ke(Re(s.prototype),"update",this).call(this,t),!0}},{key:"onCollision",value:function(t,e){return!1}}])&&Se(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),s}(t.jy);function Me(t){return Me="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Me(t)}function Le(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function $e(){return $e="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=De(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}},$e.apply(this,arguments)}function De(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Fe(t)););return t}function je(t,e){return je=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},je(t,e)}function Be(t,e){if(e&&("object"===Me(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Ne(t)}function Ne(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Fe(t){return Fe=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Fe(t)}var Ve=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&je(t,e)}(s,e);var n,r,i,o,a=(i=s,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Fe(i);if(o){var n=Fe(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return Be(this,t)});function s(e,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),(r=a.call(this,e,n,{image:"monster_2",framewidth:76,frameheight:45})).body=new t.uT(Ne(r)),r.body.addShape(new t.UL(17,8,40,25)),r.body.vel.set(0,0),r.body.collisionType=t.v7.types.NPC_OBJECT,r.body.ignoreGravity=!0,r.name="monster_2",r.addAnimation("idle",[0,1,2,3,4],50),r.setCurrentAnimation("idle"),r}return n=s,(r=[{key:"update",value:function(t){return $e(Fe(s.prototype),"update",this).call(this,t),!0}},{key:"onCollision",value:function(t,e){return!1}}])&&Le(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),s}(t.jy);function Ge(t){return Ge="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ge(t)}function ze(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ue(){return Ue="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=He(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Ue.apply(this,arguments)}function He(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=qe(t)););return t}function Xe(t,e){return Xe=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Xe(t,e)}function We(t,e){if(e&&("object"===Ge(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Ye(t)}function Ye(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function qe(t){return qe=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},qe(t)}var Ke=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Xe(t,e)}(s,e);var n,r,i,o,a=(i=s,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=qe(i);if(o){var n=qe(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return We(this,t)});function s(e,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),(r=a.call(this,e,n,{image:"monster_3",framewidth:74,frameheight:72})).body=new t.uT(Ye(r)),r.body.addShape(new t.UL(10,10,55,45)),r.body.vel.set(0,0),r.body.collisionType=t.v7.types.NPC_OBJECT,r.body.ignoreGravity=!0,r.name="monster_2",r}return n=s,(r=[{key:"update",value:function(t){return Ue(qe(s.prototype),"update",this).call(this,t),!0}},{key:"onCollision",value:function(t,e){return!1}}])&&ze(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),s}(t.jy);function Ze(t){return Ze="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ze(t)}function Je(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Qe(){return Qe="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=tn(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Qe.apply(this,arguments)}function tn(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=on(t)););return t}function en(t,e){return en=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},en(t,e)}function nn(t,e){if(e&&("object"===Ze(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return rn(t)}function rn(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function on(t){return on=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},on(t)}var an=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&en(t,e)}(s,e);var n,r,i,o,a=(i=s,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=on(i);if(o){var n=on(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return nn(this,t)});function s(e,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),(r=a.call(this,e,n,{image:"item_spring",width:17,height:12,frameheight:28,framewidth:17})).body=new t.uT(rn(r)),r.body.addShape(new t.UL(-5,-10,50,50)),r.body.vel.set(0,0),r.body.collisionType=t.v7.types.COLLECTABLE_OBJECT,r.body.ignoreGravity=!0,r.name="spring",r.addAnimation("idle",[0],1),r.addAnimation("used",[1],1),r.setCurrentAnimation("idle"),r}return n=s,(r=[{key:"update",value:function(e){return Qe(on(s.prototype),"update",this).call(this,e),"spring_used"==this.name&&this.isCurrentAnimation("idle")&&(t.n0.play("spring"),this.setCurrentAnimation("used")),!0}},{key:"onCollision",value:function(t,e){return!1}}])&&Je(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),s}(t.jy);function sn(t){return sn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sn(t)}function ln(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function un(){return un="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=cn(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}},un.apply(this,arguments)}function cn(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=pn(t)););return t}function hn(t,e){return hn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},hn(t,e)}function fn(t,e){if(e&&("object"===sn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return dn(t)}function dn(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function pn(t){return pn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},pn(t)}var yn=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&hn(t,e)}(s,e);var n,r,i,o,a=(i=s,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=pn(i);if(o){var n=pn(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return fn(this,t)});function s(e,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),(r=a.call(this,e,n,{image:"item_jetpack",width:24,height:36})).body=new t.uT(dn(r)),r.body.addShape(new t.UL(-7,-20,40,70)),r.body.vel.set(0,0),r.body.collisionType=t.v7.types.COLLECTABLE_OBJECT,r.body.ignoreGravity=!0,r.name="jetpack",r}return n=s,(r=[{key:"update",value:function(t){return un(pn(s.prototype),"update",this).call(this,t),!0}},{key:"onCollision",value:function(t,e){return!1}}])&&ln(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),s}(t.jy);const vn=[{name:"player",type:"image",src:"data/img/player.png"},{name:"platform_d",type:"image",src:"data/img/platform_d.png"},{name:"platform_m",type:"image",src:"data/img/platform_m.png"},{name:"platform_w",type:"image",src:"data/img/platform_w.png"},{name:"platform_b",type:"image",src:"data/img/platform_b.png"},{name:"item_spring",type:"image",src:"data/img/item_spring.png"},{name:"item_jetpack",type:"image",src:"data/img/item_jetpack.png"},{name:"jetpack",type:"image",src:"data/img/jetpack.png"},{name:"title_gameover",type:"image",src:"data/img/title_gameover.png"},{name:"title_menu",type:"image",src:"data/img/title_menu.png"},{name:"button_restart",type:"image",src:"data/img/button_play_again.png"},{name:"button_play",type:"image",src:"data/img/button_play.png"},{name:"button_menu",type:"image",src:"data/img/button_menu.png"},{name:"tutorial",type:"image",src:"data/img/tutorial.png"},{name:"tutorial2",type:"image",src:"data/img/tutorial2.png"},{name:"monster_1",type:"image",src:"data/img/monster_1.png"},{name:"monster_2",type:"image",src:"data/img/monster_2.png"},{name:"monster_3",type:"image",src:"data/img/monster_3.png"},{name:"jump",type:"audio",src:"data/sfx/"},{name:"lose",type:"audio",src:"data/sfx/"},{name:"spring",type:"audio",src:"data/sfx/"},{name:"jetpack",type:"audio",src:"data/sfx/"},{name:"monster",type:"audio",src:"data/sfx/"},{name:"stun",type:"audio",src:"data/sfx/"},{name:"break",type:"audio",src:"data/sfx/"},{name:"background",type:"image",src:"data/bgm/background.png"},{name:"doodleFont",type:"binary",src:"data/fnt/doodle.fnt"},{name:"doodleFont",type:"image",src:"data/fnt/doodle.png"}];t.Uh.onReady((function(){t.Rk.init(1218,562,{parent:"screen",scale:"auto",scaleMethod:"flex-width"})?(t.n0.init("mp3,ogg"),t._m.crossOrigin="anonymous",t._m.preload(vn,(function(){t.SB.set(t.SB.PLAY,new $),t.SB.set(t.SB.GAMEOVER,new it),t.SB.set(t.SB.MENU,new St),t.SB.transition("fade","#000000",250),t.SB.setTransition(t.SB.GAMEOVER,!1),t.d_.register("player",Vt),t.d_.register("platform_d",Kt),t.d_.register("platform_m",oe),t.d_.register("platform_w",pe),t.d_.register("platform_b",Te),t.d_.register("monster_1",Ie),t.d_.register("monster_2",Ve),t.d_.register("monster_3",Ke),t.d_.register("item_spring",an),t.d_.register("item_jetpack",yn),t.SB.change(t.SB.MENU)}))):alert("Your browser does not support HTML5 canvas.")}))})()})();